import{ak as t,_ as e,T as n,A as r,e as a,U as i,H as o,L as s,dw as u,J as d,K as l,C as h,q as p,s as c,u as f,F as g,E as v,am as y,S as m,h as x,dx as I,dy as M,k as b,n as w,dz as _,X as S,Y as D,$ as T,dA as A,dB as C,dC as P,ct as L,f as N,W as G,bL as k,bJ as R,bK as z,B as V,aS as B,be as E,P as O,bm as F,bT as U,z as H,aX as Z,cK as j,b4 as q,dD as K,ap as W,a1 as J,aT as Q,bB as X,Z as Y,ai as $,au as tt,dE as et,bZ as nt,bQ as rt,ar as at,cj as it,c3 as ot,ay as st,O as ut,dF as dt,dG as lt,Q as ht,dH as pt,bp as ct,c8 as ft,a0 as gt,c9 as vt,N as yt,y as mt,dI as xt,bN as It,dJ as Mt,c2 as bt,dK as wt,a7 as _t,a3 as St,ck as Dt,dL as Tt,dM as At,aW as Ct,aC as Pt,dN as Lt,v as Nt,af as Gt,g as kt,as as Rt,dO as zt}from"./vintage-CjLpt-xH.js";import{r as Vt,b as Bt,a as Et,i as Ot}from"./installSimple-CG8LEj6j.js";import{d as Ft}from"./dataFilter-DSv0GEyp.js";function Ut(e,n){n=n||{};var r=e.coordinateSystem,a=e.axis,i={},o=a.position,s=a.orient,u=r.getRect(),d=[u.x,u.x+u.width,u.y,u.y+u.height],l={horizontal:{top:d[2],bottom:d[3]},vertical:{left:d[0],right:d[1]}};i.position=["vertical"===s?l.vertical[o]:d[0],"horizontal"===s?l.horizontal[o]:d[3]];i.rotation=Math.PI/2*{horizontal:0,vertical:1}[s];i.labelDirection=i.tickDirection=i.nameDirection={top:-1,bottom:1,right:1,left:-1}[o],e.get(["axisTick","inside"])&&(i.tickDirection=-i.tickDirection),t(n.labelInside,e.get(["axisLabel","inside"]))&&(i.labelDirection=-i.labelDirection);var h=n.rotate;return null==h&&(h=e.get(["axisLabel","rotate"])),i.labelRotation="top"===o?-h:h,i.z2=1,i}var Ht=["axisLine","axisTickLabel","axisName"],Zt=["splitArea","splitLine"],jt=function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=o.type,e.axisPointerClass="SingleAxisPointer",e}return e(o,t),o.prototype.render=function(e,o,s,u){var d=this.group;d.removeAll();var l=this._axisGroup;this._axisGroup=new n;var h=Ut(e),p=new r(e,h);a(Ht,p.add,p),d.add(this._axisGroup),d.add(p.getGroup()),a(Zt,(function(t){e.get([t,"show"])&&qt[t](this,this.group,this._axisGroup,e)}),this),i(l,this._axisGroup,e),t.prototype.render.call(this,e,o,s,u)},o.prototype.remove=function(){Vt(this)},o.type="singleAxis",o}(o),qt={splitLine:function(t,e,n,r){var a=r.axis;if(!a.scale.isBlank()){var i=r.getModel("splitLine"),o=i.getModel("lineStyle"),h=o.get("color");h=h instanceof Array?h:[h];for(var p=o.get("width"),c=r.coordinateSystem.getRect(),f=a.isHorizontal(),g=[],v=0,y=a.getTicksCoords({tickModel:i}),m=[],x=[],I=0;I<y.length;++I){var M=a.toGlobalCoord(y[I].coord);f?(m[0]=M,m[1]=c.y,x[0]=M,x[1]=c.y+c.height):(m[0]=c.x,m[1]=M,x[0]=c.x+c.width,x[1]=M);var b=new s({shape:{x1:m[0],y1:m[1],x2:x[0],y2:x[1]},silent:!0});u(b.shape,p);var w=v++%h.length;g[w]=g[w]||[],g[w].push(b)}var _=o.getLineStyle(["color"]);for(I=0;I<g.length;++I)e.add(d(g[I],{style:l({stroke:h[I%h.length]},_),silent:!0}))}},splitArea:function(t,e,n,r){Bt(t,n,r,r)}},Kt=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=n.type,e}return e(n,t),n.prototype.getCoordSysModel=function(){return this},n.type="singleAxis",n.layoutMode="box",n.defaultOption={left:"5%",top:"5%",right:"5%",bottom:"5%",type:"value",position:"bottom",orient:"horizontal",axisLine:{show:!0,lineStyle:{width:1,type:"solid"}},tooltip:{show:!0},axisTick:{show:!0,length:6,lineStyle:{width:1}},axisLabel:{show:!0,interval:"auto"},splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.2}}},n}(h);p(Kt,c.prototype);var Wt=function(t){function n(e,n,r,a,i){var o=t.call(this,e,n,r)||this;return o.type=a||"value",o.position=i||"bottom",o}return e(n,t),n.prototype.isHorizontal=function(){var t=this.position;return"top"===t||"bottom"===t},n.prototype.pointToData=function(t,e){return this.coordinateSystem.pointToData(t)[0]},n}(f),Jt=["single"],Qt=function(){function t(t,e,n){this.type="single",this.dimension="single",this.dimensions=Jt,this.axisPointerEnabled=!0,this.model=t,this._init(t,e,n)}return t.prototype._init=function(t,e,n){var r=this.dimension,a=new Wt(r,g(t),[0,0],t.get("type"),t.get("position")),i="category"===a.type;a.onBand=i&&t.get("boundaryGap"),a.inverse=t.get("inverse"),a.orient=t.get("orient"),t.axis=a,a.model=t,a.coordinateSystem=this,this._axis=a},t.prototype.update=function(t,e){t.eachSeries((function(t){if(t.coordinateSystem===this){var e=t.getData();a(e.mapDimensionsAll(this.dimension),(function(t){this._axis.scale.unionExtentFromData(e,t)}),this),v(this._axis.scale,this._axis.model)}}),this)},t.prototype.resize=function(t,e){this._rect=y({left:t.get("left"),top:t.get("top"),right:t.get("right"),bottom:t.get("bottom"),width:t.get("width"),height:t.get("height")},{width:e.getWidth(),height:e.getHeight()}),this._adjustAxis()},t.prototype.getRect=function(){return this._rect},t.prototype._adjustAxis=function(){var t=this._rect,e=this._axis,n=e.isHorizontal(),r=n?[0,t.width]:[0,t.height],a=e.inverse?1:0;e.setExtent(r[a],r[1-a]),this._updateAxisTransform(e,n?t.x:t.y)},t.prototype._updateAxisTransform=function(t,e){var n=t.getExtent(),r=n[0]+n[1],a=t.isHorizontal();t.toGlobalCoord=a?function(t){return t+e}:function(t){return r-t+e},t.toLocalCoord=a?function(t){return t-e}:function(t){return r-t+e}},t.prototype.getAxis=function(){return this._axis},t.prototype.getBaseAxis=function(){return this._axis},t.prototype.getAxes=function(){return[this._axis]},t.prototype.getTooltipAxes=function(){return{baseAxes:[this.getAxis()],otherAxes:[]}},t.prototype.containPoint=function(t){var e=this.getRect(),n=this.getAxis();return"horizontal"===n.orient?n.contain(n.toLocalCoord(t[0]))&&t[1]>=e.y&&t[1]<=e.y+e.height:n.contain(n.toLocalCoord(t[1]))&&t[0]>=e.y&&t[0]<=e.y+e.height},t.prototype.pointToData=function(t){var e=this.getAxis();return[e.coordToData(e.toLocalCoord(t["horizontal"===e.orient?0:1]))]},t.prototype.dataToPoint=function(t){var e=this.getAxis(),n=this.getRect(),r=[],a="horizontal"===e.orient?0:1;return t instanceof Array&&(t=t[0]),r[a]=e.toGlobalCoord(e.dataToCoord(+t)),r[1-a]=0===a?n.y+n.height/2:n.x+n.width/2,r},t.prototype.convertToPixel=function(t,e,n){return Xt(e)===this?this.dataToPoint(n):null},t.prototype.convertFromPixel=function(t,e,n){return Xt(e)===this?this.pointToData(n):null},t}();function Xt(t){var e=t.seriesModel,n=t.singleAxisModel;return n&&n.coordinateSystem||e&&e.coordinateSystem}var Yt={create:function(t,e){var n=[];return t.eachComponent("singleAxis",(function(r,a){var i=new Qt(r,t,e);i.name="single_"+a,i.resize(r,e),r.coordinateSystem=i,n.push(i)})),t.eachSeries((function(t){if("singleAxis"===t.get("coordinateSystem")){var e=t.getReferringComponents("singleAxis",m).models[0];t.coordinateSystem=e&&e.coordinateSystem}})),n},dimensions:Jt},$t=["x","y"],te=["width","height"],ee=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.makeElOption=function(t,e,n,r,a){var i=n.axis,o=i.coordinateSystem,s=ae(o,1-re(i)),u=o.dataToPoint(e)[0],d=r.get("type");if(d&&"none"!==d){var l=x(r),h=ne[d](i,u,s);h.style=l,t.graphicKey=h.type,t.pointer=h}var p=Ut(n);I(e,t,p,n,r,a)},n.prototype.getHandleTransform=function(t,e,n){var r=Ut(e,{labelInside:!1});r.labelMargin=n.get(["handle","margin"]);var a=M(e.axis,t,r);return{x:a[0],y:a[1],rotation:r.rotation+(r.labelDirection<0?Math.PI:0)}},n.prototype.updateHandleTransform=function(t,e,n,r){var a=n.axis,i=a.coordinateSystem,o=re(a),s=ae(i,o),u=[t.x,t.y];u[o]+=e[o],u[o]=Math.min(s[1],u[o]),u[o]=Math.max(s[0],u[o]);var d=ae(i,1-o),l=(d[1]+d[0])/2,h=[l,l];return h[o]=u[o],{x:u[0],y:u[1],rotation:t.rotation,cursorPoint:h,tooltipOption:{verticalAlign:"middle"}}},n}(b),ne={line:function(t,e,n){return{type:"Line",subPixelOptimize:!0,shape:w([e,n[0]],[e,n[1]],re(t))}},shadow:function(t,e,n){var r=t.getBandWidth(),a=n[1]-n[0];return{type:"Rect",shape:_([e-r/2,n[0]],[r,a],re(t))}}};function re(t){return t.isHorizontal()?0:1}function ae(t,e){var n=t.getRect();return[n[$t[e]],n[$t[e]]+n[te[e]]]}var ie=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=n.type,e}return e(n,t),n.type="single",n}(S);function oe(t){D(T),o.registerAxisPointerClass("SingleAxisPointer",ee),t.registerComponentView(ie),t.registerComponentView(jt),t.registerComponentModel(Kt),Et(t,"single",Kt,Kt.defaultOption),t.registerCoordinateSystem("single",Yt)}var se=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="dataset",e}return e(n,t),n.prototype.init=function(e,n,r){t.prototype.init.call(this,e,n,r),this._sourceManager=new A(this),C(this)},n.prototype.mergeOption=function(e,n){t.prototype.mergeOption.call(this,e,n),C(this)},n.prototype.optionUpdated=function(){this._sourceManager.dirty()},n.prototype.getSourceManager=function(){return this._sourceManager},n.type="dataset",n.defaultOption={seriesLayoutBy:P},n}(h),ue=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="dataset",e}return e(n,t),n.type="dataset",n}(S);function de(t){t.registerComponentModel(se),t.registerComponentView(ue)}function le(t,e){return{seriesType:t,plan:L(),reset:function(t){var n=t.getData(),r=t.coordinateSystem,a=t.pipelineContext,i=e||a.large;if(r){var o=N(r.dimensions,(function(t){return n.mapDimension(t)})).slice(0,2),s=o.length,u=n.getCalculationInfo("stackResultDimension");G(n,o[0])&&(o[0]=u),G(n,o[1])&&(o[1]=u);var d=n.getStore(),l=n.getDimensionIndex(o[0]),h=n.getDimensionIndex(o[1]);return s&&{progress:function(t,e){for(var n=t.end-t.start,a=i&&k(n*s),o=[],u=[],p=t.start,c=0;p<t.end;p++){var f=void 0;if(1===s){var g=d.get(l,p);f=r.dataToPoint(g,null,u)}else o[0]=d.get(l,p),o[1]=d.get(h,p),f=r.dataToPoint(o,null,u);i?(a[c++]=f[0],a[c++]=f[1]):e.setItemLayout(p,f.slice())}i&&e.setLayout("points",a)}}}}}}var he=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=n.type,e.hasSymbolVisual=!0,e}return e(n,t),n.prototype.getInitialData=function(t,e){return R(null,this,{useEncodeDefaulter:!0})},n.prototype.getProgressive=function(){var t=this.option.progressive;return null==t?this.option.large?5e3:this.get("progressive"):t},n.prototype.getProgressiveThreshold=function(){var t=this.option.progressiveThreshold;return null==t?this.option.large?1e4:this.get("progressiveThreshold"):t},n.prototype.brushSelector=function(t,e,n){return n.point(e.getItemLayout(t))},n.prototype.getZLevelKey=function(){return this.getData().count()>this.getProgressiveThreshold()?this.id:""},n.type="series.scatter",n.dependencies=["grid","polar","geo","singleAxis","calendar"],n.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{opacity:.8},emphasis:{scale:!0},clip:!0,select:{itemStyle:{borderColor:"#212121"}},universalTransition:{divideShape:"clone"}},n}(z),pe=function(){return function(){}}(),ce=function(t){function n(e){var n=t.call(this,e)||this;return n._off=0,n.hoverDataIdx=-1,n}return e(n,t),n.prototype.getDefaultShape=function(){return new pe},n.prototype.reset=function(){this.notClear=!1,this._off=0},n.prototype.buildPath=function(t,e){var n,r=e.points,a=e.size,i=this.symbolProxy,o=i.shape,s=t.getContext?t.getContext():t,u=s&&a[0]<4,d=this.softClipShape;if(u)this._ctx=s;else{for(this._ctx=null,n=this._off;n<r.length;){var l=r[n++],h=r[n++];isNaN(l)||isNaN(h)||(d&&!d.contain(l,h)||(o.x=l-a[0]/2,o.y=h-a[1]/2,o.width=a[0],o.height=a[1],i.buildPath(t,o,!0)))}this.incremental&&(this._off=n,this.notClear=!0)}},n.prototype.afterBrush=function(){var t,e=this.shape,n=e.points,r=e.size,a=this._ctx,i=this.softClipShape;if(a){for(t=this._off;t<n.length;){var o=n[t++],s=n[t++];isNaN(o)||isNaN(s)||(i&&!i.contain(o,s)||a.fillRect(o-r[0]/2,s-r[1]/2,r[0],r[1]))}this.incremental&&(this._off=t,this.notClear=!0)}},n.prototype.findDataIndex=function(t,e){for(var n=this.shape,r=n.points,a=n.size,i=Math.max(a[0],4),o=Math.max(a[1],4),s=r.length/2-1;s>=0;s--){var u=2*s,d=r[u]-i/2,l=r[u+1]-o/2;if(t>=d&&e>=l&&t<=d+i&&e<=l+o)return s}return-1},n.prototype.contain=function(t,e){var n=this.transformCoordToLocal(t,e),r=this.getBoundingRect();return t=n[0],e=n[1],r.contain(t,e)?(this.hoverDataIdx=this.findDataIndex(t,e))>=0:(this.hoverDataIdx=-1,!1)},n.prototype.getBoundingRect=function(){var t=this._rect;if(!t){for(var e=this.shape,n=e.points,r=e.size,a=r[0],i=r[1],o=1/0,s=1/0,u=-1/0,d=-1/0,l=0;l<n.length;){var h=n[l++],p=n[l++];o=Math.min(h,o),u=Math.max(h,u),s=Math.min(p,s),d=Math.max(p,d)}t=this._rect=new V(o-a/2,s-i/2,u-o+a,d-s+i)}return t},n}(B),fe=function(){function t(){this.group=new n}return t.prototype.updateData=function(t,e){this._clear();var n=this._create();n.setShape({points:t.getLayout("points")}),this._setCommon(n,t,e)},t.prototype.updateLayout=function(t){var e=t.getLayout("points");this.group.eachChild((function(t){if(null!=t.startIndex){var n=2*(t.endIndex-t.startIndex),r=4*t.startIndex*2;e=new Float32Array(e.buffer,r,n)}t.setShape("points",e),t.reset()}))},t.prototype.incrementalPrepareUpdate=function(t){this._clear()},t.prototype.incrementalUpdate=function(t,e,n){var r=this._newAdded[0],a=e.getLayout("points"),i=r&&r.shape.points;if(i&&i.length<2e4){var o=i.length,s=new Float32Array(o+a.length);s.set(i),s.set(a,o),r.endIndex=t.end,r.setShape({points:s})}else{this._newAdded=[];var u=this._create();u.startIndex=t.start,u.endIndex=t.end,u.incremental=!0,u.setShape({points:a}),this._setCommon(u,e,n)}},t.prototype.eachRendered=function(t){this._newAdded[0]&&t(this._newAdded[0])},t.prototype._create=function(){var t=new ce({cursor:"default"});return t.ignoreCoarsePointer=!0,this.group.add(t),this._newAdded.push(t),t},t.prototype._setCommon=function(t,e,n){var r=e.hostModel;n=n||{};var a=e.getVisual("symbolSize");t.setShape("size",a instanceof Array?a:[a,a]),t.softClipShape=n.clipShape||null,t.symbolProxy=E(e.getVisual("symbol"),0,0,0,0),t.setColor=t.symbolProxy.setColor;var i=t.shape.size[0]<4;t.useStyle(r.getModel("itemStyle").getItemStyle(i?["color","shadowBlur","shadowColor"]:["color"]));var o=e.getVisual("style"),s=o&&o.fill;s&&t.setColor(s);var u=O(t);u.seriesIndex=r.seriesIndex,t.on("mousemove",(function(e){u.dataIndex=null;var n=t.hoverDataIdx;n>=0&&(u.dataIndex=n+(t.startIndex||0))}))},t.prototype.remove=function(){this._clear()},t.prototype._clear=function(){this._newAdded=[],this.group.removeAll()},t}(),ge=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=n.type,e}return e(n,t),n.prototype.render=function(t,e,n){var r=t.getData();this._updateSymbolDraw(r,t).updateData(r,{clipShape:this._getClipShape(t)}),this._finished=!0},n.prototype.incrementalPrepareRender=function(t,e,n){var r=t.getData();this._updateSymbolDraw(r,t).incrementalPrepareUpdate(r),this._finished=!1},n.prototype.incrementalRender=function(t,e,n){this._symbolDraw.incrementalUpdate(t,e.getData(),{clipShape:this._getClipShape(e)}),this._finished=t.end===e.getData().count()},n.prototype.updateTransform=function(t,e,n){var r=t.getData();if(this.group.dirty(),!this._finished||r.count()>1e4)return{update:!0};var a=le("").reset(t,e,n);a.progress&&a.progress({start:0,end:r.count(),count:r.count()},r),this._symbolDraw.updateLayout(r)},n.prototype.eachRendered=function(t){this._symbolDraw&&this._symbolDraw.eachRendered(t)},n.prototype._getClipShape=function(t){if(t.get("clip",!0)){var e=t.coordinateSystem;return e&&e.getArea&&e.getArea(.1)}},n.prototype._updateSymbolDraw=function(t,e){var n=this._symbolDraw,r=e.pipelineContext.large;return n&&r===this._isLargeDraw||(n&&n.remove(),n=this._symbolDraw=r?new fe:new F,this._isLargeDraw=r,this.group.removeAll()),this.group.add(n.group),n},n.prototype.remove=function(t,e){this._symbolDraw&&this._symbolDraw.remove(!0),this._symbolDraw=null},n.prototype.dispose=function(){},n.type="scatter",n}(U);function ve(t){D(Ot),t.registerSeriesModel(he),t.registerChartView(ge),t.registerLayout(le("scatter"))}var ye=function(){function t(t,e){this.depth=0,this.height=0,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.isExpand=!1,this.name=t||"",this.hostTree=e}return t.prototype.isRemoved=function(){return this.dataIndex<0},t.prototype.eachNode=function(t,e,n){W(t)&&(n=e,e=t,t=null),J(t=t||{})&&(t={order:t});var r,a=t.order||"preorder",i=this[t.attr||"children"];"preorder"===a&&(r=e.call(n,this));for(var o=0;!r&&o<i.length;o++)i[o].eachNode(t,e,n);"postorder"===a&&e.call(n,this)},t.prototype.updateDepthAndHeight=function(t){var e=0;this.depth=t;for(var n=0;n<this.children.length;n++){var r=this.children[n];r.updateDepthAndHeight(t+1),r.height>e&&(e=r.height)}this.height=e+1},t.prototype.getNodeById=function(t){if(this.getId()===t)return this;for(var e=0,n=this.children,r=n.length;e<r;e++){var a=n[e].getNodeById(t);if(a)return a}},t.prototype.contains=function(t){if(t===this)return!0;for(var e=0,n=this.children,r=n.length;e<r;e++){var a=n[e].contains(t);if(a)return a}},t.prototype.getAncestors=function(t){for(var e=[],n=t?this:this.parentNode;n;)e.push(n),n=n.parentNode;return e.reverse(),e},t.prototype.getAncestorsIndices=function(){for(var t=[],e=this;e;)t.push(e.dataIndex),e=e.parentNode;return t.reverse(),t},t.prototype.getDescendantIndices=function(){var t=[];return this.eachNode((function(e){t.push(e.dataIndex)})),t},t.prototype.getValue=function(t){var e=this.hostTree.data;return e.getStore().get(e.getDimensionIndex(t||"value"),this.dataIndex)},t.prototype.setLayout=function(t,e){this.dataIndex>=0&&this.hostTree.data.setItemLayout(this.dataIndex,t,e)},t.prototype.getLayout=function(){return this.hostTree.data.getItemLayout(this.dataIndex)},t.prototype.getModel=function(t){if(!(this.dataIndex<0))return this.hostTree.data.getItemModel(this.dataIndex).getModel(t)},t.prototype.getLevelModel=function(){return(this.hostTree.levelModels||[])[this.depth]},t.prototype.setVisual=function(t,e){this.dataIndex>=0&&this.hostTree.data.setItemVisual(this.dataIndex,t,e)},t.prototype.getVisual=function(t){return this.hostTree.data.getItemVisual(this.dataIndex,t)},t.prototype.getRawIndex=function(){return this.hostTree.data.getRawIndex(this.dataIndex)},t.prototype.getId=function(){return this.hostTree.data.getId(this.dataIndex)},t.prototype.getChildIndex=function(){if(this.parentNode){for(var t=this.parentNode.children,e=0;e<t.length;++e)if(t[e]===this)return e;return-1}return-1},t.prototype.isAncestorOf=function(t){for(var e=t.parentNode;e;){if(e===this)return!0;e=e.parentNode}return!1},t.prototype.isDescendantOf=function(t){return t!==this&&t.isAncestorOf(this)},t}(),me=function(){function t(t){this.type="tree",this._nodes=[],this.hostModel=t}return t.prototype.eachNode=function(t,e,n){this.root.eachNode(t,e,n)},t.prototype.getNodeByDataIndex=function(t){var e=this.data.getRawIndex(t);return this._nodes[e]},t.prototype.getNodeById=function(t){return this.root.getNodeById(t)},t.prototype.update=function(){for(var t=this.data,e=this._nodes,n=0,r=e.length;n<r;n++)e[n].dataIndex=-1;for(n=0,r=t.count();n<r;n++)e[t.getRawIndex(n)].dataIndex=n},t.prototype.clearLayouts=function(){this.data.clearItemLayouts()},t.createTree=function(e,n,r){var a=new t(n),i=[],o=1;!function t(e,n){var r=e.value;o=Math.max(o,H(r)?r.length:1),i.push(e);var s=new ye(Z(e.name,""),a);n?function(t,e){var n=e.children;if(t.parentNode===e)return;n.push(t),t.parentNode=e}(s,n):a.root=s,a._nodes.push(s);var u=e.children;if(u)for(var d=0;d<u.length;d++)t(u[d],s)}(e),a.root.updateDepthAndHeight(0);var s=j(i,{coordDimensions:["value"],dimensionsCount:o}).dimensions,u=new q(s,n);return u.initData(i),r&&r(u),K({mainData:u,struct:a,structAttr:"tree"}),a.update(),a},t}();function xe(t,e,n){if(t&&Q(e,t.type)>=0){var r=n.getData().tree.root,a=t.targetNode;if(J(a)&&(a=r.getNodeById(a)),a&&r.contains(a))return{node:a};var i=t.targetNodeId;if(null!=i&&(a=r.getNodeById(i)))return{node:a}}}function Ie(t){for(var e=[];t;)(t=t.parentNode)&&e.push(t);return e.reverse()}function Me(t,e){var n=Ie(t);return Q(n,e)>=0}function be(t,e){for(var n=[];t;){var r=t.dataIndex;n.push({name:t.name,dataIndex:r,value:e.getRawValue(r)}),t=t.parentNode}return n.reverse(),n}function we(t){var e=t.getData().tree,n={};e.eachNode((function(e){for(var r=e;r&&r.depth>1;)r=r.parentNode;var a=X(t.ecModel,r.name||r.dataIndex+"",n);e.setVisual("decal",a)}))}var _e=function(t){function n(e,n,r,a){var i=t.call(this)||this;i.z2=2,i.textConfig={inside:!0},O(i).seriesIndex=n.seriesIndex;var o=new Y({z2:4,silent:e.getModel().get(["label","silent"])});return i.setTextContent(o),i.updateData(!0,e,n,r,a),i}return e(n,t),n.prototype.updateData=function(t,e,n,r,i){this.node=e,e.piece=this,n=n||this._seriesModel,r=r||this._ecModel;var o=this;O(o).dataIndex=e.dataIndex;var s=e.getModel(),u=s.getModel("emphasis"),d=e.getLayout(),l=$({},d);l.label=null;var h=e.getVisual("style");h.lineJoin="bevel";var p=e.getVisual("decal");p&&(h.decal=tt(p,i));var c=et(s.getModel("itemStyle"),l,!0);$(l,c),a(nt,(function(t){var e=o.ensureState(t),n=s.getModel([t,"itemStyle"]);e.style=n.getItemStyle();var r=et(n,l);r&&(e.shape=r)})),t?(o.setShape(l),o.shape.r=d.r0,rt(o,{shape:{r:d.r}},n,e.dataIndex)):(at(o,{shape:l},n),it(o)),o.useStyle(h),this._updateLabel(n);var f=s.getShallow("cursor");f&&o.attr("cursor",f),this._seriesModel=n||this._seriesModel,this._ecModel=r||this._ecModel;var g=u.get("focus"),v="relative"===g?ot(e.getAncestorsIndices(),e.getDescendantIndices()):"ancestor"===g?e.getAncestorsIndices():"descendant"===g?e.getDescendantIndices():g;st(this,v,u.get("blurScope"),u.get("disabled"))},n.prototype._updateLabel=function(t){var e=this,n=this.node.getModel(),r=n.getModel("label"),i=this.node.getLayout(),o=i.endAngle-i.startAngle,s=(i.startAngle+i.endAngle)/2,u=Math.cos(s),d=Math.sin(s),l=this,h=l.getTextContent(),p=this.node.dataIndex,c=r.get("minAngle")/180*Math.PI,f=r.get("show")&&!(null!=c&&Math.abs(o)<c);function g(t,e){var n=t.get(e);return null==n?r.get(e):n}h.ignore=!f,a(lt,(function(r){var a="normal"===r?n.getModel("label"):n.getModel([r,"label"]),c="normal"===r,f=c?h:h.ensureState(r),v=t.getFormattedLabel(p,r);c&&(v=v||e.node.name),f.style=ut(a,{},null,"normal"!==r,!0),v&&(f.style.text=v);var y=a.get("show");null==y||c||(f.ignore=!y);var m,x=g(a,"position"),I=c?l:l.states[r],M=I.style.fill;I.textConfig={outsideFill:"inherit"===a.get("color")?M:null,inside:"outside"!==x};var b=g(a,"distance")||0,w=g(a,"align"),_=g(a,"rotate"),S=.5*Math.PI,D=1.5*Math.PI,T=dt("tangential"===_?Math.PI/2-s:s),A=T>S&&!pt(T-S)&&T<D;"outside"===x?(m=i.r+b,w=A?"right":"left"):w&&"center"!==w?"left"===w?(m=i.r0+b,w=A?"right":"left"):"right"===w&&(m=i.r-b,w=A?"left":"right"):(m=o===2*Math.PI&&0===i.r0?0:(i.r+i.r0)/2,w="center"),f.style.align=w,f.style.verticalAlign=g(a,"verticalAlign")||"middle",f.x=m*u+i.cx,f.y=m*d+i.cy;var C=0;"radial"===_?C=dt(-s)+(A?Math.PI:0):"tangential"===_?C=dt(Math.PI/2-s)+(A?Math.PI:0):ct(_)&&(C=_*Math.PI/180),f.rotation=dt(C)})),h.dirtyStyle()},n}(ht),Se="sunburstRootToNode",De="sunburstHighlight";var Te=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=n.type,e}return e(n,t),n.prototype.render=function(t,e,n,r){var a=this;this.seriesModel=t,this.api=n,this.ecModel=e;var i=t.getData(),o=i.tree.root,s=t.getViewRoot(),u=this.group,d=t.get("renderLabelForZeroData"),l=[];s.eachNode((function(t){l.push(t)}));var h,p,c=this._oldChildren||[];!function(r,a){if(0===r.length&&0===a.length)return;function s(t){return t.getId()}function l(s,l){!function(r,a){d||!r||r.getValue()||(r=null);if(r!==o&&a!==o)if(a&&a.piece)r?(a.piece.updateData(!1,r,t,e,n),i.setItemGraphicEl(r.dataIndex,a.piece)):function(t){if(!t)return;t.piece&&(u.remove(t.piece),t.piece=null)}(a);else if(r){var s=new _e(r,t,e,n);u.add(s),i.setItemGraphicEl(r.dataIndex,s)}}(null==s?null:r[s],null==l?null:a[l])}new ft(a,r,s,s).add(l).update(l).remove(gt(l,null)).execute()}(l,c),h=o,(p=s).depth>0?(a.virtualPiece?a.virtualPiece.updateData(!1,h,t,e,n):(a.virtualPiece=new _e(h,t,e,n),u.add(a.virtualPiece)),p.piece.off("click"),a.virtualPiece.on("click",(function(t){a._rootToNode(p.parentNode)}))):a.virtualPiece&&(u.remove(a.virtualPiece),a.virtualPiece=null),this._initEvents(),this._oldChildren=l},n.prototype._initEvents=function(){var t=this;this.group.off("click"),this.group.on("click",(function(e){var n=!1;t.seriesModel.getViewRoot().eachNode((function(r){if(!n&&r.piece&&r.piece===e.target){var a=r.getModel().get("nodeClick");if("rootToNode"===a)t._rootToNode(r);else if("link"===a){var i=r.getModel(),o=i.get("link");if(o){var s=i.get("target",!0)||"_blank";vt(o,s)}}n=!0}}))}))},n.prototype._rootToNode=function(t){t!==this.seriesModel.getViewRoot()&&this.api.dispatchAction({type:Se,from:this.uid,seriesId:this.seriesModel.id,targetNode:t})},n.prototype.containPoint=function(t,e){var n=e.getData().getItemLayout(0);if(n){var r=t[0]-n.cx,a=t[1]-n.cy,i=Math.sqrt(r*r+a*a);return i<=n.r&&i>=n.r0}},n.type="sunburst",n}(U),Ae=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=n.type,e.ignoreStyleOnData=!0,e}return e(n,t),n.prototype.getInitialData=function(t,e){var n={name:t.name,children:t.data};Ce(n);var r=this._levelModels=N(t.levels||[],(function(t){return new yt(t,this,e)}),this),a=me.createTree(n,this,(function(t){t.wrapMethod("getItemModel",(function(t,e){var n=a.getNodeByDataIndex(e),i=r[n.depth];return i&&(t.parentModel=i),t}))}));return a.data},n.prototype.optionUpdated=function(){this.resetViewRoot()},n.prototype.getDataParams=function(e){var n=t.prototype.getDataParams.apply(this,arguments),r=this.getData().tree.getNodeByDataIndex(e);return n.treePathInfo=be(r,this),n},n.prototype.getLevelModel=function(t){return this._levelModels&&this._levelModels[t.depth]},n.prototype.getViewRoot=function(){return this._viewRoot},n.prototype.resetViewRoot=function(t){t?this._viewRoot=t:t=this._viewRoot;var e=this.getRawData().tree.root;t&&(t===e||e.contains(t))||(this._viewRoot=e)},n.prototype.enableAriaDecal=function(){we(this)},n.type="series.sunburst",n.defaultOption={z:2,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,stillShowZeroSum:!0,nodeClick:"rootToNode",renderLabelForZeroData:!1,label:{rotate:"radial",show:!0,opacity:1,align:"center",position:"inside",distance:5,silent:!0},itemStyle:{borderWidth:1,borderColor:"white",borderType:"solid",shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,opacity:1},emphasis:{focus:"descendant"},blur:{itemStyle:{opacity:.2},label:{opacity:.1}},animationType:"expansion",animationDuration:1e3,animationDurationUpdate:500,data:[],sort:"desc"},n}(z);function Ce(t){var e=0;a(t.children,(function(t){Ce(t);var n=t.value;H(n)&&(n=n[0]),e+=n}));var n=t.value;H(n)&&(n=n[0]),(null==n||isNaN(n))&&(n=e),n<0&&(n=0),H(t.value)?t.value[0]=n:t.value=n}var Pe=Math.PI/180;function Le(t,e,n){e.eachSeriesByType(t,(function(t){var e=t.get("center"),r=t.get("radius");H(r)||(r=[0,r]),H(e)||(e=[e,e]);var i=n.getWidth(),o=n.getHeight(),s=Math.min(i,o),u=mt(e[0],i),d=mt(e[1],o),l=mt(r[0],s/2),h=mt(r[1],s/2),p=-t.get("startAngle")*Pe,c=t.get("minAngle")*Pe,f=t.getData().tree.root,g=t.getViewRoot(),v=g.depth,y=t.get("sort");null!=y&&Ne(g,y);var m=0;a(g.children,(function(t){!isNaN(t.getValue())&&m++}));var x=g.getValue(),I=Math.PI/(x||m)*2,M=g.depth>0,b=g.height-(M?-1:1),w=(h-l)/(b||1),_=t.get("clockwise"),S=t.get("stillShowZeroSum"),D=_?1:-1,T=function(e,n){if(e){var r=n;if(e!==f){var i=e.getValue(),o=0===x&&S?I:i*I;o<c&&(o=c),r=n+D*o;var h=e.depth-v-(M?-1:1),p=l+w*h,g=l+w*(h+1),y=t.getLevelModel(e);if(y){var m=y.get("r0",!0),b=y.get("r",!0),A=y.get("radius",!0);null!=A&&(m=A[0],b=A[1]),null!=m&&(p=mt(m,s/2)),null!=b&&(g=mt(b,s/2))}e.setLayout({angle:o,startAngle:n,endAngle:r,clockwise:_,cx:u,cy:d,r0:p,r:g})}if(e.children&&e.children.length){var C=0;a(e.children,(function(t){C+=T(t,n+C)}))}return r-n}};if(M){var A=l,C=l+w,P=2*Math.PI;f.setLayout({angle:P,startAngle:p,endAngle:p+P,clockwise:_,cx:u,cy:d,r0:A,r:C})}T(g,p)}))}function Ne(t,e){var n=t.children||[];t.children=function(t,e){if(W(e)){var n=N(t,(function(t,e){var n=t.getValue();return{params:{depth:t.depth,height:t.height,dataIndex:t.dataIndex,getValue:function(){return n}},index:e}}));return n.sort((function(t,n){return e(t.params,n.params)})),N(n,(function(e){return t[e.index]}))}var r="asc"===e;return t.sort((function(t,e){var n=(t.getValue()-e.getValue())*(r?1:-1);return 0===n?(t.dataIndex-e.dataIndex)*(r?-1:1):n}))}(n,e),n.length&&a(t.children,(function(t){Ne(t,e)}))}function Ge(t){var e={};t.eachSeriesByType("sunburst",(function(t){var n=t.getData(),r=n.tree;r.eachNode((function(a){var i=a.getModel().getModel("itemStyle").getItemStyle();i.fill||(i.fill=function(t,n,r){for(var a=t;a&&a.depth>1;)a=a.parentNode;var i=n.getColorFromPalette(a.name||a.dataIndex+"",e);return t.depth>1&&J(i)&&(i=xt(i,(t.depth-1)/(r-1)*.5)),i}(a,t,r.root.height));var o=n.ensureUniqueItemVisual(a.dataIndex,"style");$(o,i)}))}))}function ke(t){t.registerChartView(Te),t.registerSeriesModel(Ae),t.registerLayout(gt(Le,"sunburst")),t.registerProcessor(gt(Ft,"sunburst")),t.registerVisual(Ge),function(t){t.registerAction({type:Se,update:"updateView"},(function(t,e){e.eachComponent({mainType:"series",subType:"sunburst",query:t},(function(e,n){var r=xe(t,[Se],e);if(r){var a=e.getViewRoot();a&&(t.direction=Me(a,r.node)?"rollUp":"drillDown"),e.resetViewRoot(r.node)}}))})),t.registerAction({type:De,update:"none"},(function(t,e,n){t=$({},t),e.eachComponent({mainType:"series",subType:"sunburst",query:t},(function(e){var n=xe(t,[De],e);n&&(t.dataIndex=n.node.dataIndex)})),n.dispatchAction($(t,{type:"highlight"}))})),t.registerAction({type:"sunburstUnhighlight",update:"updateView"},(function(t,e,n){t=$({},t),n.dispatchAction($(t,{type:"downplay"}))}))}(t)}var Re=It.CMD;function ze(t,e){return Math.abs(t-e)<1e-5}function Ve(t){var e,n,r,a,i,o,s,u,d,l,h,p,c,f,g,v,y,m,x,I,M,b,w,_,S=t.data,D=t.len(),T=[],A=0,C=0,P=0,L=0;function N(t,n){e&&e.length>2&&T.push(e),e=[t,n]}function G(t,n,r,a){ze(t,r)&&ze(n,a)||e.push(t,n,r,a,r,a)}for(var k=0;k<D;){var R=S[k++],z=1===k;switch(z&&(P=A=S[k],L=C=S[k+1],R!==Re.L&&R!==Re.C&&R!==Re.Q||(e=[P,L])),R){case Re.M:A=P=S[k++],C=L=S[k++],N(P,L);break;case Re.L:G(A,C,n=S[k++],r=S[k++]),A=n,C=r;break;case Re.C:e.push(S[k++],S[k++],S[k++],S[k++],A=S[k++],C=S[k++]);break;case Re.Q:n=S[k++],r=S[k++],a=S[k++],i=S[k++],e.push(A+2/3*(n-A),C+2/3*(r-C),a+2/3*(n-a),i+2/3*(r-i),a,i),A=a,C=i;break;case Re.A:var V=S[k++],B=S[k++],E=S[k++],O=S[k++],F=S[k++],U=S[k++]+F;k+=1;var H=!S[k++];n=Math.cos(F)*E+V,r=Math.sin(F)*O+B,z?N(P=n,L=r):G(A,C,n,r),A=Math.cos(U)*E+V,C=Math.sin(U)*O+B;for(var Z=(H?-1:1)*Math.PI/2,j=F;H?j>U:j<U;j+=Z){var q=H?Math.max(j+Z,U):Math.min(j+Z,U);o=j,s=q,u=V,d=B,l=E,h=O,p=void 0,c=void 0,f=void 0,g=void 0,v=void 0,y=void 0,m=void 0,x=void 0,I=void 0,M=void 0,b=void 0,w=void 0,_=void 0,p=Math.abs(s-o),c=4*Math.tan(p/4)/3,f=s<o?-1:1,g=Math.cos(o),v=Math.sin(o),y=Math.cos(s),m=Math.sin(s),x=g*l+u,I=v*h+d,M=y*l+u,b=m*h+d,w=l*c*f,_=h*c*f,e.push(x-w*v,I+_*g,M+w*m,b-_*y,M,b)}break;case Re.R:P=A=S[k++],L=C=S[k++],n=P+S[k++],r=L+S[k++],N(n,L),G(n,L,n,r),G(n,r,P,r),G(P,r,P,L),G(P,L,n,L);break;case Re.Z:e&&G(A,C,P,L),A=P,C=L}}return e&&e.length>2&&T.push(e),T}function Be(t,e,n,r,a,i,o,s,u,d){if(ze(t,n)&&ze(e,r)&&ze(a,o)&&ze(i,s))u.push(o,s);else{var l=2/d,h=l*l,p=o-t,c=s-e,f=Math.sqrt(p*p+c*c);p/=f,c/=f;var g=n-t,v=r-e,y=a-o,m=i-s,x=g*g+v*v,I=y*y+m*m;if(x<h&&I<h)u.push(o,s);else{var M=p*g+c*v,b=-p*y-c*m;if(x-M*M<h&&M>=0&&I-b*b<h&&b>=0)u.push(o,s);else{var w=[],_=[];Mt(t,n,a,o,.5,w),Mt(e,r,i,s,.5,_),Be(w[0],_[0],w[1],_[1],w[2],_[2],w[3],_[3],u,d),Be(w[4],_[4],w[5],_[5],w[6],_[6],w[7],_[7],u,d)}}}}function Ee(t,e,n){var r=t[e],a=t[1-e],i=Math.abs(r/a),o=Math.ceil(Math.sqrt(i*n)),s=Math.floor(n/o);0===s&&(s=1,o=n);for(var u=[],d=0;d<o;d++)u.push(s);var l=n-o*s;if(l>0)for(d=0;d<l;d++)u[d%o]+=1;return u}function Oe(t,e,n){for(var r=t.r0,a=t.r,i=t.startAngle,o=t.endAngle,s=Math.abs(o-i),u=s*a,d=a-r,l=u>Math.abs(d),h=Ee([u,d],l?0:1,e),p=(l?s:d)/h.length,c=0;c<h.length;c++)for(var f=(l?d:s)/h[c],g=0;g<h[c];g++){var v={};l?(v.startAngle=i+p*c,v.endAngle=i+p*(c+1),v.r0=r+f*g,v.r=r+f*(g+1)):(v.startAngle=i+f*g,v.endAngle=i+f*(g+1),v.r0=r+p*c,v.r=r+p*(c+1)),v.clockwise=t.clockwise,v.cx=t.cx,v.cy=t.cy,n.push(v)}}function Fe(t,e,n,r){return t*r-n*e}function Ue(t,e,n,r,a,i,o,s){var u=n-t,d=r-e,l=o-a,h=s-i,p=Fe(l,h,u,d);if(Math.abs(p)<1e-6)return null;var c=Fe(t-a,e-i,l,h)/p;return c<0||c>1?null:new Dt(c*u+t,c*d+e)}function He(t,e,n){var r=new Dt;Dt.sub(r,n,e),r.normalize();var a=new Dt;return Dt.sub(a,t,e),a.dot(r)}function Ze(t,e){var n=t[t.length-1];n&&n[0]===e[0]&&n[1]===e[1]||t.push(e)}function je(t){var e=t.points,n=[],r=[];bt(e,n,r);var a=new V(n[0],n[1],r[0]-n[0],r[1]-n[1]),i=a.width,o=a.height,s=a.x,u=a.y,d=new Dt,l=new Dt;return i>o?(d.x=l.x=s+i/2,d.y=u,l.y=u+o):(d.y=l.y=u+o/2,d.x=s,l.x=s+i),function(t,e,n){for(var r=t.length,a=[],i=0;i<r;i++){var o=t[i],s=t[(i+1)%r],u=Ue(o[0],o[1],s[0],s[1],e.x,e.y,n.x,n.y);u&&a.push({projPt:He(u,e,n),pt:u,idx:i})}if(a.length<2)return[{points:t},{points:t}];a.sort((function(t,e){return t.projPt-e.projPt}));var d=a[0],l=a[a.length-1];if(l.idx<d.idx){var h=d;d=l,l=h}var p=[d.pt.x,d.pt.y],c=[l.pt.x,l.pt.y],f=[p],g=[c];for(i=d.idx+1;i<=l.idx;i++)Ze(f,t[i].slice());for(Ze(f,c),Ze(f,p),i=l.idx+1;i<=d.idx+r;i++)Ze(g,t[i%r].slice());return Ze(g,p),Ze(g,c),[{points:f},{points:g}]}(e,d,l)}function qe(t,e,n,r){if(1===n)r.push(e);else{var a=Math.floor(n/2),i=t(e);qe(t,i[0],a,r),qe(t,i[1],n-a,r)}return r}function Ke(t,e){var n,r=[],a=t.shape;switch(t.type){case"rect":!function(t,e,n){for(var r=t.width,a=t.height,i=r>a,o=Ee([r,a],i?0:1,e),s=i?"width":"height",u=i?"height":"width",d=i?"x":"y",l=i?"y":"x",h=t[s]/o.length,p=0;p<o.length;p++)for(var c=t[u]/o[p],f=0;f<o[p];f++){var g={};g[d]=p*h,g[l]=f*c,g[s]=h,g[u]=c,g.x+=t.x,g.y+=t.y,n.push(g)}}(a,e,r),n=St;break;case"sector":Oe(a,e,r),n=ht;break;case"circle":Oe({r0:0,r:a.r,startAngle:0,endAngle:2*Math.PI,cx:a.cx,cy:a.cy},e,r),n=ht;break;default:var i=t.getComputedTransform(),o=i?Math.sqrt(Math.max(i[0]*i[0]+i[1]*i[1],i[2]*i[2]+i[3]*i[3])):1,s=N(function(t,e){var n=Ve(t),r=[];e=e||1;for(var a=0;a<n.length;a++){var i=n[a],o=[],s=i[0],u=i[1];o.push(s,u);for(var d=2;d<i.length;){var l=i[d++],h=i[d++],p=i[d++],c=i[d++],f=i[d++],g=i[d++];Be(s,u,l,h,p,c,f,g,o,e),s=f,u=g}r.push(o)}return r}(t.getUpdatedPathProxy(),o),(function(t){return function(t){for(var e=[],n=0;n<t.length;)e.push([t[n++],t[n++]]);return e}(t)})),u=s.length;if(0===u)qe(je,{points:s[0]},e,r);else if(u===e)for(var d=0;d<u;d++)r.push({points:s[d]});else{var l=0,h=N(s,(function(t){var e=[],n=[];bt(t,e,n);var r=(n[1]-e[1])*(n[0]-e[0]);return l+=r,{poly:t,area:r}}));h.sort((function(t,e){return e.area-t.area}));var p=e;for(d=0;d<u;d++){var c=h[d];if(p<=0)break;var f=d===u-1?p:Math.ceil(c.area/l*e);f<0||(qe(je,{points:c.poly},f,r),p-=f)}}n=_t}if(!n)return function(t,e){for(var n=[],r=0;r<e;r++)n.push(wt(t));return n}(t,e);var g,v,y=[];for(d=0;d<r.length;d++){var m=new n;m.setShape(r[d]),g=t,(v=m).setStyle(g.style),v.z=g.z,v.z2=g.z2,v.zlevel=g.zlevel,y.push(m)}return y}function We(t,e){var n=t.length,r=e.length;if(n===r)return[t,e];for(var a=[],i=[],o=n<r?t:e,s=Math.min(n,r),u=Math.abs(r-n)/6,d=(s-2)/6,l=Math.ceil(u/d)+1,h=[o[0],o[1]],p=u,c=2;c<s;){var f=o[c-2],g=o[c-1],v=o[c++],y=o[c++],m=o[c++],x=o[c++],I=o[c++],M=o[c++];if(p<=0)h.push(v,y,m,x,I,M);else{for(var b=Math.min(p,l-1)+1,w=1;w<=b;w++){var _=w/b;Mt(f,v,m,I,_,a),Mt(g,y,x,M,_,i),f=a[3],g=i[3],h.push(a[1],i[1],a[2],i[2],f,g),v=a[5],y=i[5],m=a[6],x=i[6]}p-=b-1}}return o===t?[h,e]:[t,h]}function Je(t,e){for(var n=t.length,r=t[n-2],a=t[n-1],i=[],o=0;o<e.length;)i[o++]=r,i[o++]=a;return i}function Qe(t){for(var e=0,n=0,r=0,a=t.length,i=0,o=a-2;i<a;o=i,i+=2){var s=t[o],u=t[o+1],d=t[i],l=t[i+1],h=s*l-d*u;e+=h,n+=(s+d)*h,r+=(u+l)*h}return 0===e?[t[0]||0,t[1]||0]:[n/e/3,r/e/3,e]}function Xe(t,e,n,r){for(var a=(t.length-2)/6,i=1/0,o=0,s=t.length,u=s-2,d=0;d<a;d++){for(var l=6*d,h=0,p=0;p<s;p+=2){var c=0===p?l:(l+p-2)%u+2,f=t[c]-n[0],g=t[c+1]-n[1],v=e[p]-r[0]-f,y=e[p+1]-r[1]-g;h+=v*v+y*y}h<i&&(i=h,o=d)}return o}function Ye(t){for(var e=[],n=t.length,r=0;r<n;r+=2)e[r]=t[n-r-2],e[r+1]=t[n-r-1];return e}function $e(t){return t.__isCombineMorphing}var tn="__mOriginal_";function en(t,e,n){var r=tn+e,a=t[r]||t[e];t[r]||(t[r]=t[e]);var i=n.replace,o=n.after,s=n.before;t[e]=function(){var t,e=arguments;return s&&s.apply(this,e),t=i?i.apply(this,e):a.apply(this,e),o&&o.apply(this,e),t}}function nn(t,e){var n=tn+e;t[n]&&(t[e]=t[n],t[n]=null)}function rn(t,e){for(var n=0;n<t.length;n++)for(var r=t[n],a=0;a<r.length;){var i=r[a],o=r[a+1];r[a++]=e[0]*i+e[2]*o+e[4],r[a++]=e[1]*i+e[3]*o+e[5]}}function an(t,e){var n=t.getUpdatedPathProxy(),r=e.getUpdatedPathProxy(),a=function(t,e){for(var n,r,a,i=[],o=[],s=0;s<Math.max(t.length,e.length);s++){var u=t[s],d=e[s],l=void 0,h=void 0;u?d?(r=l=(n=We(u,d))[0],a=h=n[1]):(h=Je(a||u,u),l=u):(l=Je(r||d,d),h=d),i.push(l),o.push(h)}return[i,o]}(Ve(n),Ve(r)),i=a[0],o=a[1],s=t.getComputedTransform(),u=e.getComputedTransform();s&&rn(i,s),u&&rn(o,u),en(e,"updateTransform",{replace:function(){this.transform=null}}),e.transform=null;var d=function(t,e,n,r){for(var a,i=[],o=0;o<t.length;o++){var s=t[o],u=e[o],d=Qe(s),l=Qe(u);null==a&&(a=d[2]<0!=l[2]<0);var h=[],p=[],c=0,f=1/0,g=[],v=s.length;a&&(s=Ye(s));for(var y=6*Xe(s,u,d,l),m=v-2,x=0;x<m;x+=2){var I=(y+x)%m+2;h[x+2]=s[I]-d[0],h[x+3]=s[I+1]-d[1]}h[0]=s[y]-d[0],h[1]=s[y+1]-d[1];for(var M=r/n,b=-r/2;b<=r/2;b+=M){var w=Math.sin(b),_=Math.cos(b),S=0;for(x=0;x<s.length;x+=2){var D=h[x],T=h[x+1],A=u[x]-l[0],C=u[x+1]-l[1],P=A*_-C*w,L=A*w+C*_;g[x]=P,g[x+1]=L;var N=P-D,G=L-T;S+=N*N+G*G}if(S<f){f=S,c=b;for(var k=0;k<g.length;k++)p[k]=g[k]}}i.push({from:h,to:p,fromCp:d,toCp:l,rotation:-c})}return i}(i,o,10,Math.PI),l=[];en(e,"buildPath",{replace:function(t){for(var n=e.__morphT,r=1-n,a=[],i=0;i<d.length;i++){var o=d[i],s=o.from,u=o.to,h=o.rotation*n,p=o.fromCp,c=o.toCp,f=Math.sin(h),g=Math.cos(h);Tt(a,p,c,n);for(var v=0;v<s.length;v+=2){var y=s[v],m=s[v+1],x=y*r+(w=u[v])*n,I=m*r+(_=u[v+1])*n;l[v]=x*g-I*f+a[0],l[v+1]=x*f+I*g+a[1]}var M=l[0],b=l[1];t.moveTo(M,b);for(v=2;v<s.length;){var w=l[v++],_=l[v++],S=l[v++],D=l[v++],T=l[v++],A=l[v++];M===w&&b===_&&S===T&&D===A?t.lineTo(T,A):t.bezierCurveTo(w,_,S,D,T,A),M=T,b=A}}}})}function on(t,e,n){if(!t||!e)return e;var r=n.done,a=n.during;return an(t,e),e.__morphT=0,e.animateTo({__morphT:1},l({during:function(t){e.dirtyShape(),a&&a(t)},done:function(){nn(e,"buildPath"),nn(e,"updateTransform"),e.__morphT=-1,e.createPathProxy(),e.dirtyShape(),r&&r()}},n)),e}function sn(t,e,n,r,a,i){t=a===n?0:Math.round(32767*(t-n)/(a-n)),e=i===r?0:Math.round(32767*(e-r)/(i-r));for(var o,s=0,u=32768;u>0;u/=2){var d=0,l=0;(t&u)>0&&(d=1),(e&u)>0&&(l=1),s+=u*u*(3*d^l),0===l&&(1===d&&(t=u-1-t,e=u-1-e),o=t,t=e,e=o)}return s}function un(t){var e=1/0,n=1/0,r=-1/0,a=-1/0,i=N(t,(function(t){var i=t.getBoundingRect(),o=t.getComputedTransform(),s=i.x+i.width/2+(o?o[4]:0),u=i.y+i.height/2+(o?o[5]:0);return e=Math.min(s,e),n=Math.min(u,n),r=Math.max(s,r),a=Math.max(u,a),[s,u]}));return N(i,(function(i,o){return{cp:i,z:sn(i[0],i[1],e,n,r,a),path:t[o]}})).sort((function(t,e){return t.z-e.z})).map((function(t){return t.path}))}function dn(t){return Ke(t.path,t.count)}function ln(t){return H(t[0])}function hn(t,e){for(var n=[],r=t.length,a=0;a<r;a++)n.push({one:t[a],many:[]});for(a=0;a<e.length;a++){var i=e[a].length,o=void 0;for(o=0;o<i;o++)n[o%r].many.push(e[a][o])}var s=0;for(a=r-1;a>=0;a--)if(!n[a].many.length){var u=n[s].many;if(u.length<=1){if(!s)return n;s=0}i=u.length;var d=Math.ceil(i/2);n[a].many=u.slice(d,i),n[s].many=u.slice(0,d),s++}return n}var pn={clone:function(t){for(var e=[],n=1-Math.pow(1-t.path.style.opacity,1/t.count),r=0;r<t.count;r++){var a=wt(t.path);a.setStyle("opacity",n),e.push(a)}return e},split:null};function cn(t,e,n,r,a,i){if(t.length&&e.length){var o=Ct("update",r,a);if(o&&o.duration>0){var s,u,d=r.getModel("universalTransition").get("delay"),h=Object.assign({setToFinal:!0},o);ln(t)&&(s=t,u=e),ln(e)&&(s=e,u=t);for(var p=s?s===t:t.length>e.length,c=s?hn(u,s):hn(p?e:t,[p?t:e]),f=0,g=0;g<c.length;g++)f+=c[g].many.length;var v=0;for(g=0;g<c.length;g++)y(c[g],p,v,f),v+=c[g].many.length}}function y(t,e,r,a,o){var s=t.many,u=t.one;if(1!==s.length||o)for(var p=l({dividePath:pn[n],individualDelay:d&&function(t,e,n,i){return d(t+r,a)}},h),c=e?function(t,e,n){var r=[];!function t(e){for(var n=0;n<e.length;n++){var a=e[n];$e(a)?t(a.childrenRef()):a instanceof B&&r.push(a)}}(t);var a=r.length;if(!a)return{fromIndividuals:[],toIndividuals:[],count:0};var i=(n.dividePath||dn)({path:e,count:a});if(i.length!==a)return{fromIndividuals:[],toIndividuals:[],count:0};r=un(r),i=un(i);for(var o=n.done,s=n.during,u=n.individualDelay,d=new At,h=0;h<a;h++){var p=r[h],c=i[h];c.parent=e,c.copyTransform(d),u||an(p,c)}function f(t){for(var e=0;e<i.length;e++)i[e].addSelfToZr(t)}function g(){e.__isCombineMorphing=!1,e.__morphT=-1,e.childrenRef=null,nn(e,"addSelfToZr"),nn(e,"removeSelfFromZr")}e.__isCombineMorphing=!0,e.childrenRef=function(){return i},en(e,"addSelfToZr",{after:function(t){f(t)}}),en(e,"removeSelfFromZr",{after:function(t){for(var e=0;e<i.length;e++)i[e].removeSelfFromZr(t)}});var v=i.length;if(u){var y=v,m=function(){0==--y&&(g(),o&&o())};for(h=0;h<v;h++){var x=u?l({delay:(n.delay||0)+u(h,v,r[h],i[h]),done:m},n):n;on(r[h],i[h],x)}}else e.__morphT=0,e.animateTo({__morphT:1},l({during:function(t){for(var n=0;n<v;n++){var r=i[n];r.__morphT=e.__morphT,r.dirtyShape()}s&&s(t)},done:function(){g();for(var e=0;e<t.length;e++)nn(t[e],"updateTransform");o&&o()}},n));return e.__zr&&f(e.__zr),{fromIndividuals:r,toIndividuals:i,count:v}}(s,u,p):function(t,e,n){var r=e.length,a=[],i=n.dividePath||dn;if($e(t)){!function t(e){for(var n=0;n<e.length;n++){var r=e[n];$e(r)?t(r.childrenRef()):r instanceof B&&a.push(r)}}(t.childrenRef());var o=a.length;if(o<r)for(var s=0,u=o;u<r;u++)a.push(wt(a[s++%o]));a.length=r}else{a=i({path:t,count:r});var d=t.getComputedTransform();for(u=0;u<a.length;u++)a[u].setLocalTransform(d);if(a.length!==r)return{fromIndividuals:[],toIndividuals:[],count:0}}a=un(a),e=un(e);var h=n.individualDelay;for(u=0;u<r;u++){var p=h?l({delay:(n.delay||0)+h(u,r,a[u],e[u])},n):n;on(a[u],e[u],p)}return{fromIndividuals:a,toIndividuals:e,count:e.length}}(u,s,p),f=c.fromIndividuals,g=c.toIndividuals,v=f.length,m=0;m<v;m++){x=d?l({delay:d(m,v)},h):h;i(f[m],g[m],e?s[m]:t.one,e?t.one:s[m],x)}else{var x,I=e?s[0]:u,M=e?u:s[0];if($e(I))y({many:[I],one:M},!0,r,a,!0);else on(I,M,x=d?l({delay:d(r,a)},h):h),i(I,M,I,M,x)}}}function fn(t){if(!t)return[];if(H(t)){for(var e=[],n=0;n<t.length;n++)e.push(fn(t[n]));return e}var r=[];return t.traverse((function(t){t instanceof B&&!t.disableMorphing&&!t.invisible&&!t.ignore&&r.push(t)})),r}var gn=Nt();function vn(t,e,n,r){var a=function(t,e){for(var n=t.dimensions,r=0;r<n.length;r++){var a=t.getDimensionInfo(n[r]);if(a&&0===a.otherDims[e])return n[r]}}(t,r?"itemChildGroupId":"itemGroupId");if(a){var i=function(t,e,n){var r=t.getDimensionInfo(n),a=r&&r.ordinalMeta;if(r){var i=t.get(r.name,e);return a&&a.categories[i]||i+""}}(t,e,a);return i}var o=t.getRawDataItem(e),s=r?"childGroupId":"groupId";return o&&o[s]?o[s]+"":r?void 0:n||t.getId(e)}function yn(t){var e=[];return a(t,(function(t){var n=t.data,r=t.dataGroupId;if(!(n.count()>1e4))for(var a=n.getIndices(),i=0;i<a.length;i++)e.push({data:n,groupId:vn(n,i,r,!1),childGroupId:vn(n,i,r,!0),divide:t.divide,dataIndex:i})})),e}function mn(t,e,n){t.traverse((function(t){t instanceof B&&rt(t,{style:{opacity:0}},e,{dataIndex:n,isFrom:!0})}))}function xn(t){if(t.parent){var e=t.getComputedTransform();t.setLocalTransform(e),t.parent.remove(t)}}function In(t){t.stopAnimation(),t.isGroup&&t.traverse((function(t){t.stopAnimation()}))}function Mn(t,e,n){var r=yn(t),i=yn(e);function o(t,e,n,r,a){(n||t)&&e.animateFrom({style:n&&n!==t?$($({},n.style),t.style):t.style},a)}var s=!1,u=0,d=Gt(),l=Gt();r.forEach((function(t){t.groupId&&d.set(t.groupId,!0),t.childGroupId&&l.set(t.childGroupId,!0)}));for(var h=0;h<i.length;h++){var p=i[h].groupId;if(l.get(p)){u=1;break}var c=i[h].childGroupId;if(c&&d.get(c)){u=2;break}}function f(t,e){return function(n){var r=n.data,a=n.dataIndex;return e?r.getId(a):t?1===u?n.childGroupId:n.groupId:2===u?n.childGroupId:n.groupId}}var g=function(t,e){var n=t.length;if(n!==e.length)return!1;for(var r=0;r<n;r++){var a=t[r],i=e[r];if(a.data.getId(a.dataIndex)!==i.data.getId(i.dataIndex))return!1}return!0}(r,i),v={};if(!g)for(h=0;h<i.length;h++){var y=i[h],m=y.data.getItemGraphicEl(y.dataIndex);m&&(v[m.id]=!0)}function x(t,e){var n=r[e],a=i[t],u=a.data.hostModel,d=n.data.getItemGraphicEl(n.dataIndex),l=a.data.getItemGraphicEl(a.dataIndex);d!==l?d&&v[d.id]||l&&(In(l),d?(In(d),xn(d),s=!0,cn(fn(d),fn(l),a.divide,u,t,o)):mn(l,u,t)):l&&function(t,e,n){var r=Ct("update",n,e);r&&t.traverse((function(t){if(t instanceof Rt){var e=zt(t);e&&t.animateFrom({style:e},r)}}))}(l,a.dataIndex,u)}new ft(r,i,f(!0,g),f(!1,g),null,"multiple").update(x).updateManyToOne((function(t,e){var n=i[t],u=n.data,d=u.hostModel,l=u.getItemGraphicEl(n.dataIndex),h=kt(N(e,(function(t){return r[t].data.getItemGraphicEl(r[t].dataIndex)})),(function(t){return t&&t!==l&&!v[t.id]}));l&&(In(l),h.length?(a(h,(function(t){In(t),xn(t)})),s=!0,cn(fn(h),fn(l),n.divide,d,t,o)):mn(l,d,n.dataIndex))})).updateOneToMany((function(t,e){var n=r[e],u=n.data.getItemGraphicEl(n.dataIndex);if(!u||!v[u.id]){var d=kt(N(t,(function(t){return i[t].data.getItemGraphicEl(i[t].dataIndex)})),(function(t){return t&&t!==u})),l=i[t[0]].data.hostModel;d.length&&(a(d,(function(t){return In(t)})),u?(In(u),xn(u),s=!0,cn(fn(u),fn(d),n.divide,l,t[0],o)):a(d,(function(e){return mn(e,l,t[0])})))}})).updateManyToMany((function(t,e){new ft(e,t,(function(t){return r[t].data.getId(r[t].dataIndex)}),(function(t){return i[t].data.getId(i[t].dataIndex)})).update((function(n,r){x(t[n],e[r])})).execute()})).execute(),s&&a(e,(function(t){var e=t.data.hostModel,r=e&&n.getViewOfSeriesModel(e),a=Ct("update",e,0);r&&e.isAnimationEnabled()&&a&&a.duration>0&&r.group.traverse((function(t){t instanceof B&&!t.animators.length&&t.animateFrom({style:{opacity:0}},a)}))}))}function bn(t){var e=t.getModel("universalTransition").get("seriesKey");return e||t.id}function wn(t){return H(t)?t.sort().join(","):t}function _n(t){if(t.hostModel)return t.hostModel.getModel("universalTransition").get("divideShape")}function Sn(t,e){for(var n=0;n<t.length;n++){if(null!=e.seriesIndex&&e.seriesIndex===t[n].seriesIndex||null!=e.seriesId&&e.seriesId===t[n].id)return n}}function Dn(t){t.registerUpdateLifecycle("series:beforeupdate",(function(t,e,n){a(Pt(n.seriesTransition),(function(t){a(Pt(t.to),(function(t){for(var e=n.updatedSeries,r=0;r<e.length;r++)(null!=t.seriesIndex&&t.seriesIndex===e[r].seriesIndex||null!=t.seriesId&&t.seriesId===e[r].id)&&(e[r][Lt]=!0)}))}))})),t.registerUpdateLifecycle("series:transition",(function(t,e,n){var r=gn(e);if(r.oldSeries&&n.updatedSeries&&n.optionChanged){var i=n.seriesTransition;if(i)a(Pt(i),(function(t){!function(t,e,n,r){var i=[],o=[];a(Pt(t.from),(function(t){var n=Sn(e.oldSeries,t);n>=0&&i.push({dataGroupId:e.oldDataGroupIds[n],data:e.oldData[n],divide:_n(e.oldData[n]),groupIdDim:t.dimension})})),a(Pt(t.to),(function(t){var r=Sn(n.updatedSeries,t);if(r>=0){var a=n.updatedSeries[r].getData();o.push({dataGroupId:e.oldDataGroupIds[r],data:a,divide:_n(a),groupIdDim:t.dimension})}})),i.length>0&&o.length>0&&Mn(i,o,r)}(t,r,n,e)}));else{var o=function(t,e){var n=Gt(),r=Gt(),i=Gt();return a(t.oldSeries,(function(e,n){var o=t.oldDataGroupIds[n],s=t.oldData[n],u=bn(e),d=wn(u);r.set(d,{dataGroupId:o,data:s}),H(u)&&a(u,(function(t){i.set(t,{key:d,dataGroupId:o,data:s})}))})),a(e.updatedSeries,(function(t){if(t.isUniversalTransitionEnabled()&&t.isAnimationEnabled()){var e=t.get("dataGroupId"),o=t.getData(),s=bn(t),u=wn(s),d=r.get(u);if(d)n.set(u,{oldSeries:[{dataGroupId:d.dataGroupId,divide:_n(d.data),data:d.data}],newSeries:[{dataGroupId:e,divide:_n(o),data:o}]});else if(H(s)){var l=[];a(s,(function(t){var e=r.get(t);e.data&&l.push({dataGroupId:e.dataGroupId,divide:_n(e.data),data:e.data})})),l.length&&n.set(u,{oldSeries:l,newSeries:[{dataGroupId:e,data:o,divide:_n(o)}]})}else{var h=i.get(s);if(h){var p=n.get(h.key);p||(p={oldSeries:[{dataGroupId:h.dataGroupId,data:h.data,divide:_n(h.data)}],newSeries:[]},n.set(h.key,p)),p.newSeries.push({dataGroupId:e,data:o,divide:_n(o)})}}}})),n}(r,n);a(o.keys(),(function(t){var n=o.get(t);Mn(n.oldSeries,n.newSeries,e)}))}a(n.updatedSeries,(function(t){t[Lt]&&(t[Lt]=!1)}))}for(var s=t.getSeries(),u=r.oldSeries=[],d=r.oldDataGroupIds=[],l=r.oldData=[],h=0;h<s.length;h++){var p=s[h].getData();p.count()<1e4&&(u.push(s[h]),d.push(s[h].get("dataGroupId")),l.push(p))}}))}export{me as T,Me as a,ke as b,oe as c,de as d,we as e,Dn as f,Ie as g,ve as i,le as p,xe as r,be as w};
