import{L as e,bI as t,_ as a,e4 as o,aE as n,bw as i,x as r,aM as s,bj as l,ct as d,bi as u,ai as h,w as c,bl as g,dI as p,dJ as f,e5 as y,Q as v,b5 as m,b6 as x,b4 as _,cc as S,aY as b,e6 as I,af as L,e7 as w,ac as M,q as D,a0 as E,ab as A,e8 as N,ah as V,e9 as T,ad as C,aq as R,ag as z,bY as k,aF as P,ea as B,eb as Z,v as G,a$ as O,Z as j,N as H,at as F,ak as Y,du as X,dw as W,j as U,a3 as q,a2 as K,dt as J,c0 as Q,a6 as $,a5 as ee,u as te,cV as ae,ae as oe,E as ne,aA as ie,a9 as re,cz as se,ec as le,ed as de,ee as ue,ef as he,eg as ce,eh as ge,ei as pe,bC as fe,ej as ye,cg as ve,ek as me,bd as xe,O as _e,bD as Se,by as be,n as Ie,bf as Le,aJ as we,c7 as Me,cl as De,bL as Ee,aX as Ae,b8 as Ne,M as Ve,a_ as Te,el as Ce,bB as Re,aU as ze,bk as ke,dj as Pe,V as Be,cq as Ze}from"./installCanvasRenderer-DOho8wCD.js";import{R as Ge,V as Oe,u as je,d as He,e as Fe,f as Ye}from"./install-B8Boz6OP.js";import{L as Xe}from"./vintage-Cad8kZPO.js";var We=e.prototype,Ue=t.prototype,qe=function(){return function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}}();function Ke(e){return isNaN(+e.cpx1)||isNaN(+e.cpy1)}!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}a(t,e)}(qe);var Je=function(e){function t(t){var a=e.call(this,t)||this;return a.type="ec-line",a}return a(t,e),t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new qe},t.prototype.buildPath=function(e,t){Ke(t)?We.buildPath.call(this,e,t):Ue.buildPath.call(this,e,t)},t.prototype.pointAt=function(e){return Ke(this.shape)?We.pointAt.call(this,e):Ue.pointAt.call(this,e)},t.prototype.tangentAt=function(e){var t=this.shape,a=Ke(t)?[t.x2-t.x1,t.y2-t.y1]:Ue.tangentAt.call(this,e);return o(a,a)},t}(n),Qe=["fromSymbol","toSymbol"];function $e(e){return"_"+e+"Type"}function et(e,t,a){var o=t.getItemVisual(a,e);if(!o||"none"===o)return o;var n=t.getItemVisual(a,e+"Size"),i=t.getItemVisual(a,e+"Rotate"),r=t.getItemVisual(a,e+"Offset"),s=t.getItemVisual(a,e+"KeepAspect"),l=m(n);return o+l+x(r||0,l)+(i||"")+(s||"")}function tt(e,t,a){var o=t.getItemVisual(a,e);if(o&&"none"!==o){var n=t.getItemVisual(a,e+"Size"),i=t.getItemVisual(a,e+"Rotate"),r=t.getItemVisual(a,e+"Offset"),s=t.getItemVisual(a,e+"KeepAspect"),l=m(n),d=x(r||0,l),u=_(o,-l[0]/2+d[0],-l[1]/2+d[1],l[0],l[1],null,s);return u.__specifiedRotation=null==i||isNaN(i)?void 0:+i*Math.PI/180||0,u.name=e,u}}function at(e,t){e.x1=t[0][0],e.y1=t[0][1],e.x2=t[1][0],e.y2=t[1][1],e.percent=1;var a=t[2];a?(e.cpx1=a[0],e.cpy1=a[1]):(e.cpx1=NaN,e.cpy1=NaN)}var ot=function(e){function t(t,a,o){var n=e.call(this)||this;return n._createLine(t,a,o),n}return a(t,e),t.prototype._createLine=function(e,t,a){var o=e.hostModel,n=function(e){var t=new Je({name:"line",subPixelOptimize:!0});return at(t.shape,e),t}(e.getItemLayout(t));n.shape.percent=0,i(n,{shape:{percent:1}},o,t),this.add(n),r(Qe,(function(a){var o=tt(a,e,t);this.add(o),this[$e(a)]=et(a,e,t)}),this),this._updateCommonStl(e,t,a)},t.prototype.updateData=function(e,t,a){var o=e.hostModel,n=this.childOfName("line"),i=e.getItemLayout(t),l={shape:{}};at(l.shape,i),s(n,l,o,t),r(Qe,(function(a){var o=et(a,e,t),n=$e(a);if(this[n]!==o){this.remove(this.childOfName(a));var i=tt(a,e,t);this.add(i)}this[n]=o}),this),this._updateCommonStl(e,t,a)},t.prototype.getLinePath=function(){return this.childAt(0)},t.prototype._updateCommonStl=function(e,t,a){var o=e.hostModel,n=this.childOfName("line"),i=a&&a.emphasisLineStyle,s=a&&a.blurLineStyle,p=a&&a.selectLineStyle,f=a&&a.labelStatesModels,y=a&&a.emphasisDisabled,v=a&&a.focus,m=a&&a.blurScope;if(!a||e.hasItemOption){var x=e.getItemModel(t),_=x.getModel("emphasis");i=_.getModel("lineStyle").getLineStyle(),s=x.getModel(["blur","lineStyle"]).getLineStyle(),p=x.getModel(["select","lineStyle"]).getLineStyle(),y=_.get("disabled"),v=_.get("focus"),m=_.get("blurScope"),f=l(x)}var S=e.getItemVisual(t,"style"),b=S.stroke;n.useStyle(S),n.style.fill=null,n.style.strokeNoScale=!0,n.ensureState("emphasis").style=i,n.ensureState("blur").style=s,n.ensureState("select").style=p,r(Qe,(function(e){var t=this.childOfName(e);if(t){t.setColor(b),t.style.opacity=S.opacity;for(var a=0;a<d.length;a++){var o=d[a],i=n.getState(o);if(i){var r=i.style||{},s=t.ensureState(o),l=s.style||(s.style={});null!=r.stroke&&(l[t.__isEmptyBrush?"stroke":"fill"]=r.stroke),null!=r.opacity&&(l.opacity=r.opacity)}}t.markRedraw()}}),this);var I=o.getRawValue(t);u(this,f,{labelDataIndex:t,labelFetcher:{getFormattedLabel:function(t,a){return o.getFormattedLabel(t,a,e.dataType)}},inheritColor:b||"#000",defaultOpacity:S.opacity,defaultText:(null==I?e.getName(t):isFinite(I)?h(I):I)+""});var L=this.getTextContent();if(L){var w=f.normal;L.__align=L.style.align,L.__verticalAlign=L.style.verticalAlign,L.__position=w.get("position")||"middle";var M=w.get("distance");c(M)||(M=[M,M]),L.__labelDistance=M}this.setTextConfig({position:null,local:!0,inside:!1}),g(this,v,m,y)},t.prototype.highlight=function(){p(this)},t.prototype.downplay=function(){f(this)},t.prototype.updateLayout=function(e,t){this.setLinePoints(e.getItemLayout(t))},t.prototype.setLinePoints=function(e){var t=this.childOfName("line");at(t.shape,e),t.dirty()},t.prototype.beforeUpdate=function(){var e=this,t=e.childOfName("fromSymbol"),a=e.childOfName("toSymbol"),n=e.getTextContent();if(t||a||n&&!n.ignore){for(var i=1,r=this.parent;r;)r.scaleX&&(i/=r.scaleX),r=r.parent;var s=e.childOfName("line");if(this.__dirty||s.__dirty){var l=s.shape.percent,d=s.pointAt(0),u=s.pointAt(l),h=y([],u,d);if(o(h,h),t&&(t.setPosition(d),w(t,0),t.scaleX=t.scaleY=i*l,t.markRedraw()),a&&(a.setPosition(u),w(a,1),a.scaleX=a.scaleY=i*l,a.markRedraw()),n&&!n.ignore){n.x=n.y=0,n.originX=n.originY=0;var c=void 0,g=void 0,p=n.__labelDistance,f=p[0]*i,v=p[1]*i,m=l/2,x=s.tangentAt(m),_=[x[1],-x[0]],S=s.pointAt(m);_[1]>0&&(_[0]=-_[0],_[1]=-_[1]);var b=x[0]<0?-1:1;if("start"!==n.__position&&"end"!==n.__position){var I=-Math.atan2(x[1],x[0]);u[0]<d[0]&&(I=Math.PI+I),n.rotation=I}var L=void 0;switch(n.__position){case"insideStartTop":case"insideMiddleTop":case"insideEndTop":case"middle":L=-v,g="bottom";break;case"insideStartBottom":case"insideMiddleBottom":case"insideEndBottom":L=v,g="top";break;default:L=0,g="middle"}switch(n.__position){case"end":n.x=h[0]*f+u[0],n.y=h[1]*v+u[1],c=h[0]>.8?"left":h[0]<-.8?"right":"center",g=h[1]>.8?"top":h[1]<-.8?"bottom":"middle";break;case"start":n.x=-h[0]*f+d[0],n.y=-h[1]*v+d[1],c=h[0]>.8?"right":h[0]<-.8?"left":"center",g=h[1]>.8?"bottom":h[1]<-.8?"top":"middle";break;case"insideStartTop":case"insideStart":case"insideStartBottom":n.x=f*b+d[0],n.y=d[1]+L,c=x[0]<0?"right":"left",n.originX=-f*b,n.originY=-L;break;case"insideMiddleTop":case"insideMiddle":case"insideMiddleBottom":case"middle":n.x=S[0],n.y=S[1]+L,c="center",n.originY=-L;break;case"insideEndTop":case"insideEnd":case"insideEndBottom":n.x=-f*b+u[0],n.y=u[1]+L,c=x[0]>=0?"right":"left",n.originX=f*b,n.originY=-L}n.scaleX=n.scaleY=i,n.setStyle({verticalAlign:n.__verticalAlign||g,align:n.__align||c})}}}function w(e,t){var a=e.__specifiedRotation;if(null==a){var o=s.tangentAt(t);e.attr("rotation",(1===t?-1:1)*Math.PI/2-Math.atan2(o[1],o[0]))}else e.attr("rotation",a)}},t}(v),nt=function(){function e(e){this.group=new v,this._LineCtor=e||ot}return e.prototype.updateData=function(e){var t=this;this._progressiveEls=null;var a=this,o=a.group,n=a._lineData;a._lineData=e,n||o.removeAll();var i=it(e);e.diff(n).add((function(a){t._doAdd(e,a,i)})).update((function(a,o){t._doUpdate(n,e,o,a,i)})).remove((function(e){o.remove(n.getItemGraphicEl(e))})).execute()},e.prototype.updateLayout=function(){var e=this._lineData;e&&e.eachItemGraphicEl((function(t,a){t.updateLayout(e,a)}),this)},e.prototype.incrementalPrepareUpdate=function(e){this._seriesScope=it(e),this._lineData=null,this.group.removeAll()},e.prototype.incrementalUpdate=function(e,t){function a(e){e.isGroup||function(e){return e.animators&&e.animators.length>0}(e)||(e.incremental=!0,e.ensureState("emphasis").hoverLayer=!0)}this._progressiveEls=[];for(var o=e.start;o<e.end;o++){if(st(t.getItemLayout(o))){var n=new this._LineCtor(t,o,this._seriesScope);n.traverse(a),this.group.add(n),t.setItemGraphicEl(o,n),this._progressiveEls.push(n)}}},e.prototype.remove=function(){this.group.removeAll()},e.prototype.eachRendered=function(e){S(this._progressiveEls||this.group,e)},e.prototype._doAdd=function(e,t,a){if(st(e.getItemLayout(t))){var o=new this._LineCtor(e,t,a);e.setItemGraphicEl(t,o),this.group.add(o)}},e.prototype._doUpdate=function(e,t,a,o,n){var i=e.getItemGraphicEl(a);st(t.getItemLayout(o))?(i?i.updateData(t,o,n):i=new this._LineCtor(t,o,n),t.setItemGraphicEl(o,i),this.group.add(i)):this.group.remove(i)},e}();function it(e){var t=e.hostModel,a=t.getModel("emphasis");return{lineStyle:t.getModel("lineStyle").getLineStyle(),emphasisLineStyle:a.getModel(["lineStyle"]).getLineStyle(),blurLineStyle:t.getModel(["blur","lineStyle"]).getLineStyle(),selectLineStyle:t.getModel(["select","lineStyle"]).getLineStyle(),emphasisDisabled:a.get("disabled"),blurScope:a.get("blurScope"),focus:a.get("focus"),labelStatesModels:l(t)}}function rt(e){return isNaN(e[0])||isNaN(e[1])}function st(e){return e&&!rt(e[0])&&!rt(e[1])}var lt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return a(t,e),t.type="dataZoom.inside",t.defaultOption=b(I.defaultOption,{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),t}(I),dt=D();function ut(e,t){if(t){e.removeKey(t.model.uid);var a=t.controller;a&&a.dispose()}}function ht(e,t){e.isDisposed()||e.dispatchAction({type:"dataZoom",animation:{easing:"cubicOut",duration:100},batch:t})}function ct(e,t,a,o){return e.coordinateSystem.containPoint([a,o])}function gt(e){e.registerProcessor(e.PRIORITY.PROCESSOR.FILTER,(function(e,t){var a=dt(t),o=a.coordSysRecordMap||(a.coordSysRecordMap=L());o.each((function(e){e.dataZoomInfoMap=null})),e.eachComponent({mainType:"dataZoom",subType:"inside"},(function(e){var a=w(e);r(a.infoList,(function(a){var n=a.model.uid,i=o.get(n)||o.set(n,function(e,t){var a={model:t,containsPoint:E(ct,t),dispatchAction:E(ht,e),dataZoomInfoMap:null,controller:null},o=a.controller=new Ge(e.getZr());return r(["pan","zoom","scrollMove"],(function(e){o.on(e,(function(t){var o=[];a.dataZoomInfoMap.each((function(n){if(t.isAvailableBehavior(n.model.option)){var i=(n.getRange||{})[e],r=i&&i(n.dzReferCoordSysInfo,a.model.mainType,a.controller,t);!n.model.get("disabled",!0)&&r&&o.push({dataZoomId:n.model.id,start:r[0],end:r[1]})}})),o.length&&a.dispatchAction(o)}))})),a}(t,a.model));(i.dataZoomInfoMap||(i.dataZoomInfoMap=L())).set(e.uid,{dzReferCoordSysInfo:a,model:e,getRange:null})}))})),o.each((function(e){var t,a=e.controller,n=e.dataZoomInfoMap;if(n){var i=n.keys()[0];null!=i&&(t=n.get(i))}if(t){var r=function(e){var t,a="type_",o={type_true:2,type_move:1,type_false:0,type_undefined:-1},n=!0;return e.each((function(e){var i=e.model,r=!i.get("disabled",!0)&&(!i.get("zoomLock",!0)||"move");o[a+r]>o[a+t]&&(t=r),n=n&&i.get("preventDefaultMouseMove",!0)})),{controlType:t,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!n}}}(n);a.enable(r.controlType,r.opt),a.setPointerChecker(e.containsPoint),M(e,"dispatchAction",t.model.get("throttle",!0),"fixRate")}else ut(o,e)}))}))}var pt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="dataZoom.inside",t}return a(t,e),t.prototype.render=function(t,a,o){e.prototype.render.apply(this,arguments),t.noTarget()?this._clear():(this.range=t.getPercentRange(),function(e,t,a){dt(e).coordSysRecordMap.each((function(e){var o=e.dataZoomInfoMap.get(t.uid);o&&(o.getRange=a)}))}(o,t,{pan:A(ft.pan,this),zoom:A(ft.zoom,this),scrollMove:A(ft.scrollMove,this)}))},t.prototype.dispose=function(){this._clear(),e.prototype.dispose.apply(this,arguments)},t.prototype._clear=function(){!function(e,t){for(var a=dt(e).coordSysRecordMap,o=a.keys(),n=0;n<o.length;n++){var i=o[n],r=a.get(i),s=r.dataZoomInfoMap;if(s){var l=t.uid;s.get(l)&&(s.removeKey(l),s.keys().length||ut(a,r))}}}(this.api,this.dataZoomModel),this.range=null},t.type="dataZoom.inside",t}(N),ft={zoom:function(e,t,a,o){var n=this.range,i=n.slice(),r=e.axisModels[0];if(r){var s=vt[t](null,[o.originX,o.originY],r,a,e),l=(s.signal>0?s.pixelStart+s.pixelLength-s.pixel:s.pixel-s.pixelStart)/s.pixelLength*(i[1]-i[0])+i[0],d=Math.max(1/o.scale,0);i[0]=(i[0]-l)*d+l,i[1]=(i[1]-l)*d+l;var u=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();return V(0,i,[0,100],0,u.minSpan,u.maxSpan),this.range=i,n[0]!==i[0]||n[1]!==i[1]?i:void 0}},pan:yt((function(e,t,a,o,n,i){var r=vt[o]([i.oldX,i.oldY],[i.newX,i.newY],t,n,a);return r.signal*(e[1]-e[0])*r.pixel/r.pixelLength})),scrollMove:yt((function(e,t,a,o,n,i){return vt[o]([0,0],[i.scrollDelta,i.scrollDelta],t,n,a).signal*(e[1]-e[0])*i.scrollDelta}))};function yt(e){return function(t,a,o,n){var i=this.range,r=i.slice(),s=t.axisModels[0];if(s){var l=e(r,s,t,a,o,n);return V(l,r,[0,100],"all"),this.range=r,i[0]!==r[0]||i[1]!==r[1]?r:void 0}}}var vt={grid:function(e,t,a,o,n){var i=a.axis,r={},s=n.model.coordinateSystem.getRect();return e=e||[0,0],"x"===i.dim?(r.pixel=t[0]-e[0],r.pixelLength=s.width,r.pixelStart=s.x,r.signal=i.inverse?1:-1):(r.pixel=t[1]-e[1],r.pixelLength=s.height,r.pixelStart=s.y,r.signal=i.inverse?-1:1),r},polar:function(e,t,a,o,n){var i=a.axis,r={},s=n.model.coordinateSystem,l=s.getRadiusAxis().getExtent(),d=s.getAngleAxis().getExtent();return e=e?s.pointToCoord(e):[0,0],t=s.pointToCoord(t),"radiusAxis"===a.mainType?(r.pixel=t[0]-e[0],r.pixelLength=l[1]-l[0],r.pixelStart=l[0],r.signal=i.inverse?1:-1):(r.pixel=t[1]-e[1],r.pixelLength=d[1]-d[0],r.pixelStart=d[0],r.signal=i.inverse?-1:1),r},singleAxis:function(e,t,a,o,n){var i=a.axis,r=n.model.coordinateSystem.getRect(),s={};return e=e||[0,0],"horizontal"===i.orient?(s.pixel=t[0]-e[0],s.pixelLength=r.width,s.pixelStart=r.x,s.signal=i.inverse?1:-1):(s.pixel=t[1]-e[1],s.pixelLength=r.height,s.pixelStart=r.y,s.signal=i.inverse?-1:1),s}};function mt(e){T(e),e.registerComponentModel(lt),e.registerComponentView(pt),gt(e)}var xt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return a(t,e),t.type="dataZoom.slider",t.layoutMode="box",t.defaultOption=b(I.defaultOption,{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,borderColor:"#d2dbee",borderRadius:3,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#d2dbee",width:.5},areaStyle:{color:"#d2dbee",opacity:.2}},selectedDataBackground:{lineStyle:{color:"#8fb0f7",width:.5},areaStyle:{color:"#8fb0f7",opacity:.2}},fillerColor:"rgba(135,175,274,0.2)",handleIcon:"path://M-9.35,34.56V42m0-40V9.5m-2,0h4a2,2,0,0,1,2,2v21a2,2,0,0,1-2,2h-4a2,2,0,0,1-2-2v-21A2,2,0,0,1-11.35,9.5Z",handleSize:"100%",handleStyle:{color:"#fff",borderColor:"#ACB8D1"},moveHandleSize:7,moveHandleIcon:"path://M-320.9-50L-320.9-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-348-41-339-50-320.9-50z M-212.3-50L-212.3-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-239.4-41-230.4-50-212.3-50z M-103.7-50L-103.7-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-130.9-41-121.8-50-103.7-50z",moveHandleStyle:{color:"#D2DBEE",opacity:.7},showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#6E7079"},brushSelect:!0,brushStyle:{color:"rgba(135,175,274,0.15)"},emphasis:{handleLabel:{show:!0},handleStyle:{borderColor:"#8FB0F7"},moveHandleStyle:{color:"#8FB0F7"}}}),t}(I),_t=F,St="horizontal",bt="vertical",It=["line","bar","candlestick","scatter"],Lt={easing:"cubicOut",duration:100,delay:0},wt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a._displayables={},a}return a(t,e),t.prototype.init=function(e,t){this.api=t,this._onBrush=A(this._onBrush,this),this._onBrushEnd=A(this._onBrushEnd,this)},t.prototype.render=function(t,a,o,n){if(e.prototype.render.apply(this,arguments),M(this,"_dispatchZoomAction",t.get("throttle"),"fixRate"),this._orient=t.getOrient(),!1!==t.get("show")){if(t.noTarget())return this._clear(),void this.group.removeAll();n&&"dataZoom"===n.type&&n.from===this.uid||this._buildView(),this._updateView()}else this.group.removeAll()},t.prototype.dispose=function(){this._clear(),e.prototype.dispose.apply(this,arguments)},t.prototype._clear=function(){C(this,"_dispatchZoomAction");var e=this.api.getZr();e.off("mousemove",this._onBrush),e.off("mouseup",this._onBrushEnd)},t.prototype._buildView=function(){var e=this.group;e.removeAll(),this._brushing=!1,this._displayables.brushRect=null,this._resetLocation(),this._resetInterval();var t=this._displayables.sliderGroup=new v;this._renderBackground(),this._renderHandle(),this._renderDataShadow(),e.add(t),this._positionGroup()},t.prototype._resetLocation=function(){var e=this.dataZoomModel,t=this.api,a=e.get("brushSelect")?7:0,o=this._findCoordRect(),n={width:t.getWidth(),height:t.getHeight()},i=this._orient===St?{right:n.width-o.x-o.width,top:n.height-30-7-a,width:o.width,height:30}:{right:7,top:o.y,width:30,height:o.height},s=R(e.option);r(["right","top","width","height"],(function(e){"ph"===s[e]&&(s[e]=i[e])}));var l=z(s,n);this._location={x:l.x,y:l.y},this._size=[l.width,l.height],this._orient===bt&&this._size.reverse()},t.prototype._positionGroup=function(){var e=this.group,t=this._location,a=this._orient,o=this.dataZoomModel.getFirstTargetAxisModel(),n=o&&o.get("inverse"),i=this._displayables.sliderGroup,r=(this._dataShadowInfo||{}).otherAxisInverse;i.attr(a!==St||n?a===St&&n?{scaleY:r?1:-1,scaleX:-1}:a!==bt||n?{scaleY:r?-1:1,scaleX:-1,rotation:Math.PI/2}:{scaleY:r?-1:1,scaleX:1,rotation:Math.PI/2}:{scaleY:r?1:-1,scaleX:1});var s=e.getBoundingRect([i]);e.x=t.x-s.x,e.y=t.y-s.y,e.markRedraw()},t.prototype._getViewExtent=function(){return[0,this._size[0]]},t.prototype._renderBackground=function(){var e=this.dataZoomModel,t=this._size,a=this._displayables.sliderGroup,o=e.get("brushSelect");a.add(new _t({silent:!0,shape:{x:0,y:0,width:t[0],height:t[1]},style:{fill:e.get("backgroundColor")},z2:-40}));var n=new _t({shape:{x:0,y:0,width:t[0],height:t[1]},style:{fill:"transparent"},z2:0,onclick:A(this._onClickPanel,this)}),i=this.api.getZr();o?(n.on("mousedown",this._onBrushStart,this),n.cursor="crosshair",i.on("mousemove",this._onBrush),i.on("mouseup",this._onBrushEnd)):(i.off("mousemove",this._onBrush),i.off("mouseup",this._onBrushEnd)),a.add(n)},t.prototype._renderDataShadow=function(){var e=this._dataShadowInfo=this._prepareDataShadowInfo();if(this._displayables.dataShadowSegs=[],e){var t=this._size,a=this._shadowSize||[],o=e.series,n=o.getRawData(),i=o.getShadowDim&&o.getShadowDim(),r=i&&n.getDimensionInfo(i)?o.getShadowDim():e.otherDim;if(null!=r){var s=this._shadowPolygonPts,l=this._shadowPolylinePts;if(n!==this._shadowData||r!==this._shadowDim||t[0]!==a[0]||t[1]!==a[1]){var d=n.getDataExtent(r),u=.3*(d[1]-d[0]);d=[d[0]-u,d[1]+u];var h,c=[0,t[1]],g=[0,t[0]],p=[[t[0],0],[0,0]],f=[],y=g[1]/(n.count()-1),m=0,x=Math.round(n.count()/t[0]);n.each([r],(function(e,t){if(x>0&&t%x)m+=y;else{var a=null==e||isNaN(e)||""===e,o=a?0:k(e,d,c,!0);a&&!h&&t?(p.push([p[p.length-1][0],0]),f.push([f[f.length-1][0],0])):!a&&h&&(p.push([m,0]),f.push([m,0])),p.push([m,o]),f.push([m,o]),m+=y,h=a}})),s=this._shadowPolygonPts=p,l=this._shadowPolylinePts=f}this._shadowData=n,this._shadowDim=r,this._shadowSize=[t[0],t[1]];for(var _,S,b,I,L,w=this.dataZoomModel,M=0;M<3;M++){var D=(_=1===M,S=void 0,b=void 0,I=void 0,L=void 0,S=w.getModel(_?"selectedDataBackground":"dataBackground"),b=new v,I=new $({shape:{points:s},segmentIgnoreThreshold:1,style:S.getModel("areaStyle").getAreaStyle(),silent:!0,z2:-20}),L=new ee({shape:{points:l},segmentIgnoreThreshold:1,style:S.getModel("lineStyle").getLineStyle(),silent:!0,z2:-19}),b.add(I),b.add(L),b);this._displayables.sliderGroup.add(D),this._displayables.dataShadowSegs.push(D)}}}},t.prototype._prepareDataShadowInfo=function(){var e=this.dataZoomModel,t=e.get("showDataShadow");if(!1!==t){var a,o=this.ecModel;return e.eachTargetAxis((function(n,i){var s=e.getAxisProxy(n,i).getTargetSeriesModels();r(s,(function(e){if(!(a||!0!==t&&P(It,e.get("type"))<0)){var r,s=o.getComponent(B(n),i).axis,l={x:"y",y:"x",radius:"angle",angle:"radius"}[n],d=e.coordinateSystem;null!=l&&d.getOtherAxis&&(r=d.getOtherAxis(s).inverse),l=e.getData().mapDimension(l),a={thisAxis:s,series:e,thisDim:n,otherDim:l,otherAxisInverse:r}}}),this)}),this),a}},t.prototype._renderHandle=function(){var e=this.group,t=this._displayables,a=t.handles=[null,null],o=t.handleLabels=[null,null],n=this._displayables.sliderGroup,i=this._size,s=this.dataZoomModel,l=this.api,d=s.get("borderRadius")||0,u=s.get("brushSelect"),h=t.filler=new _t({silent:u,style:{fill:s.get("fillerColor")},textConfig:{position:"inside"}});n.add(h),n.add(new _t({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:i[0],height:i[1],r:d},style:{stroke:s.get("dataBackgroundColor")||s.get("borderColor"),lineWidth:1,fill:"rgba(0,0,0,0)"}})),r([0,1],(function(t){var i=s.get("handleIcon");!Z[i]&&i.indexOf("path://")<0&&i.indexOf("image://")<0&&(i="path://"+i);var r=_(i,-1,0,2,2,null,!0);r.attr({cursor:Mt(this._orient),draggable:!0,drift:A(this._onDragMove,this,t),ondragend:A(this._onDragEnd,this),onmouseover:A(this._showDataInfo,this,!0),onmouseout:A(this._showDataInfo,this,!1),z2:5});var l=r.getBoundingRect(),d=s.get("handleSize");this._handleHeight=G(d,this._size[1]),this._handleWidth=l.width/l.height*this._handleHeight,r.setStyle(s.getModel("handleStyle").getItemStyle()),r.style.strokeNoScale=!0,r.rectHover=!0,r.ensureState("emphasis").style=s.getModel(["emphasis","handleStyle"]).getItemStyle(),O(r);var u=s.get("handleColor");null!=u&&(r.style.fill=u),n.add(a[t]=r);var h=s.getModel("textStyle"),c=(s.get("handleLabel")||{}).show||!1;e.add(o[t]=new j({silent:!0,invisible:!c,style:H(h,{x:0,y:0,text:"",verticalAlign:"middle",align:"center",fill:h.getTextColor(),font:h.getFont()}),z2:10}))}),this);var c=h;if(u){var g=G(s.get("moveHandleSize"),i[1]),p=t.moveHandle=new F({style:s.getModel("moveHandleStyle").getItemStyle(),silent:!0,shape:{r:[0,0,2,2],y:i[1]-.5,height:g}}),f=.8*g,y=t.moveHandleIcon=_(s.get("moveHandleIcon"),-f/2,-f/2,f,f,"#fff",!0);y.silent=!0,y.y=i[1]+g/2-.5,p.ensureState("emphasis").style=s.getModel(["emphasis","moveHandleStyle"]).getItemStyle();var v=Math.min(i[1]/2,Math.max(g,10));(c=t.moveZone=new F({invisible:!0,shape:{y:i[1]-v,height:g+v}})).on("mouseover",(function(){l.enterEmphasis(p)})).on("mouseout",(function(){l.leaveEmphasis(p)})),n.add(p),n.add(y),n.add(c)}c.attr({draggable:!0,cursor:Mt(this._orient),drift:A(this._onDragMove,this,"all"),ondragstart:A(this._showDataInfo,this,!0),ondragend:A(this._onDragEnd,this),onmouseover:A(this._showDataInfo,this,!0),onmouseout:A(this._showDataInfo,this,!1)})},t.prototype._resetInterval=function(){var e=this._range=this.dataZoomModel.getPercentRange(),t=this._getViewExtent();this._handleEnds=[k(e[0],[0,100],t,!0),k(e[1],[0,100],t,!0)]},t.prototype._updateInterval=function(e,t){var a=this.dataZoomModel,o=this._handleEnds,n=this._getViewExtent(),i=a.findRepresentativeAxisProxy().getMinMaxSpan(),r=[0,100];V(t,o,n,a.get("zoomLock")?"all":e,null!=i.minSpan?k(i.minSpan,r,n,!0):null,null!=i.maxSpan?k(i.maxSpan,r,n,!0):null);var s=this._range,l=this._range=Y([k(o[0],n,r,!0),k(o[1],n,r,!0)]);return!s||s[0]!==l[0]||s[1]!==l[1]},t.prototype._updateView=function(e){var t=this._displayables,a=this._handleEnds,o=Y(a.slice()),n=this._size;r([0,1],(function(e){var o=t.handles[e],i=this._handleHeight;o.attr({scaleX:i/2,scaleY:i/2,x:a[e]+(e?-1:1),y:n[1]/2-i/2})}),this),t.filler.setShape({x:o[0],y:0,width:o[1]-o[0],height:n[1]});var i={x:o[0],width:o[1]-o[0]};t.moveHandle&&(t.moveHandle.setShape(i),t.moveZone.setShape(i),t.moveZone.getBoundingRect(),t.moveHandleIcon&&t.moveHandleIcon.attr("x",i.x+i.width/2));for(var s=t.dataShadowSegs,l=[0,o[0],o[1],n[0]],d=0;d<s.length;d++){var u=s[d],h=u.getClipPath();h||(h=new F,u.setClipPath(h)),h.setShape({x:l[d],y:0,width:l[d+1]-l[d],height:n[1]})}this._updateDataInfo(e)},t.prototype._updateDataInfo=function(e){var t=this.dataZoomModel,a=this._displayables,o=a.handleLabels,n=this._orient,i=["",""];if(t.get("showDetail")){var r=t.findRepresentativeAxisProxy();if(r){var s=r.getAxisModel().axis,l=this._range,d=e?r.calculateDataWindow({start:l[0],end:l[1]}).valueWindow:r.getDataValueWindow();i=[this._formatLabel(d[0],s),this._formatLabel(d[1],s)]}}var u=Y(this._handleEnds.slice());function h(e){var t=X(a.handles[e].parent,this.group),r=W(0===e?"right":"left",t),s=this._handleWidth/2+5,l=U([u[e]+(0===e?-s:s),this._size[1]/2],t);o[e].setStyle({x:l[0],y:l[1],verticalAlign:n===St?"middle":r,align:n===St?r:"center",text:i[e]})}h.call(this,0),h.call(this,1)},t.prototype._formatLabel=function(e,t){var a=this.dataZoomModel,o=a.get("labelFormatter"),n=a.get("labelPrecision");null!=n&&"auto"!==n||(n=t.getPixelPrecision());var i=null==e||isNaN(e)?"":"category"===t.type||"time"===t.type?t.scale.getLabel({value:Math.round(e)}):e.toFixed(Math.min(n,20));return q(o)?o(e,i):K(o)?o.replace("{value}",i):i},t.prototype._showDataInfo=function(e){var t=(this.dataZoomModel.get("handleLabel")||{}).show||!1,a=this.dataZoomModel.getModel(["emphasis","handleLabel"]).get("show")||!1,o=e||this._dragging?a:t,n=this._displayables,i=n.handleLabels;i[0].attr("invisible",!o),i[1].attr("invisible",!o),n.moveHandle&&this.api[o?"enterEmphasis":"leaveEmphasis"](n.moveHandle,1)},t.prototype._onDragMove=function(e,t,a,o){this._dragging=!0,J(o.event);var n=this._displayables.sliderGroup.getLocalTransform(),i=U([t,a],n,!0),r=this._updateInterval(e,i[0]),s=this.dataZoomModel.get("realtime");this._updateView(!s),r&&s&&this._dispatchZoomAction(!0)},t.prototype._onDragEnd=function(){this._dragging=!1,this._showDataInfo(!1),!this.dataZoomModel.get("realtime")&&this._dispatchZoomAction(!1)},t.prototype._onClickPanel=function(e){var t=this._size,a=this._displayables.sliderGroup.transformCoordToLocal(e.offsetX,e.offsetY);if(!(a[0]<0||a[0]>t[0]||a[1]<0||a[1]>t[1])){var o=this._handleEnds,n=(o[0]+o[1])/2,i=this._updateInterval("all",a[0]-n);this._updateView(),i&&this._dispatchZoomAction(!1)}},t.prototype._onBrushStart=function(e){var t=e.offsetX,a=e.offsetY;this._brushStart=new Q(t,a),this._brushing=!0,this._brushStartTime=+new Date},t.prototype._onBrushEnd=function(e){if(this._brushing){var t=this._displayables.brushRect;if(this._brushing=!1,t){t.attr("ignore",!0);var a=t.shape;if(!(+new Date-this._brushStartTime<200&&Math.abs(a.width)<5)){var o=this._getViewExtent(),n=[0,100];this._range=Y([k(a.x,o,n,!0),k(a.x+a.width,o,n,!0)]),this._handleEnds=[a.x,a.x+a.width],this._updateView(),this._dispatchZoomAction(!1)}}}},t.prototype._onBrush=function(e){this._brushing&&(J(e.event),this._updateBrushRect(e.offsetX,e.offsetY))},t.prototype._updateBrushRect=function(e,t){var a=this._displayables,o=this.dataZoomModel,n=a.brushRect;n||(n=a.brushRect=new _t({silent:!0,style:o.getModel("brushStyle").getItemStyle()}),a.sliderGroup.add(n)),n.attr("ignore",!1);var i=this._brushStart,r=this._displayables.sliderGroup,s=r.transformCoordToLocal(e,t),l=r.transformCoordToLocal(i.x,i.y),d=this._size;s[0]=Math.max(Math.min(d[0],s[0]),0),n.setShape({x:l[0],y:0,width:s[0]-l[0],height:d[1]})},t.prototype._dispatchZoomAction=function(e){var t=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,animation:e?Lt:null,start:t[0],end:t[1]})},t.prototype._findCoordRect=function(){var e,t=w(this.dataZoomModel).infoList;if(!e&&t.length){var a=t[0].model.coordinateSystem;e=a.getRect&&a.getRect()}if(!e){var o=this.api.getWidth(),n=this.api.getHeight();e={x:.2*o,y:.2*n,width:.6*o,height:.6*n}}return e},t.type="dataZoom.slider",t}(N);function Mt(e){return"vertical"===e?"ns-resize":"ew-resize"}function Dt(e){e.registerComponentModel(xt),e.registerComponentView(wt),T(e)}function Et(e){te(mt),te(Dt)}var At=D();function Nt(e){var t=e.mainData,a=e.datas;a||(a={main:t},e.datasAttr={main:"data"}),e.datas=e.mainData=null,kt(t,a,e),r(a,(function(a){r(t.TRANSFERABLE_METHODS,(function(t){a.wrapMethod(t,E(Vt,e))}))})),t.wrapMethod("cloneShallow",E(Ct,e)),r(t.CHANGABLE_METHODS,(function(a){t.wrapMethod(a,E(Tt,e))})),ae(a[t.dataType]===t)}function Vt(e,t){if(At(o=this).mainData===o){var a=oe({},At(this).datas);a[this.dataType]=t,kt(t,a,e)}else Pt(t,this.dataType,At(this).mainData,e);var o;return t}function Tt(e,t){return e.struct&&e.struct.update(),t}function Ct(e,t){return r(At(t).datas,(function(a,o){a!==t&&Pt(a.cloneShallow(),o,t,e)})),t}function Rt(e){var t=At(this).mainData;return null==e||null==t?t:At(t).datas[e]}function zt(){var e=At(this).mainData;return null==e?[{data:e}]:ne(ie(At(e).datas),(function(t){return{type:t,data:At(e).datas[t]}}))}function kt(e,t,a){At(e).datas={},r(t,(function(t,o){Pt(t,o,e,a)}))}function Pt(e,t,a,o){At(a).datas[t]=e,At(e).mainData=a,e.dataType=t,o.struct&&(e[o.structAttr]=o.struct,o.struct[o.datasAttr[t]]=e),e.getLinkedData=Rt,e.getLinkedDataAll=zt}function Bt(e){var t=e.findComponents({mainType:"legend"});t&&t.length&&e.eachSeriesByType("graph",(function(e){var a=e.getCategoriesData(),o=e.getGraph().data,n=a.mapArray(a.getName);o.filterSelf((function(e){var a=o.getItemModel(e).getShallow("category");if(null!=a){re(a)&&(a=n[a]);for(var i=0;i<t.length;i++)if(!t[i].isSelected(a))return!1}return!0}))}))}function Zt(e){var t={};e.eachSeriesByType("graph",(function(e){var a=e.getCategoriesData(),o=e.getData(),n={};a.each((function(o){var i=a.getName(o);n["ec-"+i]=o;var r=a.getItemModel(o),s=r.getModel("itemStyle").getItemStyle();s.fill||(s.fill=e.getColorFromPalette(i,t)),a.setItemVisual(o,"style",s);for(var l=["symbol","symbolSize","symbolKeepAspect"],d=0;d<l.length;d++){var u=r.getShallow(l[d],!0);null!=u&&a.setItemVisual(o,l[d],u)}})),a.count()&&o.each((function(e){var t=o.getItemModel(e).getShallow("category");if(null!=t){K(t)&&(t=n["ec-"+t]);var i=a.getItemVisual(t,"style"),r=o.ensureUniqueItemVisual(e,"style");oe(r,i);for(var s=["symbol","symbolSize","symbolKeepAspect"],l=0;l<s.length;l++)o.setItemVisual(e,s[l],a.getItemVisual(t,s[l]))}}))}))}function Gt(e){return e instanceof Array||(e=[e,e]),e}function Ot(e){e.eachSeriesByType("graph",(function(e){var t=e.getGraph(),a=e.getEdgeData(),o=Gt(e.get("edgeSymbol")),n=Gt(e.get("edgeSymbolSize"));a.setVisual("fromSymbol",o&&o[0]),a.setVisual("toSymbol",o&&o[1]),a.setVisual("fromSymbolSize",n&&n[0]),a.setVisual("toSymbolSize",n&&n[1]),a.setVisual("style",e.getModel("lineStyle").getLineStyle()),a.each((function(e){var o=a.getItemModel(e),n=t.getEdgeByIndex(e),i=Gt(o.getShallow("symbol",!0)),r=Gt(o.getShallow("symbolSize",!0)),s=o.getModel("lineStyle").getLineStyle(),l=a.ensureUniqueItemVisual(e,"style");switch(oe(l,s),l.stroke){case"source":var d=n.node1.getVisual("style");l.stroke=d&&d.fill;break;case"target":d=n.node2.getVisual("style");l.stroke=d&&d.fill}i[0]&&n.setVisual("fromSymbol",i[0]),i[1]&&n.setVisual("toSymbol",i[1]),r[0]&&n.setVisual("fromSymbolSize",r[0]),r[1]&&n.setVisual("toSymbolSize",r[1])}))}))}var jt="--\x3e",Ht=function(e){return e.get("autoCurveness")||null},Ft=function(e,t){var a=Ht(e),o=20,n=[];if(re(a))o=a;else if(c(a))return void(e.__curvenessList=a);t>o&&(o=t);var i=o%2?o+2:o+3;n=[];for(var r=0;r<i;r++)n.push((r%2?r+1:r)/10*(r%2?-1:1));e.__curvenessList=n},Yt=function(e,t,a){var o=[e.id,e.dataIndex].join("."),n=[t.id,t.dataIndex].join(".");return[a.uid,o,n].join(jt)},Xt=function(e){var t=e.split(jt);return[t[0],t[2],t[1]].join(jt)},Wt=function(e,t){var a=t.__edgeMap;return a[e]?a[e].length:0};function Ut(e,t,a,o){var n=Ht(t),i=c(n);if(!n)return null;var r=function(e,t){var a=Yt(e.node1,e.node2,t);return t.__edgeMap[a]}(e,t);if(!r)return null;for(var s=-1,l=0;l<r.length;l++)if(r[l]===a){s=l;break}var d=function(e,t){return Wt(Yt(e.node1,e.node2,t),t)+Wt(Yt(e.node2,e.node1,t),t)}(e,t);Ft(t,d),e.lineStyle=e.lineStyle||{};var u=Yt(e.node1,e.node2,t),h=t.__curvenessList,g=i||d%2?0:1;if(r.isForward)return h[g+s];var p=Xt(u),f=Wt(p,t),y=h[s+f+g];return o?i?n&&0===n[0]?(f+g)%2?y:-y:((f%2?0:1)+g)%2?y:-y:(f+g)%2?y:-y:h[s+f+g]}function qt(e){var t=e.coordinateSystem;if(!t||"view"===t.type){var a=e.getGraph();a.eachNode((function(e){var t=e.getModel();e.setLayout([+t.get("x"),+t.get("y")])})),Kt(a,e)}}function Kt(e,t){e.eachEdge((function(e,a){var o=se(e.getModel().get(["lineStyle","curveness"]),-Ut(e,t,a,!0),0),n=le(e.node1.getLayout()),i=le(e.node2.getLayout()),r=[n,i];+o&&r.push([(n[0]+i[0])/2-(n[1]-i[1])*o,(n[1]+i[1])/2-(i[0]-n[0])*o]),e.setLayout(r)}))}function Jt(e,t){e.eachSeriesByType("graph",(function(e){var t=e.get("layout"),a=e.coordinateSystem;if(a&&"view"!==a.type){var o=e.getData(),n=[];r(a.dimensions,(function(e){n=n.concat(o.mapDimensionsAll(e))}));for(var i=0;i<o.count();i++){for(var s=[],l=!1,d=0;d<n.length;d++){var u=o.get(n[d],i);isNaN(u)||(l=!0),s.push(u)}l?o.setItemLayout(i,a.dataToPoint(s)):o.setItemLayout(i,[NaN,NaN])}Kt(o.graph,e)}else t&&"none"!==t||qt(e)}))}function Qt(e){var t=e.coordinateSystem;if("view"!==t.type)return 1;var a=e.option.nodeScaleRatio,o=t.scaleX;return((t.getZoom()-1)*a+1)/o}function $t(e){var t=e.getVisual("symbolSize");return t instanceof Array&&(t=(t[0]+t[1])/2),+t}var ea=Math.PI,ta=[];function aa(e,t,a,n){var i=e.coordinateSystem;if(!i||"view"===i.type){var r=i.getBoundingRect(),s=e.getData(),l=s.graph,d=r.width/2+r.x,u=r.height/2+r.y,h=Math.min(r.width,r.height)/2,c=s.count();if(s.setLayout({cx:d,cy:u}),c){if(a){var g=i.pointToData(n),p=g[0],f=g[1],y=[p-d,f-u];o(y,y),de(y,y,h),a.setLayout([d+y[0],u+y[1]],!0),na(a,e.get(["circular","rotateLabel"]),d,u)}oa[t](e,l,s,h,d,u,c),l.eachEdge((function(t,a){var o,n=se(t.getModel().get(["lineStyle","curveness"]),Ut(t,e,a),0),i=le(t.node1.getLayout()),r=le(t.node2.getLayout()),s=(i[0]+r[0])/2,l=(i[1]+r[1])/2;+n&&(o=[d*(n*=3)+s*(1-n),u*n+l*(1-n)]),t.setLayout([i,r,o])}))}}}var oa={value:function(e,t,a,o,n,i,r){var s=0,l=a.getSum("value"),d=2*Math.PI/(l||r);t.eachNode((function(e){var t=e.getValue("value"),a=d*(l?t:1)/2;s+=a,e.setLayout([o*Math.cos(s)+n,o*Math.sin(s)+i]),s+=a}))},symbolSize:function(e,t,a,o,n,i,r){var s=0;ta.length=r;var l=Qt(e);t.eachNode((function(e){var t=$t(e);isNaN(t)&&(t=2),t<0&&(t=0),t*=l;var a=Math.asin(t/2/o);isNaN(a)&&(a=ea/2),ta[e.dataIndex]=a,s+=2*a}));var d=(2*ea-s)/r/2,u=0;t.eachNode((function(e){var t=d+ta[e.dataIndex];u+=t,(!e.getLayout()||!e.getLayout().fixed)&&e.setLayout([o*Math.cos(u)+n,o*Math.sin(u)+i]),u+=t}))}};function na(e,t,a,o){var n=e.getGraphicEl();if(n){var i=e.getModel().get(["label","rotate"])||0,r=n.getSymbolPath();if(t){var s=e.getLayout(),l=Math.atan2(s[1]-o,s[0]-a);l<0&&(l=2*Math.PI+l);var d=s[0]<a;d&&(l-=Math.PI);var u=d?"left":"right";r.setTextConfig({rotation:-l,position:u,origin:"center"});var h=r.ensureState("emphasis");oe(h.textConfig||(h.textConfig={}),{position:u})}else r.setTextConfig({rotation:i*=Math.PI/180})}}function ia(e){e.eachSeriesByType("graph",(function(e){"circular"===e.get("layout")&&aa(e,"symbolSize")}))}var ra=pe;function sa(e){e.eachSeriesByType("graph",(function(e){var t=e.coordinateSystem;if(!t||"view"===t.type)if("force"===e.get("layout")){var a=e.preservedPoints||{},n=e.getGraph(),i=n.data,r=n.edgeData,s=e.getModel("force"),l=s.get("initLayout");e.preservedPoints?i.each((function(e){var t=i.getId(e);i.setItemLayout(e,a[t]||[NaN,NaN])})):l&&"none"!==l?"circular"===l&&aa(e,"value"):qt(e);var d=i.getDataExtent("value"),u=r.getDataExtent("value"),h=s.get("repulsion"),g=s.get("edgeLength"),p=c(h)?h:[h,h],f=c(g)?g:[g,g];f=[f[1],f[0]];var v=i.mapArray("value",(function(e,t){var a=i.getItemLayout(t),o=k(e,d,p);return isNaN(o)&&(o=(p[0]+p[1])/2),{w:o,rep:o,fixed:i.getItemModel(t).get("fixed"),p:!a||isNaN(a[0])||isNaN(a[1])?null:a}})),m=r.mapArray("value",(function(t,a){var o=n.getEdgeByIndex(a),i=k(t,u,f);isNaN(i)&&(i=(f[0]+f[1])/2);var r=o.getModel(),s=se(o.getModel().get(["lineStyle","curveness"]),-Ut(o,e,a,!0),0);return{n1:v[o.node1.dataIndex],n2:v[o.node2.dataIndex],d:i,curveness:s,ignoreForceLayout:r.get("ignoreForceLayout")}})),x=t.getBoundingRect(),_=function(e,t,a){for(var n=e,i=t,r=a.rect,s=r.width,l=r.height,d=[r.x+s/2,r.y+l/2],u=null==a.gravity?.1:a.gravity,h=0;h<n.length;h++){var c=n[h];c.p||(c.p=ue(s*(Math.random()-.5)+d[0],l*(Math.random()-.5)+d[1])),c.pp=le(c.p),c.edges=null}var g,p,f=null==a.friction?.6:a.friction,v=f;return{warmUp:function(){v=.8*f},setFixed:function(e){n[e].fixed=!0},setUnfixed:function(e){n[e].fixed=!1},beforeStep:function(e){g=e},afterStep:function(e){p=e},step:function(e){g&&g(n,i);for(var t=[],a=n.length,r=0;r<i.length;r++){var s=i[r];if(!s.ignoreForceLayout){var l=s.n1,h=s.n2;y(t,h.p,l.p);var c=he(t)-s.d,f=h.w/(l.w+h.w);isNaN(f)&&(f=0),o(t,t),!l.fixed&&ra(l.p,l.p,t,f*c*v),!h.fixed&&ra(h.p,h.p,t,-(1-f)*c*v)}}for(r=0;r<a;r++)(S=n[r]).fixed||(y(t,d,S.p),ra(S.p,S.p,t,u*v));for(r=0;r<a;r++){l=n[r];for(var m=r+1;m<a;m++){h=n[m],y(t,h.p,l.p),0===(c=he(t))&&(ce(t,Math.random()-.5,Math.random()-.5),c=1);var x=(l.rep+h.rep)/c/c;!l.fixed&&ra(l.pp,l.pp,t,x),!h.fixed&&ra(h.pp,h.pp,t,-x)}}var _=[];for(r=0;r<a;r++){var S;(S=n[r]).fixed||(y(_,S.p,S.pp),ra(S.p,S.p,_,v),ge(S.pp,S.p))}var b=(v*=.992)<.01;p&&p(n,i,b),e&&e(b)}}}(v,m,{rect:x,gravity:s.get("gravity"),friction:s.get("friction")});_.beforeStep((function(e,t){for(var a=0,o=e.length;a<o;a++)e[a].fixed&&ge(e[a].p,n.getNodeByIndex(a).getLayout())})),_.afterStep((function(e,t,o){for(var r=0,s=e.length;r<s;r++)e[r].fixed||n.getNodeByIndex(r).setLayout(e[r].p),a[i.getId(r)]=e[r].p;for(r=0,s=t.length;r<s;r++){var l=t[r],d=n.getEdgeByIndex(r),u=l.n1.p,h=l.n2.p,c=d.getLayout();(c=c?c.slice():[])[0]=c[0]||[],c[1]=c[1]||[],ge(c[0],u),ge(c[1],h),+l.curveness&&(c[2]=[(u[0]+h[0])/2-(u[1]-h[1])*l.curveness,(u[1]+h[1])/2-(h[0]-u[0])*l.curveness]),d.setLayout(c)}})),e.forceLayout=_,e.preservedPoints=a,_.step()}else e.forceLayout=null}))}function la(e,t){var a=[];return e.eachSeriesByType("graph",(function(e){var o=e.get("coordinateSystem");if(!o||"view"===o){var n=e.getData(),i=n.mapArray((function(e){var t=n.getItemModel(e);return[+t.get("x"),+t.get("y")]})),r=[],s=[];fe(i,r,s),s[0]-r[0]==0&&(s[0]+=1,r[0]-=1),s[1]-r[1]==0&&(s[1]+=1,r[1]-=1);var l=(s[0]-r[0])/(s[1]-r[1]),d=function(e,t,a){var o=oe(e.getBoxLayoutParams(),{aspect:a});return z(o,{width:t.getWidth(),height:t.getHeight()})}(e,t,l);isNaN(l)&&(r=[d.x,d.y],s=[d.x+d.width,d.y+d.height]);var u=s[0]-r[0],h=s[1]-r[1],c=d.width,g=d.height,p=e.coordinateSystem=new Oe;p.zoomLimit=e.get("scaleLimit"),p.setBoundingRect(r[0],r[1],u,h),p.setViewRect(d.x,d.y,c,g),p.setCenter(e.get("center"),t),p.setZoom(e.get("zoom")),a.push(p)}})),a}var da=[],ua=[],ha=[],ca=ve,ga=me,pa=Math.abs;function fa(e,t,a){for(var o,n=e[0],i=e[1],r=e[2],s=1/0,l=a*a,d=.1,u=.1;u<=.9;u+=.1){da[0]=ca(n[0],i[0],r[0],u),da[1]=ca(n[1],i[1],r[1],u),(g=pa(ga(da,t)-l))<s&&(s=g,o=u)}for(var h=0;h<32;h++){var c=o+d;ua[0]=ca(n[0],i[0],r[0],o),ua[1]=ca(n[1],i[1],r[1],o),ha[0]=ca(n[0],i[0],r[0],c),ha[1]=ca(n[1],i[1],r[1],c);var g=ga(ua,t)-l;if(pa(g)<.01)break;var p=ga(ha,t)-l;d/=2,g<0?p>=0?o+=d:o-=d:p>=0?o-=d:o+=d}return o}function ya(e,t){var a=[],n=ye,i=[[],[],[]],r=[[],[]],s=[];t/=2,e.eachEdge((function(e,l){var d=e.getLayout(),u=e.getVisual("fromSymbol"),h=e.getVisual("toSymbol");d.__original||(d.__original=[le(d[0]),le(d[1])],d[2]&&d.__original.push(le(d[2])));var c=d.__original;if(null!=d[2]){if(ge(i[0],c[0]),ge(i[1],c[2]),ge(i[2],c[1]),u&&"none"!==u){var g=$t(e.node1),p=fa(i,c[0],g*t);n(i[0][0],i[1][0],i[2][0],p,a),i[0][0]=a[3],i[1][0]=a[4],n(i[0][1],i[1][1],i[2][1],p,a),i[0][1]=a[3],i[1][1]=a[4]}if(h&&"none"!==h){g=$t(e.node2),p=fa(i,c[1],g*t);n(i[0][0],i[1][0],i[2][0],p,a),i[1][0]=a[1],i[2][0]=a[2],n(i[0][1],i[1][1],i[2][1],p,a),i[1][1]=a[1],i[2][1]=a[2]}ge(d[0],i[0]),ge(d[1],i[2]),ge(d[2],i[1])}else{if(ge(r[0],c[0]),ge(r[1],c[1]),y(s,r[1],r[0]),o(s,s),u&&"none"!==u){g=$t(e.node1);pe(r[0],r[0],s,g*t)}if(h&&"none"!==h){g=$t(e.node2);pe(r[1],r[1],s,-g*t)}ge(d[0],r[0]),ge(d[1],r[1])}}))}function va(e){return"view"===e.type}var ma=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return a(t,e),t.prototype.init=function(e,t){var a=new xe,o=new nt,n=this.group;this._controller=new Ge(t.getZr()),this._controllerHost={target:n},n.add(a.group),n.add(o.group),this._symbolDraw=a,this._lineDraw=o,this._firstRender=!0},t.prototype.render=function(e,t,a){var o=this,n=e.coordinateSystem;this._model=e;var i=this._symbolDraw,r=this._lineDraw,l=this.group;if(va(n)){var d={x:n.x,y:n.y,scaleX:n.scaleX,scaleY:n.scaleY};this._firstRender?l.attr(d):s(l,d,e)}ya(e.getGraph(),Qt(e));var u=e.getData();i.updateData(u);var h=e.getEdgeData();r.updateData(h),this._updateNodeAndLinkScale(),this._updateController(e,t,a),clearTimeout(this._layoutTimeout);var c=e.forceLayout,g=e.get(["force","layoutAnimation"]);c&&this._startForceLayoutIteration(c,g);var p=e.get("layout");u.graph.eachNode((function(t){var a=t.dataIndex,n=t.getGraphicEl(),i=t.getModel();if(n){n.off("drag").off("dragend");var r=i.get("draggable");r&&n.on("drag",(function(i){switch(p){case"force":c.warmUp(),!o._layouting&&o._startForceLayoutIteration(c,g),c.setFixed(a),u.setItemLayout(a,[n.x,n.y]);break;case"circular":u.setItemLayout(a,[n.x,n.y]),t.setLayout({fixed:!0},!0),aa(e,"symbolSize",t,[i.offsetX,i.offsetY]),o.updateLayout(e);break;default:u.setItemLayout(a,[n.x,n.y]),Kt(e.getGraph(),e),o.updateLayout(e)}})).on("dragend",(function(){c&&c.setUnfixed(a)})),n.setDraggable(r,!!i.get("cursor")),"adjacency"===i.get(["emphasis","focus"])&&(_e(n).focus=t.getAdjacentDataIndices())}})),u.graph.eachEdge((function(e){var t=e.getGraphicEl(),a=e.getModel().get(["emphasis","focus"]);t&&"adjacency"===a&&(_e(t).focus={edge:[e.dataIndex],node:[e.node1.dataIndex,e.node2.dataIndex]})}));var f="circular"===e.get("layout")&&e.get(["circular","rotateLabel"]),y=u.getLayout("cx"),v=u.getLayout("cy");u.graph.eachNode((function(e){na(e,f,y,v)})),this._firstRender=!1},t.prototype.dispose=function(){this.remove(),this._controller&&this._controller.dispose(),this._controllerHost=null},t.prototype._startForceLayoutIteration=function(e,t){var a=this;!function o(){e.step((function(e){a.updateLayout(a._model),(a._layouting=!e)&&(t?a._layoutTimeout=setTimeout(o,16):o())}))}()},t.prototype._updateController=function(e,t,a){var o=this,n=this._controller,i=this._controllerHost,r=this.group;n.setPointerChecker((function(t,o,n){var i=r.getBoundingRect();return i.applyTransform(r.transform),i.contain(o,n)&&!Se(t,a,e)})),va(e.coordinateSystem)?(n.enable(e.get("roam")),i.zoomLimit=e.get("scaleLimit"),i.zoom=e.coordinateSystem.getZoom(),n.off("pan").off("zoom").on("pan",(function(t){je(i,t.dx,t.dy),a.dispatchAction({seriesId:e.id,type:"graphRoam",dx:t.dx,dy:t.dy})})).on("zoom",(function(t){He(i,t.scale,t.originX,t.originY),a.dispatchAction({seriesId:e.id,type:"graphRoam",zoom:t.scale,originX:t.originX,originY:t.originY}),o._updateNodeAndLinkScale(),ya(e.getGraph(),Qt(e)),o._lineDraw.updateLayout(),a.updateLabelLayout()}))):n.disable()},t.prototype._updateNodeAndLinkScale=function(){var e=this._model,t=e.getData(),a=Qt(e);t.eachItemGraphicEl((function(e,t){e&&e.setSymbolScale(a)}))},t.prototype.updateLayout=function(e){ya(e.getGraph(),Qt(e)),this._symbolDraw.updateLayout(),this._lineDraw.updateLayout()},t.prototype.remove=function(){clearTimeout(this._layoutTimeout),this._layouting=!1,this._layoutTimeout=null,this._symbolDraw&&this._symbolDraw.remove(),this._lineDraw&&this._lineDraw.remove()},t.type="graph",t}(be);function xa(e){return"_EC_"+e}var _a=function(){function e(e){this.type="graph",this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this._directed=e||!1}return e.prototype.isDirected=function(){return this._directed},e.prototype.addNode=function(e,t){e=null==e?""+t:""+e;var a=this._nodesMap;if(!a[xa(e)]){var o=new Sa(e,t);return o.hostGraph=this,this.nodes.push(o),a[xa(e)]=o,o}},e.prototype.getNodeByIndex=function(e){var t=this.data.getRawIndex(e);return this.nodes[t]},e.prototype.getNodeById=function(e){return this._nodesMap[xa(e)]},e.prototype.addEdge=function(e,t,a){var o=this._nodesMap,n=this._edgesMap;if(re(e)&&(e=this.nodes[e]),re(t)&&(t=this.nodes[t]),e instanceof Sa||(e=o[xa(e)]),t instanceof Sa||(t=o[xa(t)]),e&&t){var i=e.id+"-"+t.id,r=new ba(e,t,a);return r.hostGraph=this,this._directed&&(e.outEdges.push(r),t.inEdges.push(r)),e.edges.push(r),e!==t&&t.edges.push(r),this.edges.push(r),n[i]=r,r}},e.prototype.getEdgeByIndex=function(e){var t=this.edgeData.getRawIndex(e);return this.edges[t]},e.prototype.getEdge=function(e,t){e instanceof Sa&&(e=e.id),t instanceof Sa&&(t=t.id);var a=this._edgesMap;return this._directed?a[e+"-"+t]:a[e+"-"+t]||a[t+"-"+e]},e.prototype.eachNode=function(e,t){for(var a=this.nodes,o=a.length,n=0;n<o;n++)a[n].dataIndex>=0&&e.call(t,a[n],n)},e.prototype.eachEdge=function(e,t){for(var a=this.edges,o=a.length,n=0;n<o;n++)a[n].dataIndex>=0&&a[n].node1.dataIndex>=0&&a[n].node2.dataIndex>=0&&e.call(t,a[n],n)},e.prototype.breadthFirstTraverse=function(e,t,a,o){if(t instanceof Sa||(t=this._nodesMap[xa(t)]),t){for(var n="out"===a?"outEdges":"in"===a?"inEdges":"edges",i=0;i<this.nodes.length;i++)this.nodes[i].__visited=!1;if(!e.call(o,t,null))for(var r=[t];r.length;){var s=r.shift(),l=s[n];for(i=0;i<l.length;i++){var d=l[i],u=d.node1===s?d.node2:d.node1;if(!u.__visited){if(e.call(o,u,s))return;r.push(u),u.__visited=!0}}}}},e.prototype.update=function(){for(var e=this.data,t=this.edgeData,a=this.nodes,o=this.edges,n=0,i=a.length;n<i;n++)a[n].dataIndex=-1;for(n=0,i=e.count();n<i;n++)a[e.getRawIndex(n)].dataIndex=n;t.filterSelf((function(e){var a=o[t.getRawIndex(e)];return a.node1.dataIndex>=0&&a.node2.dataIndex>=0}));for(n=0,i=o.length;n<i;n++)o[n].dataIndex=-1;for(n=0,i=t.count();n<i;n++)o[t.getRawIndex(n)].dataIndex=n},e.prototype.clone=function(){for(var t=new e(this._directed),a=this.nodes,o=this.edges,n=0;n<a.length;n++)t.addNode(a[n].id,a[n].dataIndex);for(n=0;n<o.length;n++){var i=o[n];t.addEdge(i.node1.id,i.node2.id,i.dataIndex)}return t},e}(),Sa=function(){function e(e,t){this.inEdges=[],this.outEdges=[],this.edges=[],this.dataIndex=-1,this.id=null==e?"":e,this.dataIndex=null==t?-1:t}return e.prototype.degree=function(){return this.edges.length},e.prototype.inDegree=function(){return this.inEdges.length},e.prototype.outDegree=function(){return this.outEdges.length},e.prototype.getModel=function(e){if(!(this.dataIndex<0))return this.hostGraph.data.getItemModel(this.dataIndex).getModel(e)},e.prototype.getAdjacentDataIndices=function(){for(var e={edge:[],node:[]},t=0;t<this.edges.length;t++){var a=this.edges[t];a.dataIndex<0||(e.edge.push(a.dataIndex),e.node.push(a.node1.dataIndex,a.node2.dataIndex))}return e},e.prototype.getTrajectoryDataIndices=function(){for(var e=L(),t=L(),a=0;a<this.edges.length;a++){var o=this.edges[a];if(!(o.dataIndex<0)){e.set(o.dataIndex,!0);for(var n=[o.node1],i=[o.node2],r=0;r<n.length;){var s=n[r];r++,t.set(s.dataIndex,!0);for(var l=0;l<s.inEdges.length;l++)e.set(s.inEdges[l].dataIndex,!0),n.push(s.inEdges[l].node1)}for(r=0;r<i.length;){var d=i[r];r++,t.set(d.dataIndex,!0);for(l=0;l<d.outEdges.length;l++)e.set(d.outEdges[l].dataIndex,!0),i.push(d.outEdges[l].node2)}}}return{edge:e.keys(),node:t.keys()}},e}(),ba=function(){function e(e,t,a){this.dataIndex=-1,this.node1=e,this.node2=t,this.dataIndex=null==a?-1:a}return e.prototype.getModel=function(e){if(!(this.dataIndex<0))return this.hostGraph.edgeData.getItemModel(this.dataIndex).getModel(e)},e.prototype.getAdjacentDataIndices=function(){return{edge:[this.dataIndex],node:[this.node1.dataIndex,this.node2.dataIndex]}},e.prototype.getTrajectoryDataIndices=function(){var e=L(),t=L();e.set(this.dataIndex,!0);for(var a=[this.node1],o=[this.node2],n=0;n<a.length;){var i=a[n];n++,t.set(i.dataIndex,!0);for(var r=0;r<i.inEdges.length;r++)e.set(i.inEdges[r].dataIndex,!0),a.push(i.inEdges[r].node1)}for(n=0;n<o.length;){var s=o[n];n++,t.set(s.dataIndex,!0);for(r=0;r<s.outEdges.length;r++)e.set(s.outEdges[r].dataIndex,!0),o.push(s.outEdges[r].node2)}return{edge:e.keys(),node:t.keys()}},e}();function Ia(e,t){return{getValue:function(a){var o=this[e][t];return o.getStore().get(o.getDimensionIndex(a||"value"),this.dataIndex)},setVisual:function(a,o){this.dataIndex>=0&&this[e][t].setItemVisual(this.dataIndex,a,o)},getVisual:function(a){return this[e][t].getItemVisual(this.dataIndex,a)},setLayout:function(a,o){this.dataIndex>=0&&this[e][t].setItemLayout(this.dataIndex,a,o)},getLayout:function(){return this[e][t].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[e][t].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[e][t].getRawIndex(this.dataIndex)}}}function La(e,t,a,o,n){for(var i=new _a(o),r=0;r<e.length;r++)i.addNode(Le(e[r].id,e[r].name,r),r);var s=[],l=[],d=0;for(r=0;r<t.length;r++){var u=t[r],h=u.source,c=u.target;i.addEdge(h,c,d)&&(l.push(u),s.push(Le(we(u.id,null),h+" > "+c)),d++)}var g,p=a.get("coordinateSystem");if("cartesian2d"===p||"polar"===p)g=Me(e,a);else{var f=De.get(p),y=f&&f.dimensions||[];P(y,"value")<0&&y.concat(["value"]);var v=Ee(e,{coordDimensions:y,encodeDefine:a.getEncode()}).dimensions;(g=new Ae(v,a)).initData(e)}var m=new Ae(["value"],a);return m.initData(l,s),n&&n(g,m),Nt({mainData:g,struct:i,structAttr:"graph",datas:{node:g,edge:m},datasAttr:{node:"data",edge:"edgeData"}}),i.update(),i}Ie(Sa,Ia("hostGraph","data")),Ie(ba,Ia("hostGraph","edgeData"));var wa=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.hasSymbolVisual=!0,a}return a(t,e),t.prototype.init=function(t){e.prototype.init.apply(this,arguments);var a=this;function o(){return a._categoriesData}this.legendVisualProvider=new Xe(o,o),this.fillDataTextStyle(t.edges||t.links),this._updateCategoriesData()},t.prototype.mergeOption=function(t){e.prototype.mergeOption.apply(this,arguments),this.fillDataTextStyle(t.edges||t.links),this._updateCategoriesData()},t.prototype.mergeDefaultAndTheme=function(t){e.prototype.mergeDefaultAndTheme.apply(this,arguments),Ne(t,"edgeLabel",["show"])},t.prototype.getInitialData=function(e,t){var a=e.edges||e.links||[],o=e.data||e.nodes||[],n=this;Ht(i=this)&&(i.__curvenessList=[],i.__edgeMap={},Ft(i));var i,s=La(o,a,this,!0,(function(e,t){e.wrapMethod("getItemModel",(function(e){var t=n._categoriesModels[e.getShallow("category")];return t&&(t.parentModel=e.parentModel,e.parentModel=t),e}));var a=Ve.prototype.getModel;function o(e,t){var o=a.call(this,e,t);return o.resolveParentPath=i,o}function i(e){if(e&&("label"===e[0]||"label"===e[1])){var t=e.slice();return"label"===e[0]?t[0]="edgeLabel":"label"===e[1]&&(t[1]="edgeLabel"),t}return e}t.wrapMethod("getItemModel",(function(e){return e.resolveParentPath=i,e.getModel=o,e}))}));return r(s.edges,(function(e){!function(e,t,a,o){if(Ht(a)){var n=Yt(e,t,a),i=a.__edgeMap,r=i[Xt(n)];i[n]&&!r?i[n].isForward=!0:r&&i[n]&&(r.isForward=!0,i[n].isForward=!1),i[n]=i[n]||[],i[n].push(o)}}(e.node1,e.node2,this,e.dataIndex)}),this),s.data},t.prototype.getGraph=function(){return this.getData().graph},t.prototype.getEdgeData=function(){return this.getGraph().edgeData},t.prototype.getCategoriesData=function(){return this._categoriesData},t.prototype.formatTooltip=function(e,t,a){if("edge"===a){var o=this.getData(),n=this.getDataParams(e,a),i=o.graph.getEdgeByIndex(e),r=o.getName(i.node1.dataIndex),s=o.getName(i.node2.dataIndex),l=[];return null!=r&&l.push(r),null!=s&&l.push(s),Te("nameValue",{name:l.join(" > "),value:n.value,noValue:null==n.value})}return Ce({series:this,dataIndex:e,multipleSeries:t})},t.prototype._updateCategoriesData=function(){var e=ne(this.option.categories||[],(function(e){return null!=e.value?e:oe({value:0},e)})),t=new Ae(["value"],this);t.initData(e),this._categoriesData=t,this._categoriesModels=t.mapArray((function(e){return t.getItemModel(e)}))},t.prototype.setZoom=function(e){this.option.zoom=e},t.prototype.setCenter=function(e){this.option.center=e},t.prototype.isAnimationEnabled=function(){return e.prototype.isAnimationEnabled.call(this)&&!("force"===this.get("layout")&&this.get(["force","layoutAnimation"]))},t.type="series.graph",t.dependencies=["grid","polar","geo","singleAxis","calendar"],t.defaultOption={z:2,coordinateSystem:"view",legendHoverLink:!0,layout:null,circular:{rotateLabel:!1},force:{initLayout:null,repulsion:[0,50],gravity:.1,friction:.6,edgeLength:30,layoutAnimation:!0},left:"center",top:"center",symbol:"circle",symbolSize:10,edgeSymbol:["none","none"],edgeSymbolSize:10,edgeLabel:{position:"middle",distance:5},draggable:!1,roam:!1,center:null,zoom:1,nodeScaleRatio:.6,label:{show:!1,formatter:"{b}"},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{scale:!0,label:{show:!0}},select:{itemStyle:{borderColor:"#212121"}}},t}(Re),Ma={type:"graphRoam",event:"graphRoam",update:"none"};function Da(e){e.registerChartView(ma),e.registerSeriesModel(wa),e.registerProcessor(Bt),e.registerVisual(Zt),e.registerVisual(Ot),e.registerLayout(Jt),e.registerLayout(e.PRIORITY.VISUAL.POST_CHART_LAYOUT,ia),e.registerLayout(sa),e.registerCoordinateSystem("graphView",{dimensions:Oe.dimensions,create:la}),e.registerAction({type:"focusNodeAdjacency",event:"focusNodeAdjacency",update:"series:focusNodeAdjacency"},ze),e.registerAction({type:"unfocusNodeAdjacency",event:"unfocusNodeAdjacency",update:"series:unfocusNodeAdjacency"},ze),e.registerAction(Ma,(function(e,t,a){t.eachComponent({mainType:"series",query:e},(function(t){var o=t.coordinateSystem,n=Fe(o,e,void 0,a);t.setCenter&&t.setCenter(n.center),t.setZoom&&t.setZoom(n.zoom)}))}))}var Ea=function(){return function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.cpx2=0,this.cpy2=0,this.extent=0}}(),Aa=function(e){function t(t){return e.call(this,t)||this}return a(t,e),t.prototype.getDefaultShape=function(){return new Ea},t.prototype.buildPath=function(e,t){var a=t.extent;e.moveTo(t.x1,t.y1),e.bezierCurveTo(t.cpx1,t.cpy1,t.cpx2,t.cpy2,t.x2,t.y2),"vertical"===t.orient?(e.lineTo(t.x2+a,t.y2),e.bezierCurveTo(t.cpx2+a,t.cpy2,t.cpx1+a,t.cpy1,t.x1+a,t.y1)):(e.lineTo(t.x2,t.y2+a),e.bezierCurveTo(t.cpx2,t.cpy2+a,t.cpx1,t.cpy1+a,t.x1,t.y1+a)),e.closePath()},t.prototype.highlight=function(){p(this)},t.prototype.downplay=function(){f(this)},t}(n),Na=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a._focusAdjacencyDisabled=!1,a}return a(t,e),t.prototype.render=function(e,t,a){var o=this,n=e.getGraph(),r=this.group,s=e.layoutInfo,d=s.width,h=s.height,c=e.getData(),p=e.getData("edge"),f=e.get("orient");this._model=e,r.removeAll(),r.x=s.x,r.y=s.y,n.eachEdge((function(t){var a=new Aa,o=_e(a);o.dataIndex=t.dataIndex,o.seriesIndex=e.seriesIndex,o.dataType="edge";var n,i,s,c,y,v,m,x,_=t.getModel(),S=_.getModel("lineStyle"),b=S.get("curveness"),I=t.node1.getLayout(),L=t.node1.getModel(),w=L.get("localX"),M=L.get("localY"),D=t.node2.getLayout(),E=t.node2.getModel(),A=E.get("localX"),N=E.get("localY"),V=t.getLayout();a.shape.extent=Math.max(1,V.dy),a.shape.orient=f,"vertical"===f?(n=(null!=w?w*d:I.x)+V.sy,i=(null!=M?M*h:I.y)+I.dy,s=(null!=A?A*d:D.x)+V.ty,y=n,v=i*(1-b)+(c=null!=N?N*h:D.y)*b,m=s,x=i*b+c*(1-b)):(n=(null!=w?w*d:I.x)+I.dx,i=(null!=M?M*h:I.y)+V.sy,y=n*(1-b)+(s=null!=A?A*d:D.x)*b,v=i,m=n*b+s*(1-b),x=c=(null!=N?N*h:D.y)+V.ty),a.setShape({x1:n,y1:i,x2:s,y2:c,cpx1:y,cpy1:v,cpx2:m,cpy2:x}),a.useStyle(S.getItemStyle()),Va(a.style,f,t);var T=""+_.get("value"),C=l(_,"edgeLabel");u(a,C,{labelFetcher:{getFormattedLabel:function(t,a,o,n,i,r){return e.getFormattedLabel(t,a,"edge",n,se(i,C.normal&&C.normal.get("formatter"),T),r)}},labelDataIndex:t.dataIndex,defaultText:T}),a.setTextConfig({position:"inside"});var R=_.getModel("emphasis");ke(a,_,"lineStyle",(function(e){var a=e.getItemStyle();return Va(a,f,t),a})),r.add(a),p.setItemGraphicEl(t.dataIndex,a);var z=R.get("focus");g(a,"adjacency"===z?t.getAdjacentDataIndices():"trajectory"===z?t.getTrajectoryDataIndices():z,R.get("blurScope"),R.get("disabled"))})),n.eachNode((function(t){var a=t.getLayout(),o=t.getModel(),n=o.get("localX"),i=o.get("localY"),s=o.getModel("emphasis"),p=o.get(["itemStyle","borderRadius"])||0,f=new F({shape:{x:null!=n?n*d:a.x,y:null!=i?i*h:a.y,width:a.dx,height:a.dy,r:p},style:o.getModel("itemStyle").getItemStyle(),z2:10});u(f,l(o),{labelFetcher:{getFormattedLabel:function(t,a){return e.getFormattedLabel(t,a,"node")}},labelDataIndex:t.dataIndex,defaultText:t.id}),f.disableLabelAnimation=!0,f.setStyle("fill",t.getVisual("color")),f.setStyle("decal",t.getVisual("style").decal),ke(f,o),r.add(f),c.setItemGraphicEl(t.dataIndex,f),_e(f).dataType="node";var y=s.get("focus");g(f,"adjacency"===y?t.getAdjacentDataIndices():"trajectory"===y?t.getTrajectoryDataIndices():y,s.get("blurScope"),s.get("disabled"))})),c.eachItemGraphicEl((function(t,n){c.getItemModel(n).get("draggable")&&(t.drift=function(t,i){o._focusAdjacencyDisabled=!0,this.shape.x+=t,this.shape.y+=i,this.dirty(),a.dispatchAction({type:"dragNode",seriesId:e.id,dataIndex:c.getRawIndex(n),localX:this.shape.x/d,localY:this.shape.y/h})},t.ondragend=function(){o._focusAdjacencyDisabled=!1},t.draggable=!0,t.cursor="move")})),!this._data&&e.isAnimationEnabled()&&r.setClipPath(function(e,t,a){var o=new F({shape:{x:e.x-10,y:e.y-10,width:0,height:e.height+20}});return i(o,{shape:{width:e.width+20}},t,a),o}(r.getBoundingRect(),e,(function(){r.removeClipPath()}))),this._data=e.getData()},t.prototype.dispose=function(){},t.type="sankey",t}(be);function Va(e,t,a){switch(e.fill){case"source":e.fill=a.node1.getVisual("color"),e.decal=a.node1.getVisual("style").decal;break;case"target":e.fill=a.node2.getVisual("color"),e.decal=a.node2.getVisual("style").decal;break;case"gradient":var o=a.node1.getVisual("color"),n=a.node2.getVisual("color");K(o)&&K(n)&&(e.fill=new Pe(0,0,+("horizontal"===t),+("vertical"===t),[{color:o,offset:0},{color:n,offset:1}]))}}var Ta=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return a(t,e),t.prototype.getInitialData=function(e,t){var a=e.edges||e.links||[],o=e.data||e.nodes||[],n=e.levels||[];this.levelModels=[];for(var i=this.levelModels,r=0;r<n.length;r++)null!=n[r].depth&&n[r].depth>=0&&(i[n[r].depth]=new Ve(n[r],this,t));return La(o,a,this,!0,(function(e,t){e.wrapMethod("getItemModel",(function(e,t){var a=e.parentModel,o=a.getData().getItemLayout(t);if(o){var n=o.depth,i=a.levelModels[n];i&&(e.parentModel=i)}return e})),t.wrapMethod("getItemModel",(function(e,t){var a=e.parentModel,o=a.getGraph().getEdgeByIndex(t).node1.getLayout();if(o){var n=o.depth,i=a.levelModels[n];i&&(e.parentModel=i)}return e}))})).data},t.prototype.setNodePosition=function(e,t){var a=(this.option.data||this.option.nodes)[e];a.localX=t[0],a.localY=t[1]},t.prototype.getGraph=function(){return this.getData().graph},t.prototype.getEdgeData=function(){return this.getGraph().edgeData},t.prototype.formatTooltip=function(e,t,a){function o(e){return isNaN(e)||null==e}if("edge"===a){var n=this.getDataParams(e,a),i=n.data,r=n.value,s=i.source+" -- "+i.target;return Te("nameValue",{name:s,value:r,noValue:o(r)})}var l=this.getGraph().getNodeByIndex(e).getLayout().value,d=this.getDataParams(e,a).data.name;return Te("nameValue",{name:null!=d?d+"":null,value:l,noValue:o(l)})},t.prototype.optionUpdated=function(){},t.prototype.getDataParams=function(t,a){var o=e.prototype.getDataParams.call(this,t,a);if(null==o.value&&"node"===a){var n=this.getGraph().getNodeByIndex(t).getLayout().value;o.value=n}return o},t.type="series.sankey",t.defaultOption={z:2,coordinateSystem:"view",left:"5%",top:"5%",right:"20%",bottom:"5%",orient:"horizontal",nodeWidth:20,nodeGap:8,draggable:!0,layoutIterations:32,label:{show:!0,position:"right",fontSize:12},edgeLabel:{show:!1,fontSize:12},levels:[],nodeAlign:"justify",lineStyle:{color:"#314656",opacity:.2,curveness:.5},emphasis:{label:{show:!0},lineStyle:{opacity:.5}},select:{itemStyle:{borderColor:"#212121"}},animationEasing:"linear",animationDuration:1e3},t}(Re);function Ca(e,t){e.eachSeriesByType("sankey",(function(e){var a=e.get("nodeWidth"),o=e.get("nodeGap"),n=function(e,t){return z(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}(e,t);e.layoutInfo=n;var i=n.width,s=n.height,l=e.getGraph(),d=l.nodes,u=l.edges;!function(e){r(e,(function(e){var t=Ha(e.outEdges,ja),a=Ha(e.inEdges,ja),o=e.getValue()||0,n=Math.max(t,a,o);e.setLayout({value:n},!0)}))}(d),function(e,t,a,o,n,i,s,l,d){(function(e,t,a,o,n,i,s){for(var l=[],d=[],u=[],h=[],c=0,g=0;g<t.length;g++)l[g]=1;for(g=0;g<e.length;g++)d[g]=e[g].inEdges.length,0===d[g]&&u.push(e[g]);var p=-1;for(;u.length;){for(var f=0;f<u.length;f++){var y=u[f],v=y.hostGraph.data.getRawDataItem(y.dataIndex),m=null!=v.depth&&v.depth>=0;m&&v.depth>p&&(p=v.depth),y.setLayout({depth:m?v.depth:c},!0),"vertical"===i?y.setLayout({dy:a},!0):y.setLayout({dx:a},!0);for(var x=0;x<y.outEdges.length;x++){var _=y.outEdges[x];l[t.indexOf(_)]=0;var S=_.node2;0==--d[e.indexOf(S)]&&h.indexOf(S)<0&&h.push(S)}}++c,u=h,h=[]}for(g=0;g<l.length;g++)if(1===l[g])throw new Error("Sankey is a DAG, the original data has cycle!");var b=p>c-1?p:c-1;s&&"left"!==s&&function(e,t,a,o){if("right"===t){for(var n=[],i=e,s=0;i.length;){for(var l=0;l<i.length;l++){var d=i[l];d.setLayout({skNodeHeight:s},!0);for(var u=0;u<d.inEdges.length;u++){var h=d.inEdges[u];n.indexOf(h.node1)<0&&n.push(h.node1)}}i=n,n=[],++s}r(e,(function(e){Ra(e)||e.setLayout({depth:Math.max(0,o-e.getLayout().skNodeHeight)},!0)}))}else"justify"===t&&function(e,t){r(e,(function(e){Ra(e)||e.outEdges.length||e.setLayout({depth:t},!0)}))}(e,o)}(e,s,0,b);var I="vertical"===i?(n-a)/b:(o-a)/b;!function(e,t,a){r(e,(function(e){var o=e.getLayout().depth*t;"vertical"===a?e.setLayout({y:o},!0):e.setLayout({x:o},!0)}))}(e,I,i)})(e,t,a,n,i,l,d),function(e,t,a,o,n,i,s){var l=function(e,t){var a=[],o="vertical"===t?"y":"x",n=Ze(e,(function(e){return e.getLayout()[o]}));return n.keys.sort((function(e,t){return e-t})),r(n.keys,(function(e){a.push(n.buckets.get(e))})),a}(e,s);(function(e,t,a,o,n,i){var s=1/0;r(e,(function(e){var t=e.length,l=0;r(e,(function(e){l+=e.getLayout().value}));var d="vertical"===i?(o-(t-1)*n)/l:(a-(t-1)*n)/l;d<s&&(s=d)})),r(e,(function(e){r(e,(function(e,t){var a=e.getLayout().value*s;"vertical"===i?(e.setLayout({x:t},!0),e.setLayout({dx:a},!0)):(e.setLayout({y:t},!0),e.setLayout({dy:a},!0))}))})),r(t,(function(e){var t=+e.getValue()*s;e.setLayout({dy:t},!0)}))})(l,t,a,o,n,s),za(l,n,a,o,s);for(var d=1;i>0;i--)ka(l,d*=.99,s),za(l,n,a,o,s),Fa(l,d,s),za(l,n,a,o,s)}(e,t,i,n,o,s,l),function(e,t){var a="vertical"===t?"x":"y";r(e,(function(e){e.outEdges.sort((function(e,t){return e.node2.getLayout()[a]-t.node2.getLayout()[a]})),e.inEdges.sort((function(e,t){return e.node1.getLayout()[a]-t.node1.getLayout()[a]}))})),r(e,(function(e){var t=0,a=0;r(e.outEdges,(function(e){e.setLayout({sy:t},!0),t+=e.getLayout().dy})),r(e.inEdges,(function(e){e.setLayout({ty:a},!0),a+=e.getLayout().dy}))}))}(e,l)}(d,u,a,o,i,s,0!==Be(d,(function(e){return 0===e.getLayout().value})).length?0:e.get("layoutIterations"),e.get("orient"),e.get("nodeAlign"))}))}function Ra(e){var t=e.hostGraph.data.getRawDataItem(e.dataIndex);return null!=t.depth&&t.depth>=0}function za(e,t,a,o,n){var i="vertical"===n?"x":"y";r(e,(function(e){var r,s,l;e.sort((function(e,t){return e.getLayout()[i]-t.getLayout()[i]}));for(var d=0,u=e.length,h="vertical"===n?"dx":"dy",c=0;c<u;c++)(l=d-(s=e[c]).getLayout()[i])>0&&(r=s.getLayout()[i]+l,"vertical"===n?s.setLayout({x:r},!0):s.setLayout({y:r},!0)),d=s.getLayout()[i]+s.getLayout()[h]+t;if((l=d-t-("vertical"===n?o:a))>0){r=s.getLayout()[i]-l,"vertical"===n?s.setLayout({x:r},!0):s.setLayout({y:r},!0),d=r;for(c=u-2;c>=0;--c)(l=(s=e[c]).getLayout()[i]+s.getLayout()[h]+t-d)>0&&(r=s.getLayout()[i]-l,"vertical"===n?s.setLayout({x:r},!0):s.setLayout({y:r},!0)),d=s.getLayout()[i]}}))}function ka(e,t,a){r(e.slice().reverse(),(function(e){r(e,(function(e){if(e.outEdges.length){var o=Ha(e.outEdges,Pa,a)/Ha(e.outEdges,ja);if(isNaN(o)){var n=e.outEdges.length;o=n?Ha(e.outEdges,Ba,a)/n:0}if("vertical"===a){var i=e.getLayout().x+(o-Oa(e,a))*t;e.setLayout({x:i},!0)}else{var r=e.getLayout().y+(o-Oa(e,a))*t;e.setLayout({y:r},!0)}}}))}))}function Pa(e,t){return Oa(e.node2,t)*e.getValue()}function Ba(e,t){return Oa(e.node2,t)}function Za(e,t){return Oa(e.node1,t)*e.getValue()}function Ga(e,t){return Oa(e.node1,t)}function Oa(e,t){return"vertical"===t?e.getLayout().x+e.getLayout().dx/2:e.getLayout().y+e.getLayout().dy/2}function ja(e){return e.getValue()}function Ha(e,t,a){for(var o=0,n=e.length,i=-1;++i<n;){var r=+t(e[i],a);isNaN(r)||(o+=r)}return o}function Fa(e,t,a){r(e,(function(e){r(e,(function(e){if(e.inEdges.length){var o=Ha(e.inEdges,Za,a)/Ha(e.inEdges,ja);if(isNaN(o)){var n=e.inEdges.length;o=n?Ha(e.inEdges,Ga,a)/n:0}if("vertical"===a){var i=e.getLayout().x+(o-Oa(e,a))*t;e.setLayout({x:i},!0)}else{var r=e.getLayout().y+(o-Oa(e,a))*t;e.setLayout({y:r},!0)}}}))}))}function Ya(e){e.eachSeriesByType("sankey",(function(e){var t=e.getGraph(),a=t.nodes,o=t.edges;if(a.length){var n=1/0,i=-1/0;r(a,(function(e){var t=e.getLayout().value;t<n&&(n=t),t>i&&(i=t)})),r(a,(function(t){var a=new Ye({type:"color",mappingMethod:"linear",dataExtent:[n,i],visual:e.get("color")}).mapValueToVisual(t.getLayout().value),o=t.getModel().get(["itemStyle","color"]);null!=o?(t.setVisual("color",o),t.setVisual("style",{fill:o})):(t.setVisual("color",a),t.setVisual("style",{fill:a}))}))}o.length&&r(o,(function(e){var t=e.getModel().get("lineStyle");e.setVisual("style",t)}))}))}function Xa(e){e.registerChartView(Na),e.registerSeriesModel(Ta),e.registerLayout(Ca),e.registerVisual(Ya),e.registerAction({type:"dragNode",event:"dragnode",update:"update"},(function(e,t){t.eachComponent({mainType:"series",subType:"sankey",query:e},(function(t){t.setNodePosition(e.dataIndex,[e.localX,e.localY])}))}))}export{nt as L,ot as a,Xa as b,Et as c,mt as d,Dt as e,Da as i,Nt as l};
