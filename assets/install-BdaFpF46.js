import{db as e,_ as t,D as i,ap as n,dc as o,dd as r,de as a,df as s,dg as l,dh as p,H as u,X as c,a3 as h,aA as d,U as g,at as f,az as v,cM as y,W as m,L as _,di as S,a6 as b,a5 as w,aQ as x,dj as M,bI as I,dk as D,N as T,dl as C,k as L,dm as A,t as R,o as O,ak as V,cS as F,aO as G,bS as z,s as N,q as P,aj as k,bi as E,a9 as H,a2 as B,y as U,ab as X,b5 as Y,aB as j,P as J,a4 as W,p as Z,w as K,dn as q,bQ as Q,aM as $,aD as ee,bZ as te,bU as ie,bV as ne,bT as oe,cA as re,be as ae,bf as se,Q as le,aK as pe,bh as ue,dp as ce,cG as he,dq as de,$ as ge,b$ as fe,dr as ve,I as ye,ds as me,dt as _e,z as Se,ag as be,af as we,ao as xe,c1 as Me,aV as Ie,du as De,aL as Te,Z as Ce,g as Le,aZ as Ae,b1 as Re,dv as Oe,dw as Ve,al as Fe,l as Ge,dx as ze,dy as Ne,dz as Pe,bb as ke,O as Ee,dA as He,dB as Be,u as Ue,cf as Xe,Y as Ye,bv as je,bu as Je,S as We,aE as Ze,ba as Ke,C as qe,dC as Qe,bD as $e,a1 as et,c9 as tt,aX as it,dD as nt,bC as ot,dE as rt,dF as at,b2 as st,b3 as lt,dG as pt}from"./vintage-W2u9YdUI.js";import{g as ut,f as ct}from"./install-09CvjRxq.js";function ht(e,t){return Math.abs(e-t)<1e-8}function dt(t,i,n){var o=0,r=t[0];if(!r)return!1;for(var a=1;a<t.length;a++){var s=t[a];o+=e(r[0],r[1],s[0],s[1],i,n),r=s}var l=t[0];return ht(r[0],l[0])&&ht(r[1],l[1])||(o+=e(r[0],r[1],l[0],l[1],i,n)),0!==o}var gt=[];function ft(e,t){for(var i=0;i<e.length;i++)s(e[i],e[i],t)}function vt(e,t,i,n){for(var o=0;o<e.length;o++){var r=e[o];n&&(r=n.project(r)),r&&isFinite(r[0])&&isFinite(r[1])&&(l(t,t,r),p(i,i,r))}}var yt,mt=function(){function e(e){this.name=e}return e.prototype.setCenter=function(e){this._center=e},e.prototype.getCenter=function(){var e=this._center;return e||(e=this._center=this.calcCenter()),e},e}(),_t=function(){return function(e,t){this.type="polygon",this.exterior=e,this.interiors=t}}(),St=function(){return function(e){this.type="linestring",this.points=e}}(),bt=function(e){function o(t,i,n){var o=e.call(this,t)||this;return o.type="geoJSON",o.geometries=i,o._center=n&&[n[0],n[1]],o}return t(o,e),o.prototype.calcCenter=function(){for(var e,t=this.geometries,i=0,n=0;n<t.length;n++){var o=t[n],r=o.exterior,a=r&&r.length;a>i&&(e=o,i=a)}if(e)return function(e){for(var t=0,i=0,n=0,o=e.length,r=e[o-1][0],a=e[o-1][1],s=0;s<o;s++){var l=e[s][0],p=e[s][1],u=r*p-l*a;t+=u,i+=(r+l)*u,n+=(a+p)*u,r=l,a=p}return t?[i/t/3,n/t/3,t]:[e[0][0]||0,e[0][1]||0]}(e.exterior);var s=this.getBoundingRect();return[s.x+s.width/2,s.y+s.height/2]},o.prototype.getBoundingRect=function(e){var t=this._rect;if(t&&!e)return t;var o=[1/0,1/0],r=[-1/0,-1/0],a=this.geometries;return i(a,(function(t){"polygon"===t.type?vt(t.exterior,o,r,e):i(t.points,(function(t){vt(t,o,r,e)}))})),isFinite(o[0])&&isFinite(o[1])&&isFinite(r[0])&&isFinite(r[1])||(o[0]=o[1]=r[0]=r[1]=0),t=new n(o[0],o[1],r[0]-o[0],r[1]-o[1]),e||(this._rect=t),t},o.prototype.contain=function(e){var t=this.getBoundingRect(),i=this.geometries;if(!t.contain(e[0],e[1]))return!1;e:for(var n=0,o=i.length;n<o;n++){var r=i[n];if("polygon"===r.type){var a=r.exterior,s=r.interiors;if(dt(a,e[0],e[1])){for(var l=0;l<(s?s.length:0);l++)if(dt(s[l],e[0],e[1]))continue e;return!0}}}return!1},o.prototype.transformTo=function(e,t,o,r){var a=this.getBoundingRect(),s=a.width/a.height;o?r||(r=o/s):o=s*r;for(var l=new n(e,t,o,r),p=a.calculateTransform(l),u=this.geometries,c=0;c<u.length;c++){var h=u[c];"polygon"===h.type?(ft(h.exterior,p),i(h.interiors,(function(e){ft(e,p)}))):i(h.points,(function(e){ft(e,p)}))}(a=this._rect).copy(l),this._center=[a.x+a.width/2,a.y+a.height/2]},o.prototype.cloneShallow=function(e){null==e&&(e=this.name);var t=new o(e,this.geometries,this._center);return t._rect=this._rect,t.transformTo=null,t},o}(mt),wt=function(e){function i(t,i){var n=e.call(this,t)||this;return n.type="geoSVG",n._elOnlyForCalculate=i,n}return t(i,e),i.prototype.calcCenter=function(){for(var e=this._elOnlyForCalculate,t=e.getBoundingRect(),i=[t.x+t.width/2,t.y+t.height/2],n=o(gt),l=e;l&&!l.isGeoSVGGraphicRoot;)r(n,l.getLocalTransform(),n),l=l.parent;return a(n,n),s(i,i,n),i},i}(mt);function xt(e,t,i){for(var n=0;n<e.length;n++)e[n]=Mt(e[n],t[n],i)}function Mt(e,t,i){for(var n=[],o=t[0],r=t[1],a=0;a<e.length;a+=2){var s=e.charCodeAt(a)-64,l=e.charCodeAt(a+1)-64;s=s>>1^-(1&s),l=l>>1^-(1&l),o=s+=o,r=l+=r,n.push([s/i,l/i])}return n}function It(e,t){return e=function(e){if(!e.UTF8Encoding)return e;var t=e,n=t.UTF8Scale;null==n&&(n=1024);var o=t.features;return i(o,(function(e){var t=e.geometry,o=t.encodeOffsets,r=t.coordinates;if(o)switch(t.type){case"LineString":t.coordinates=Mt(r,o,n);break;case"Polygon":case"MultiLineString":xt(r,o,n);break;case"MultiPolygon":i(r,(function(e,t){return xt(e,o[t],n)}))}})),t.UTF8Encoding=!1,t}(e),u(c(e.features,(function(e){return e.geometry&&e.properties&&e.geometry.coordinates.length>0})),(function(e){var n=e.properties,o=e.geometry,r=[];switch(o.type){case"Polygon":var a=o.coordinates;r.push(new _t(a[0],a.slice(1)));break;case"MultiPolygon":i(o.coordinates,(function(e){e[0]&&r.push(new _t(e[0],e.slice(1)))}));break;case"LineString":r.push(new St([o.coordinates]));break;case"MultiLineString":r.push(new St(o.coordinates))}var s=new bt(n[t||"name"],r,n.cp);return s.properties=n,s}))}function Dt(e){h(e)&&(e=(new DOMParser).parseFromString(e,"text/xml"));var t=e;for(9===t.nodeType&&(t=t.firstChild);"svg"!==t.nodeName.toLowerCase()||1!==t.nodeType;)t=t.nextSibling;return t}var Tt={fill:"fill",stroke:"stroke","stroke-width":"lineWidth",opacity:"opacity","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-miterlimit":"miterLimit","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","text-anchor":"textAlign",visibility:"visibility",display:"display"},Ct=d(Tt),Lt={"alignment-baseline":"textBaseline","stop-color":"stopColor"},At=d(Lt),Rt=function(){function e(){this._defs={},this._root=null}return e.prototype.parse=function(e,t){t=t||{};var i=Dt(e);this._defsUsePending=[];var n=new g;this._root=n;var o=[],r=i.getAttribute("viewBox")||"",a=parseFloat(i.getAttribute("width")||t.width),s=parseFloat(i.getAttribute("height")||t.height);isNaN(a)&&(a=null),isNaN(s)&&(s=null),Nt(i,n,null,!0,!1);for(var l,p,u=i.firstChild;u;)this._parseNode(u,n,o,null,!1,!1),u=u.nextSibling;if(function(e,t){for(var i=0;i<t.length;i++){var n=t[i];n[0].style[n[1]]=e[n[2]]}}(this._defs,this._defsUsePending),this._defsUsePending=[],r){var c=Ht(r);c.length>=4&&(l={x:parseFloat(c[0]||0),y:parseFloat(c[1]||0),width:parseFloat(c[2]),height:parseFloat(c[3])})}if(l&&null!=a&&null!=s&&(p=jt(l,{x:0,y:0,width:a,height:s}),!t.ignoreViewBox)){var h=n;(n=new g).add(h),h.scaleX=h.scaleY=p.scale,h.x=p.x,h.y=p.y}return t.ignoreRootClip||null==a||null==s||n.setClipPath(new f({shape:{x:0,y:0,width:a,height:s}})),{root:n,width:a,height:s,viewBoxRect:l,viewBoxTransform:p,named:o}},e.prototype._parseNode=function(e,t,i,n,o,r){var a,s=e.nodeName.toLowerCase(),l=n;if("defs"===s&&(o=!0),"text"===s&&(r=!0),"defs"===s||"switch"===s)a=t;else{if(!o){var p=yt[s];if(p&&v(yt,s)){a=p.call(this,e,t);var u=e.getAttribute("name");if(u){var c={name:u,namedFrom:null,svgNodeTagLower:s,el:a};i.push(c),"g"===s&&(l=c)}else n&&i.push({name:n.name,namedFrom:n,svgNodeTagLower:s,el:a});t.add(a)}}var h=Ot[s];if(h&&v(Ot,s)){var d=h.call(this,e),g=e.getAttribute("id");g&&(this._defs[g]=d)}}if(a&&a.isGroup)for(var f=e.firstChild;f;)1===f.nodeType?this._parseNode(f,a,i,l,o,r):3===f.nodeType&&r&&this._parseText(f,a),f=f.nextSibling},e.prototype._parseText=function(e,t){var i=new y({style:{text:e.textContent},silent:!0,x:this._textX||0,y:this._textY||0});Gt(t,i),Nt(e,i,this._defsUsePending,!1,!1),function(e,t){var i=t.__selfStyle;if(i){var n=i.textBaseline,o=n;n&&"auto"!==n?"baseline"===n?o="alphabetic":"before-edge"===n||"text-before-edge"===n?o="top":"after-edge"===n||"text-after-edge"===n?o="bottom":"central"!==n&&"mathematical"!==n||(o="middle"):o="alphabetic",e.style.textBaseline=o}var r=t.__inheritedStyle;if(r){var a=r.textAlign,s=a;a&&("middle"===a&&(s="center"),e.style.textAlign=s)}}(i,t);var n=i.style,o=n.fontSize;o&&o<9&&(n.fontSize=9,i.scaleX*=o/9,i.scaleY*=o/9);var r=(n.fontSize||n.fontFamily)&&[n.fontStyle,n.fontWeight,(n.fontSize||12)+"px",n.fontFamily||"sans-serif"].join(" ");n.font=r;var a=i.getBoundingRect();return this._textX+=a.width,t.add(i),i},e.internalField=void(yt={g:function(e,t){var i=new g;return Gt(t,i),Nt(e,i,this._defsUsePending,!1,!1),i},rect:function(e,t){var i=new f;return Gt(t,i),Nt(e,i,this._defsUsePending,!1,!1),i.setShape({x:parseFloat(e.getAttribute("x")||"0"),y:parseFloat(e.getAttribute("y")||"0"),width:parseFloat(e.getAttribute("width")||"0"),height:parseFloat(e.getAttribute("height")||"0")}),i.silent=!0,i},circle:function(e,t){var i=new m;return Gt(t,i),Nt(e,i,this._defsUsePending,!1,!1),i.setShape({cx:parseFloat(e.getAttribute("cx")||"0"),cy:parseFloat(e.getAttribute("cy")||"0"),r:parseFloat(e.getAttribute("r")||"0")}),i.silent=!0,i},line:function(e,t){var i=new _;return Gt(t,i),Nt(e,i,this._defsUsePending,!1,!1),i.setShape({x1:parseFloat(e.getAttribute("x1")||"0"),y1:parseFloat(e.getAttribute("y1")||"0"),x2:parseFloat(e.getAttribute("x2")||"0"),y2:parseFloat(e.getAttribute("y2")||"0")}),i.silent=!0,i},ellipse:function(e,t){var i=new S;return Gt(t,i),Nt(e,i,this._defsUsePending,!1,!1),i.setShape({cx:parseFloat(e.getAttribute("cx")||"0"),cy:parseFloat(e.getAttribute("cy")||"0"),rx:parseFloat(e.getAttribute("rx")||"0"),ry:parseFloat(e.getAttribute("ry")||"0")}),i.silent=!0,i},polygon:function(e,t){var i,n=e.getAttribute("points");n&&(i=zt(n));var o=new b({shape:{points:i||[]},silent:!0});return Gt(t,o),Nt(e,o,this._defsUsePending,!1,!1),o},polyline:function(e,t){var i,n=e.getAttribute("points");n&&(i=zt(n));var o=new w({shape:{points:i||[]},silent:!0});return Gt(t,o),Nt(e,o,this._defsUsePending,!1,!1),o},image:function(e,t){var i=new x;return Gt(t,i),Nt(e,i,this._defsUsePending,!1,!1),i.setStyle({image:e.getAttribute("xlink:href")||e.getAttribute("href"),x:+e.getAttribute("x"),y:+e.getAttribute("y"),width:+e.getAttribute("width"),height:+e.getAttribute("height")}),i.silent=!0,i},text:function(e,t){var i=e.getAttribute("x")||"0",n=e.getAttribute("y")||"0",o=e.getAttribute("dx")||"0",r=e.getAttribute("dy")||"0";this._textX=parseFloat(i)+parseFloat(o),this._textY=parseFloat(n)+parseFloat(r);var a=new g;return Gt(t,a),Nt(e,a,this._defsUsePending,!1,!0),a},tspan:function(e,t){var i=e.getAttribute("x"),n=e.getAttribute("y");null!=i&&(this._textX=parseFloat(i)),null!=n&&(this._textY=parseFloat(n));var o=e.getAttribute("dx")||"0",r=e.getAttribute("dy")||"0",a=new g;return Gt(t,a),Nt(e,a,this._defsUsePending,!1,!0),this._textX+=parseFloat(o),this._textY+=parseFloat(r),a},path:function(e,t){var i=e.getAttribute("d")||"",n=M(i);return Gt(t,n),Nt(e,n,this._defsUsePending,!1,!1),n.silent=!0,n}}),e}(),Ot={lineargradient:function(e){var t=parseInt(e.getAttribute("x1")||"0",10),i=parseInt(e.getAttribute("y1")||"0",10),n=parseInt(e.getAttribute("x2")||"10",10),o=parseInt(e.getAttribute("y2")||"0",10),r=new I(t,i,n,o);return Vt(e,r),Ft(e,r),r},radialgradient:function(e){var t=parseInt(e.getAttribute("cx")||"0",10),i=parseInt(e.getAttribute("cy")||"0",10),n=parseInt(e.getAttribute("r")||"0",10),o=new D(t,i,n);return Vt(e,o),Ft(e,o),o}};function Vt(e,t){"userSpaceOnUse"===e.getAttribute("gradientUnits")&&(t.global=!0)}function Ft(e,t){for(var i=e.firstChild;i;){if(1===i.nodeType&&"stop"===i.nodeName.toLocaleLowerCase()){var n=i.getAttribute("offset"),o=void 0;o=n&&n.indexOf("%")>0?parseInt(n,10)/100:n?parseFloat(n):0;var r={};Yt(i,r,r);var a=r.stopColor||i.getAttribute("stop-color")||"#000000";t.colorStops.push({offset:o,color:a})}i=i.nextSibling}}function Gt(e,t){e&&e.__inheritedStyle&&(t.__inheritedStyle||(t.__inheritedStyle={}),T(t.__inheritedStyle,e.__inheritedStyle))}function zt(e){for(var t=Ht(e),i=[],n=0;n<t.length;n+=2){var o=parseFloat(t[n]),r=parseFloat(t[n+1]);i.push([o,r])}return i}function Nt(e,t,n,o,a){var s=t,l=s.__inheritedStyle=s.__inheritedStyle||{},p={};1===e.nodeType&&(function(e,t){var i=e.getAttribute("transform");if(i){i=i.replace(/,/g," ");var n=[],o=null;i.replace(Bt,(function(e,t,i){return n.push(t,i),""}));for(var a=n.length-1;a>0;a-=2){var s=n[a],l=n[a-1],p=Ht(s);switch(o=o||O(),l){case"translate":R(o,o,[parseFloat(p[0]),parseFloat(p[1]||"0")]);break;case"scale":A(o,o,[parseFloat(p[0]),parseFloat(p[1]||p[0])]);break;case"rotate":L(o,o,-parseFloat(p[0])*Ut,[parseFloat(p[1]||"0"),parseFloat(p[2]||"0")]);break;case"skewX":var u=Math.tan(parseFloat(p[0])*Ut);r(o,[1,0,u,1,0,0],o);break;case"skewY":var c=Math.tan(parseFloat(p[0])*Ut);r(o,[1,c,0,1,0,0],o);break;case"matrix":o[0]=parseFloat(p[0]),o[1]=parseFloat(p[1]),o[2]=parseFloat(p[2]),o[3]=parseFloat(p[3]),o[4]=parseFloat(p[4]),o[5]=parseFloat(p[5])}}t.setLocalTransform(o)}}(e,t),Yt(e,l,p),o||function(e,t,i){for(var n=0;n<Ct.length;n++){var o=Ct[n];null!=(r=e.getAttribute(o))&&(t[Tt[o]]=r)}for(n=0;n<At.length;n++){var r;o=At[n];null!=(r=e.getAttribute(o))&&(i[Lt[o]]=r)}}(e,l,p)),s.style=s.style||{},null!=l.fill&&(s.style.fill=kt(s,"fill",l.fill,n)),null!=l.stroke&&(s.style.stroke=kt(s,"stroke",l.stroke,n)),i(["lineWidth","opacity","fillOpacity","strokeOpacity","miterLimit","fontSize"],(function(e){null!=l[e]&&(s.style[e]=parseFloat(l[e]))})),i(["lineDashOffset","lineCap","lineJoin","fontWeight","fontFamily","fontStyle","textAlign"],(function(e){null!=l[e]&&(s.style[e]=l[e])})),a&&(s.__selfStyle=p),l.lineDash&&(s.style.lineDash=u(Ht(l.lineDash),(function(e){return parseFloat(e)}))),"hidden"!==l.visibility&&"collapse"!==l.visibility||(s.invisible=!0),"none"===l.display&&(s.ignore=!0)}var Pt=/^url\(\s*#(.*?)\)/;function kt(e,t,i,n){var o=i&&i.match(Pt);if(!o)return"none"===i&&(i=null),i;var r=C(o[1]);n.push([e,t,r])}var Et=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function Ht(e){return e.match(Et)||[]}var Bt=/(translate|scale|rotate|skewX|skewY|matrix)\(([\-\s0-9\.eE,]*)\)/g,Ut=Math.PI/180;var Xt=/([^\s:;]+)\s*:\s*([^:;]+)/g;function Yt(e,t,i){var n,o=e.getAttribute("style");if(o)for(Xt.lastIndex=0;null!=(n=Xt.exec(o));){var r=n[1],a=v(Tt,r)?Tt[r]:null;a&&(t[a]=n[2]);var s=v(Lt,r)?Lt[r]:null;s&&(i[s]=n[2])}}function jt(e,t){var i=t.width/e.width,n=t.height/e.height,o=Math.min(i,n);return{scale:o,x:-(e.x+e.width/2)*o+(t.x+t.width/2),y:-(e.y+e.height/2)*o+(t.y+t.height/2)}}var Jt=V(["rect","circle","line","ellipse","polygon","polyline","path","text","tspan","g"]),Wt=function(){function e(e,t){this.type="geoSVG",this._usedGraphicMap=V(),this._freedGraphics=[],this._mapName=e,this._parsedXML=Dt(t)}return e.prototype.load=function(){var e=this._firstGraphic;if(!e){e=this._firstGraphic=this._buildGraphic(this._parsedXML),this._freedGraphics.push(e),this._boundingRect=this._firstGraphic.boundingRect.clone();var t=function(e){var t=[],n=V();return i(e,(function(e){if(null==e.namedFrom){var i=new wt(e.name,e.el);t.push(i),n.set(e.name,i)}})),{regions:t,regionsMap:n}}(e.named),n=t.regions,o=t.regionsMap;this._regions=n,this._regionsMap=o}return{boundingRect:this._boundingRect,regions:this._regions,regionsMap:this._regionsMap}},e.prototype._buildGraphic=function(e){var t,o,r,a;try{o=(t=e&&(r=e,a={ignoreViewBox:!0,ignoreRootClip:!0},(new Rt).parse(r,a))||{}).root,F(null!=o)}catch(b){throw new Error("Invalid svg format\n"+b.message)}var s=new g;s.add(o),s.isGeoSVGGraphicRoot=!0;var l=t.width,p=t.height,u=t.viewBoxRect,c=this._boundingRect;if(!c){var h=void 0,d=void 0,v=void 0,y=void 0;if(null!=l?(h=0,v=l):u&&(h=u.x,v=u.width),null!=p?(d=0,y=p):u&&(d=u.y,y=u.height),null==h||null==d){var m=o.getBoundingRect();null==h&&(h=m.x,v=m.width),null==d&&(d=m.y,y=m.height)}c=this._boundingRect=new n(h,d,v,y)}if(u){var _=jt(u,c);o.scaleX=o.scaleY=_.scale,o.x=_.x,o.y=_.y}s.setClipPath(new f({shape:c.plain()}));var S=[];return i(t.named,(function(e){var t;null!=Jt.get(e.svgNodeTagLower)&&(S.push(e),(t=e.el).silent=!1,t.isGroup&&t.traverse((function(e){e.silent=!1})))})),{root:s,boundingRect:c,named:S}},e.prototype.useGraphic=function(e){var t=this._usedGraphicMap,i=t.get(e);return i||(i=this._freedGraphics.pop()||this._buildGraphic(this._parsedXML),t.set(e,i),i)},e.prototype.freeGraphic=function(e){var t=this._usedGraphicMap,i=t.get(e);i&&(t.removeKey(e),this._freedGraphics.push(i))},e}();for(var Zt=[126,25],Kt="南海诸岛",qt=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]],Qt=0;Qt<qt.length;Qt++)for(var $t=0;$t<qt[Qt].length;$t++)qt[Qt][$t][0]/=10.5,qt[Qt][$t][1]/=-14,qt[Qt][$t][0]+=Zt[0],qt[Qt][$t][1]+=Zt[1];var ei={"南海诸岛":[32,80],"广东":[0,-10],"香港":[10,5],"澳门":[-10,10],"天津":[5,5]};var ti=[[[123.45165252685547,25.73527164402261],[123.49731445312499,25.73527164402261],[123.49731445312499,25.750734064600884],[123.45165252685547,25.750734064600884],[123.45165252685547,25.73527164402261]]];var ii=function(){function e(e,t,i){var n;this.type="geoJSON",this._parsedMap=V(),this._mapName=e,this._specialAreas=i,this._geoJSON=h(n=t)?"undefined"!=typeof JSON&&JSON.parse?JSON.parse(n):new Function("return ("+n+");")():n}return e.prototype.load=function(e,t){t=t||"name";var o=this._parsedMap.get(t);if(!o){var r=this._parseToRegions(t);o=this._parsedMap.set(t,{regions:r,boundingRect:ni(r)})}var a=V(),s=[];return i(o.regions,(function(t){var i=t.name;e&&v(e,i)&&(t=t.cloneShallow(i=e[i])),s.push(t),a.set(i,t)})),{regions:s,boundingRect:o.boundingRect||new n(0,0,0,0),regionsMap:a}},e.prototype._parseToRegions=function(e){var t,n=this._mapName,o=this._geoJSON;try{t=o?It(o,e):[]}catch(r){throw new Error("Invalid geoJson format\n"+r.message)}return function(e,t){if("china"===e){for(var i=0;i<t.length;i++)if(t[i].name===Kt)return;t.push(new bt(Kt,u(qt,(function(e){return{type:"polygon",exterior:e}})),Zt))}}(n,t),i(t,(function(e){var t=e.name;!function(e,t){if("china"===e){var i=ei[t.name];if(i){var n=t.getCenter();n[0]+=i[0]/10.5,n[1]+=-i[1]/14,t.setCenter(n)}}}(n,e),function(e,t){"china"===e&&"台湾"===t.name&&t.geometries.push({type:"polygon",exterior:ti[0]})}(n,e);var i=this._specialAreas&&this._specialAreas[t];i&&e.transformTo(i.left,i.top,i.width,i.height)}),this),t},e.prototype.getMapForUser=function(){return{geoJson:this._geoJSON,geoJSON:this._geoJSON,specialAreas:this._specialAreas}},e}();function ni(e){for(var t,i=0;i<e.length;i++){var n=e[i].getBoundingRect();(t=t||n.clone()).union(n)}return t}var oi=V();const ri=function(e,t,i){if(t.svg){var n=new Wt(e,t.svg);oi.set(e,n)}else{var o=t.geoJson||t.geoJSON;o&&!t.features?i=t.specialAreas:o=t;n=new ii(e,o,i);oi.set(e,n)}},ai=function(e){return oi.get(e)},si=function(e){var t=oi.get(e);return t&&"geoJSON"===t.type&&t.getMapForUser()},li=function(e,t,i){var n=oi.get(e);if(n)return n.load(t,i)};var pi={geoJSON:{aspectScale:.75,invertLongitute:!0},geoSVG:{aspectScale:1,invertLongitute:!1}},ui=["lng","lat"],ci=function(e){function i(t,i,n){var o=e.call(this,t)||this;o.dimensions=ui,o.type="geo",o._nameCoordMap=V(),o.map=i;var r=n.projection,a=li(i,n.nameMap,n.nameProperty),s=ai(i);o.resourceType=s?s.type:null;var l,p=o.regions=a.regions,u=pi[s.type];if(o._regionsMap=a.regionsMap,o.regions=a.regions,o.projection=r,r)for(var c=0;c<p.length;c++){var h=p[c].getBoundingRect(r);(l=l||h.clone()).union(h)}else l=a.boundingRect;return o.setBoundingRect(l.x,l.y,l.width,l.height),o.aspectScale=r?1:G(n.aspectScale,u.aspectScale),o._invertLongitute=!r&&u.invertLongitute,o}return t(i,e),i.prototype._transformTo=function(e,t,i,o){var r=this.getBoundingRect(),a=this._invertLongitute;r=r.clone(),a&&(r.y=-r.y-r.height);var s=this._rawTransformable;s.transform=r.calculateTransform(new n(e,t,i,o));var l=s.parent;s.parent=null,s.decomposeTransform(),s.parent=l,a&&(s.scaleY=-s.scaleY),this._updateTransform()},i.prototype.getRegion=function(e){return this._regionsMap.get(e)},i.prototype.getRegionByCoord=function(e){for(var t=this.regions,i=0;i<t.length;i++){var n=t[i];if("geoJSON"===n.type&&n.contain(e))return t[i]}},i.prototype.addGeoCoord=function(e,t){this._nameCoordMap.set(e,t)},i.prototype.getGeoCoord=function(e){var t=this._regionsMap.get(e);return this._nameCoordMap.get(e)||t&&t.getCenter()},i.prototype.dataToPoint=function(e,t,i){if(h(e)&&(e=this.getGeoCoord(e)),e){var n=this.projection;return n&&(e=n.project(e)),e&&this.projectedToPoint(e,t,i)}},i.prototype.pointToData=function(e){var t=this.projection;return t&&(e=t.unproject(e)),e&&this.pointToProjected(e)},i.prototype.pointToProjected=function(t){return e.prototype.pointToData.call(this,t)},i.prototype.projectedToPoint=function(t,i,n){return e.prototype.dataToPoint.call(this,t,i,n)},i.prototype.convertToPixel=function(e,t,i){var n=hi(t);return n===this?n.dataToPoint(i):null},i.prototype.convertFromPixel=function(e,t,i){var n=hi(t);return n===this?n.pointToData(i):null},i}(z);function hi(e){var t=e.geoModel,i=e.seriesModel;return t?t.coordinateSystem:i?i.coordinateSystem||(i.getReferringComponents("geo",P).models[0]||{}).coordinateSystem:null}function di(e,t){var i=e.get("boundingCoords");if(null!=i){var n=i[0],o=i[1];if(isFinite(n[0])&&isFinite(n[1])&&isFinite(o[0])&&isFinite(o[1])){var r=this.projection;if(r){var a=n[0],s=n[1],u=o[0],c=o[1];n=[1/0,1/0],o=[-1/0,-1/0];var h=function(e,t,i,a){for(var s=i-e,u=a-t,c=0;c<=100;c++){var h=c/100,d=r.project([e+s*h,t+u*h]);l(n,n,d),p(o,o,d)}};h(a,s,u,s),h(u,s,u,c),h(u,c,a,c),h(a,c,u,s)}this.setBoundingRect(n[0],n[1],o[0]-n[0],o[1]-n[1])}else;}var d,g,f,v=this.getBoundingRect(),y=e.get("layoutCenter"),m=e.get("layoutSize"),_=t.getWidth(),S=t.getHeight(),b=v.width/v.height*this.aspectScale,w=!1;if(y&&m&&(d=[U(y[0],_),U(y[1],S)],g=U(m,Math.min(_,S)),isNaN(d[0])||isNaN(d[1])||isNaN(g)||(w=!0)),w)f={},b>1?(f.width=g,f.height=g/b):(f.height=g,f.width=g*b),f.y=d[1]-f.height/2,f.x=d[0]-f.width/2;else{var x=e.getBoxLayoutParams();x.aspect=b,f=X(x,{width:_,height:S})}this.setViewRect(f.x,f.y,f.width,f.height),this.setCenter(e.get("center"),t),this.setZoom(e.get("zoom"))}N(ci,z);var gi=function(){function e(){this.dimensions=ui}return e.prototype.create=function(e,t){var n=[];function o(e){return{nameProperty:e.get("nameProperty"),aspectScale:e.get("aspectScale"),projection:e.get("projection")}}e.eachComponent("geo",(function(e,i){var r=e.get("map"),a=new ci(r+i,r,k({nameMap:e.get("nameMap")},o(e)));a.zoomLimit=e.get("scaleLimit"),n.push(a),e.coordinateSystem=a,a.model=e,a.resize=di,a.resize(e,t)})),e.eachSeries((function(e){if("geo"===e.get("coordinateSystem")){var t=e.get("geoIndex")||0;e.coordinateSystem=n[t]}}));var r={};return e.eachSeriesByType("map",(function(e){if(!e.getHostGeoModel()){var t=e.getMapType();r[t]=r[t]||[],r[t].push(e)}})),i(r,(function(e,r){var a=u(e,(function(e){return e.get("nameMap")})),s=new ci(r,r,k({nameMap:E(a)},o(e[0])));s.zoomLimit=H.apply(null,u(e,(function(e){return e.get("scaleLimit")}))),n.push(s),s.resize=di,s.resize(e[0],t),i(e,(function(e){e.coordinateSystem=s,function(e,t){i(t.get("geoCoord"),(function(t,i){e.addGeoCoord(i,t)}))}(s,e)}))})),n},e.prototype.getFilledRegions=function(e,t,n,o){for(var r=(e||[]).slice(),a=V(),s=0;s<r.length;s++)a.set(r[s].name,r[s]);var l=li(t,n,o);return i(l.regions,(function(e){var t=e.name,i=a.get(t),n=e.properties&&e.properties.echartsStyle;i||(i={name:t},r.push(i)),n&&B(i,n)})),r},e}(),fi=new gi,vi=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=i.type,t}return t(i,e),i.prototype.init=function(e,t,i){var n=ai(e.map);if(n&&"geoJSON"===n.type){var o=e.itemStyle=e.itemStyle||{};"color"in o||(o.color="#eee")}this.mergeDefaultAndTheme(e,i),Y(e,"label",["show"])},i.prototype.optionUpdated=function(){var e=this,t=this.option;t.regions=fi.getFilledRegions(t.regions,t.map,t.nameMap,t.nameProperty);var i={};this._optionModelMap=j(t.regions||[],(function(t,n){var o=n.name;return o&&(t.set(o,new J(n,e,e.ecModel)),n.selected&&(i[o]=!0)),t}),V()),t.selectedMap||(t.selectedMap=i)},i.prototype.getRegionModel=function(e){return this._optionModelMap.get(e)||new J(null,this,this.ecModel)},i.prototype.getFormattedLabel=function(e,t){var i=this.getRegionModel(e),n="normal"===t?i.get(["label","formatter"]):i.get(["emphasis","label","formatter"]),o={name:e};return W(n)?(o.status=t,n(o)):h(n)?n.replace("{a}",null!=e?e:""):void 0},i.prototype.setZoom=function(e){this.option.zoom=e},i.prototype.setCenter=function(e){this.option.center=e},i.prototype.select=function(e){var t=this.option,i=t.selectedMode;i&&("multiple"!==i&&(t.selectedMap=null),(t.selectedMap||(t.selectedMap={}))[e]=!0)},i.prototype.unSelect=function(e){var t=this.option.selectedMap;t&&(t[e]=!1)},i.prototype.toggleSelected=function(e){this[this.isSelected(e)?"unSelect":"select"](e)},i.prototype.isSelected=function(e){var t=this.option.selectedMap;return!(!t||!t[e])},i.type="geo",i.layoutMode="box",i.defaultOption={z:0,show:!0,left:"center",top:"center",aspectScale:null,silent:!1,map:"",boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},select:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},regions:[]},i}(Z),yi=["rect","circle","line","ellipse","polygon","polyline","path"],mi=V(yi),_i=V(yi.concat(["g"])),Si=V(yi.concat(["g"])),bi=K();function wi(e){var t=e.getItemStyle(),i=e.get("areaColor");return null!=i&&(t.fill=i),t}function xi(e){var t=e.style;t&&(t.stroke=t.stroke||t.fill,t.fill=null)}var Mi=function(){function e(e){var t=new g;this.uid=q("ec_map_draw"),this._controller=new Q(e.getZr()),this._controllerHost={target:t},this.group=t,t.add(this._regionsGroup=new g),t.add(this._svgGroup=new g)}return e.prototype.draw=function(e,t,i,n,o){var r="geo"===e.mainType,a=e.getData&&e.getData();r&&t.eachComponent({mainType:"series",subType:"map"},(function(t){a||t.getHostGeoModel()!==e||(a=t.getData())}));var s=e.coordinateSystem,l=this._regionsGroup,p=this.group,u=s.getTransformInfo(),c=u.raw,h=u.roam;!l.childAt(0)||o?(p.x=h.x,p.y=h.y,p.scaleX=h.scaleX,p.scaleY=h.scaleY,p.dirty()):$(p,h,e);var d=a&&a.getVisual("visualMeta")&&a.getVisual("visualMeta").length>0,g={api:i,geo:s,mapOrGeoModel:e,data:a,isVisualEncodedByVisualMap:d,isGeo:r,transformInfoRaw:c};"geoJSON"===s.resourceType?this._buildGeoJSON(g):"geoSVG"===s.resourceType&&this._buildSVG(g),this._updateController(e,t,i),this._updateMapSelectHandler(e,l,i,n)},e.prototype._buildGeoJSON=function(e){var t=this._regionsGroupByName=V(),n=V(),o=this._regionsGroup,r=e.transformInfoRaw,a=e.mapOrGeoModel,s=e.data,l=e.geo.projection,p=l&&l.stream;function u(e,t){return t&&(e=t(e)),e&&[e[0]*r.scaleX+r.x,e[1]*r.scaleY+r.y]}function c(e){for(var t=[],i=!p&&l&&l.project,n=0;n<e.length;++n){var o=u(e[n],i);o&&t.push(o)}return t}function h(e){return{shape:{points:c(e)}}}o.removeAll(),i(e.geo.regions,(function(r){var c=r.name,d=t.get(c),f=n.get(c)||{},v=f.dataIdx,y=f.regionModel;if(!d){d=t.set(c,new g),o.add(d),v=s?s.indexOfName(c):null;var m=(y=e.isGeo?a.getRegionModel(c):s?s.getItemModel(v):null).get("silent",!0);null!=m&&(d.silent=m),n.set(c,{dataIdx:v,regionModel:y})}var _=[],S=[];i(r.geometries,(function(e){if("polygon"===e.type){var t=[e.exterior].concat(e.interiors||[]);p&&(t=Ai(t,p)),i(t,(function(e){_.push(new b(h(e)))}))}else{var n=e.points;p&&(n=Ai(n,p,!0)),i(n,(function(e){S.push(new w(h(e)))}))}}));var x=u(r.getCenter(),l&&l.project);function M(t,n){if(t.length){var o=new he({culling:!0,segmentIgnoreThreshold:1,shape:{paths:t}});d.add(o),Ii(e,o,v,y),Di(e,o,c,y,a,v,x),n&&(xi(o),i(o.states,xi))}}M(_),M(S,!0)})),t.each((function(t,i){var o=n.get(i),r=o.dataIdx,s=o.regionModel;Ti(e,t,i,s,a,r),Ci(e,t,i,s,a),Li(e,t,i,s,a)}),this)},e.prototype._buildSVG=function(e){var t=e.geo.map,n=e.transformInfoRaw;this._svgGroup.x=n.x,this._svgGroup.y=n.y,this._svgGroup.scaleX=n.scaleX,this._svgGroup.scaleY=n.scaleY,this._svgResourceChanged(t)&&(this._freeSVG(),this._useSVG(t));var o=this._svgDispatcherMap=V(),r=!1;i(this._svgGraphicRecord.named,(function(t){var i=t.name,n=e.mapOrGeoModel,a=e.data,s=t.svgNodeTagLower,l=t.el,p=a?a.indexOfName(i):null,u=n.getRegionModel(i);null!=mi.get(s)&&l instanceof ee&&Ii(e,l,p,u),l instanceof ee&&(l.culling=!0);var c=u.get("silent",!0);(null!=c&&(l.silent=c),l.z2EmphasisLift=0,t.namedFrom)||(null!=Si.get(s)&&Di(e,l,i,u,n,p,null),Ti(e,l,i,u,n,p),Ci(e,l,i,u,n),null!=_i.get(s)&&("self"===Li(e,l,i,u,n)&&(r=!0),(o.get(i)||o.set(i,[])).push(l)))}),this),this._enableBlurEntireSVG(r,e)},e.prototype._enableBlurEntireSVG=function(e,t){if(e&&t.isGeo){var i=t.mapOrGeoModel.getModel(["blur","itemStyle"]).getItemStyle().opacity;this._svgGraphicRecord.root.traverse((function(e){if(!e.isGroup){te(e);var t=e.ensureState("blur").style||{};null==t.opacity&&null!=i&&(t.opacity=i),e.ensureState("emphasis")}}))}},e.prototype.remove=function(){this._regionsGroup.removeAll(),this._regionsGroupByName=null,this._svgGroup.removeAll(),this._freeSVG(),this._controller.dispose(),this._controllerHost=null},e.prototype.findHighDownDispatchers=function(e,t){if(null==e)return[];var i=t.coordinateSystem;if("geoJSON"===i.resourceType){var n=this._regionsGroupByName;if(n){var o=n.get(e);return o?[o]:[]}}else if("geoSVG"===i.resourceType)return this._svgDispatcherMap&&this._svgDispatcherMap.get(e)||[]},e.prototype._svgResourceChanged=function(e){return this._svgMapName!==e},e.prototype._useSVG=function(e){var t=ai(e);if(t&&"geoSVG"===t.type){var i=t.useGraphic(this.uid);this._svgGroup.add(i.root),this._svgGraphicRecord=i,this._svgMapName=e}},e.prototype._freeSVG=function(){var e=this._svgMapName;if(null!=e){var t=ai(e);t&&"geoSVG"===t.type&&t.freeGraphic(this.uid),this._svgGraphicRecord=null,this._svgDispatcherMap=null,this._svgGroup.removeAll(),this._svgMapName=null}},e.prototype._updateController=function(e,t,i){var n=e.coordinateSystem,o=this._controller,r=this._controllerHost;r.zoomLimit=e.get("scaleLimit"),r.zoom=n.getZoom(),o.enable(e.get("roam")||!1);var a=e.mainType;function s(){var t={type:"geoRoam",componentType:a};return t[a+"Id"]=e.id,t}o.off("pan").on("pan",(function(e){this._mouseDownFlag=!1,ie(r,e.dx,e.dy),i.dispatchAction(k(s(),{dx:e.dx,dy:e.dy,animation:{duration:0}}))}),this),o.off("zoom").on("zoom",(function(e){this._mouseDownFlag=!1,ne(r,e.scale,e.originX,e.originY),i.dispatchAction(k(s(),{totalZoom:r.zoom,zoom:e.scale,originX:e.originX,originY:e.originY,animation:{duration:0}}))}),this),o.setPointerChecker((function(t,o,r){return n.containPoint([o,r])&&!oe(t,i,e)}))},e.prototype.resetForLabelLayout=function(){this.group.traverse((function(e){var t=e.getTextContent();t&&(t.ignore=bi(t).ignore)}))},e.prototype._updateMapSelectHandler=function(e,t,i,n){var o=this;t.off("mousedown"),t.off("click"),e.get("selectedMode")&&(t.on("mousedown",(function(){o._mouseDownFlag=!0})),t.on("click",(function(e){o._mouseDownFlag&&(o._mouseDownFlag=!1)})))},e}();function Ii(e,t,i,n){var o=n.getModel("itemStyle"),r=n.getModel(["emphasis","itemStyle"]),a=n.getModel(["blur","itemStyle"]),s=n.getModel(["select","itemStyle"]),l=wi(o),p=wi(r),u=wi(s),c=wi(a),h=e.data;if(h){var d=h.getItemVisual(i,"style"),g=h.getItemVisual(i,"decal");e.isVisualEncodedByVisualMap&&d.fill&&(l.fill=d.fill),g&&(l.decal=re(g,e.api))}t.setStyle(l),t.style.strokeNoScale=!0,t.ensureState("emphasis").style=p,t.ensureState("select").style=u,t.ensureState("blur").style=c,te(t)}function Di(e,t,i,n,o,r,a){var s=e.data,l=e.isGeo,p=s&&isNaN(s.get(s.mapDimension("value"),r)),u=s&&s.getItemLayout(r);if(l||p||u&&u.showLabel){var c=l?i:r,h=void 0;(!s||r>=0)&&(h=o);var d=a?{normal:{align:"center",verticalAlign:"middle"}}:null;ae(t,se(n),{labelFetcher:h,labelDataIndex:c,defaultText:i},d);var g=t.getTextContent();if(g&&(bi(g).ignore=g.ignore,t.textConfig&&a)){var f=t.getBoundingRect().clone();t.textConfig.layoutRect=f,t.textConfig.position=[(a[0]-f.x)/f.width*100+"%",(a[1]-f.y)/f.height*100+"%"]}t.disableLabelAnimation=!0}else t.removeTextContent(),t.removeTextConfig(),t.disableLabelAnimation=null}function Ti(e,t,i,n,o,r){e.data?e.data.setItemGraphicEl(r,t):le(t).eventData={componentType:"geo",componentIndex:o.componentIndex,geoIndex:o.componentIndex,name:i,region:n&&n.option||{}}}function Ci(e,t,i,n,o){e.data||pe({el:t,componentModel:o,itemName:i,itemTooltipOption:n.get("tooltip")})}function Li(e,t,i,n,o){t.highDownSilentOnTouch=!!o.get("selectedMode");var r=n.getModel("emphasis"),a=r.get("focus");return ue(t,a,r.get("blurScope"),r.get("disabled")),e.isGeo&&ce(t,o,i),a}function Ai(e,t,n){var o,r=[];function a(){o=[]}function s(){o.length&&(r.push(o),o=[])}var l=t({polygonStart:a,polygonEnd:s,lineStart:a,lineEnd:s,point:function(e,t){isFinite(e)&&isFinite(t)&&o.push([e,t])},sphere:function(){}});return!n&&l.polygonStart(),i(e,(function(e){l.lineStart();for(var t=0;t<e.length;t++)l.point(e[t][0],e[t][1]);l.lineEnd()})),!n&&l.polygonEnd(),r}var Ri=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=i.type,t.focusBlurEnabled=!0,t}return t(i,e),i.prototype.init=function(e,t){this._api=t},i.prototype.render=function(e,t,i,n){if(this._model=e,!e.get("show"))return this._mapDraw&&this._mapDraw.remove(),void(this._mapDraw=null);this._mapDraw||(this._mapDraw=new Mi(i));var o=this._mapDraw;o.draw(e,t,i,this,n),o.group.on("click",this._handleRegionClick,this),o.group.silent=e.get("silent"),this.group.add(o.group),this.updateSelectStatus(e,t,i)},i.prototype._handleRegionClick=function(e){var t;de(e.target,(function(e){return null!=(t=le(e).eventData)}),!0),t&&this._api.dispatchAction({type:"geoToggleSelect",geoId:this._model.id,name:t.name})},i.prototype.updateSelectStatus=function(e,t,i){var n=this;this._mapDraw.group.traverse((function(e){var t=le(e).eventData;if(t)return n._model.isSelected(t.name)?i.enterSelect(e):i.leaveSelect(e),!0}))},i.prototype.findHighDownDispatchers=function(e){return this._mapDraw&&this._mapDraw.findHighDownDispatchers(e,this._model)},i.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove()},i.type="geo",i}(ge);function Oi(e,t,i){ri(e,t,i)}function Vi(e){function t(t,n){n.update="geo:updateSelectStatus",e.registerAction(n,(function(e,n){var o={},r=[];return n.eachComponent({mainType:"geo",query:e},(function(n){n[t](e.name);var a=n.coordinateSystem;i(a.regions,(function(e){o[e.name]=n.isSelected(e.name)||!1}));var s=[];i(o,(function(e,t){o[t]&&s.push(t)})),r.push({geoIndex:n.componentIndex,name:s})})),{selected:o,allSelected:r,name:e.name}}))}e.registerCoordinateSystem("geo",fi),e.registerComponentModel(vi),e.registerComponentView(Ri),e.registerImpl("registerMap",Oi),e.registerImpl("getMap",(function(e){return si(e)})),t("toggleSelected",{type:"geoToggleSelect",event:"geoselectchanged"}),t("select",{type:"geoSelect",event:"geoselected"}),t("unSelect",{type:"geoUnSelect",event:"geounselected"}),e.registerAction({type:"geoRoam",event:"geoRoam",update:"updateTransform"},(function(e,t,n){var o=e.componentType||"series";t.eachComponent({mainType:o,query:e},(function(t){var r=t.coordinateSystem;if("geo"===r.type){var a=fe(r,e,t.get("scaleLimit"),n);t.setCenter&&t.setCenter(a.center),t.setZoom&&t.setZoom(a.zoom),"series"===o&&i(t.seriesGroup,(function(e){e.setCenter(a.center),e.setZoom(a.zoom)}))}}))}))}var Fi=i;function Gi(e){if(e)for(var t in e)if(e.hasOwnProperty(t))return!0}function zi(e,t,i){var n={};return Fi(t,(function(t){var o,r=n[t]=((o=function(){}).prototype.__hidden=o.prototype,new o);Fi(e[t],(function(e,n){if(ve.isValidType(n)){var o={type:n,visual:e};i&&i(o,t),r[n]=new ve(o),"opacity"===n&&((o=ye(o)).type="colorAlpha",r.__hidden.__alphaForOpacity=new ve(o))}}))})),n}function Ni(e,t,n){var o;i(n,(function(e){t.hasOwnProperty(e)&&Gi(t[e])&&(o=!0)})),o&&i(n,(function(i){t.hasOwnProperty(i)&&Gi(t[i])?e[i]=ye(t[i]):delete e[i]}))}function Pi(e,t,n,o,r,a){var s,l={};function p(e){return me(n,s,e)}function u(e,t){_e(n,s,e,t)}i(e,(function(e){var i=ve.prepareVisualTypes(t[e]);l[e]=i})),n.each((function(e,i){s=e;var a=n.getRawDataItem(s);if(a&&!1===a.visualMap)return;for(var c=o.call(r,e),h=t[c],d=l[c],g=0,f=d.length;g<f;g++){var v=d[g];h[v]&&h[v].applyVisual(e,p,u)}}))}var ki=function(e,t,i){var n=ye((Ei[e]||{})[t]);return i&&Se(n)?n[n.length-1]:n},Ei={color:{active:["#006edd","#e0ffff"],inactive:["rgba(0,0,0,0)"]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}},Hi=ve.mapVisual,Bi=ve.eachVisual,Ui=Se,Xi=i,Yi=xe,ji=Me,Ji=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=n.type,t.stateList=["inRange","outOfRange"],t.replacableOptionKeys=["inRange","outOfRange","target","controller","color"],t.layoutMode={type:"box",ignoreSize:!0},t.dataBound=[-1/0,1/0],t.targetVisuals={},t.controllerVisuals={},t}return t(n,e),n.prototype.init=function(e,t,i){this.mergeDefaultAndTheme(e,i)},n.prototype.optionUpdated=function(e,t){var i=this.option;!t&&Ni(i,e,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption()},n.prototype.resetVisual=function(e){var t=this.stateList;e=be(e,this),this.controllerVisuals=zi(this.option.controller,t,e),this.targetVisuals=zi(this.option.target,t,e)},n.prototype.getItemSymbol=function(){return null},n.prototype.getTargetSeriesIndices=function(){var e=this.option.seriesIndex,t=[];return null==e||"all"===e?this.ecModel.eachSeries((function(e,i){t.push(i)})):t=we(e),t},n.prototype.eachTargetSeries=function(e,t){i(this.getTargetSeriesIndices(),(function(i){var n=this.ecModel.getSeriesByIndex(i);n&&e.call(t,n)}),this)},n.prototype.isTargetSeries=function(e){var t=!1;return this.eachTargetSeries((function(i){i===e&&(t=!0)})),t},n.prototype.formatValueText=function(e,t,i){var n,o=this.option,r=o.precision,a=this.dataBound,s=o.formatter;i=i||["<",">"],Se(e)&&(e=e.slice(),n=!0);var l=t?e:n?[p(e[0]),p(e[1])]:p(e);return h(s)?s.replace("{value}",n?l[0]:l).replace("{value2}",n?l[1]:l):W(s)?n?s(e[0],e[1]):s(e):n?e[0]===a[0]?i[0]+" "+l[1]:e[1]===a[1]?i[1]+" "+l[0]:l[0]+" - "+l[1]:l;function p(e){return e===a[0]?"min":e===a[1]?"max":(+e).toFixed(Math.min(r,20))}},n.prototype.resetExtent=function(){var e=this.option,t=Yi([e.min,e.max]);this._dataExtent=t},n.prototype.getDataDimensionIndex=function(e){var t=this.option.dimension;if(null!=t)return e.getDimensionIndex(t);for(var i=e.dimensions,n=i.length-1;n>=0;n--){var o=i[n],r=e.getDimensionInfo(o);if(!r.isCalculationCoord)return r.storeDimIndex}},n.prototype.getExtent=function(){return this._dataExtent.slice()},n.prototype.completeVisualOption=function(){var e=this.ecModel,t=this.option,i={inRange:t.inRange,outOfRange:t.outOfRange},n=t.target||(t.target={}),o=t.controller||(t.controller={});B(n,i),B(o,i);var r=this.isCategory();function a(i){Ui(t.color)&&!i.inRange&&(i.inRange={color:t.color.slice().reverse()}),i.inRange=i.inRange||{color:e.get("gradientColor")}}a.call(this,n),a.call(this,o),function(e,t,i){var n=e[t],o=e[i];n&&!o&&(o=e[i]={},Xi(n,(function(e,t){if(ve.isValidType(t)){var i=ki(t,"inactive",r);null!=i&&(o[t]=i,"color"!==t||o.hasOwnProperty("opacity")||o.hasOwnProperty("colorAlpha")||(o.opacity=[0,0]))}})))}.call(this,n,"inRange","outOfRange"),function(e){var t=(e.inRange||{}).symbol||(e.outOfRange||{}).symbol,i=(e.inRange||{}).symbolSize||(e.outOfRange||{}).symbolSize,n=this.get("inactiveColor"),o=this.getItemSymbol()||"roundRect";Xi(this.stateList,(function(a){var s=this.itemSize,l=e[a];l||(l=e[a]={color:r?n:[n]}),null==l.symbol&&(l.symbol=t&&ye(t)||(r?o:[o])),null==l.symbolSize&&(l.symbolSize=i&&ye(i)||(r?s[0]:[s[0],s[0]])),l.symbol=Hi(l.symbol,(function(e){return"none"===e?o:e}));var p=l.symbolSize;if(null!=p){var u=-1/0;Bi(p,(function(e){e>u&&(u=e)})),l.symbolSize=Hi(p,(function(e){return ji(e,[0,u],[0,s[0]],!0)}))}}),this)}.call(this,o)},n.prototype.resetItemSize=function(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))]},n.prototype.isCategory=function(){return!!this.option.categories},n.prototype.setSelected=function(e){},n.prototype.getSelected=function(){return null},n.prototype.getValueState=function(e){return null},n.prototype.getVisualMeta=function(e){return null},n.type="visualMap",n.dependencies=["series"],n.defaultOption={show:!0,z:4,seriesIndex:"all",min:0,max:200,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",contentColor:"#5793f3",inactiveColor:"#aaa",borderWidth:0,padding:5,textGap:10,precision:0,textStyle:{color:"#333"}},n}(Z),Wi=[20,140],Zi=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=n.type,t}return t(n,e),n.prototype.optionUpdated=function(t,i){e.prototype.optionUpdated.apply(this,arguments),this.resetExtent(),this.resetVisual((function(e){e.mappingMethod="linear",e.dataExtent=this.getExtent()})),this._resetRange()},n.prototype.resetItemSize=function(){e.prototype.resetItemSize.apply(this,arguments);var t=this.itemSize;(null==t[0]||isNaN(t[0]))&&(t[0]=Wi[0]),(null==t[1]||isNaN(t[1]))&&(t[1]=Wi[1])},n.prototype._resetRange=function(){var e=this.getExtent(),t=this.option.range;!t||t.auto?(e.auto=1,this.option.range=e):Se(t)&&(t[0]>t[1]&&t.reverse(),t[0]=Math.max(t[0],e[0]),t[1]=Math.min(t[1],e[1]))},n.prototype.completeVisualOption=function(){e.prototype.completeVisualOption.apply(this,arguments),i(this.stateList,(function(e){var t=this.option.controller[e].symbolSize;t&&t[0]!==t[1]&&(t[0]=t[1]/3)}),this)},n.prototype.setSelected=function(e){this.option.range=e.slice(),this._resetRange()},n.prototype.getSelected=function(){var e=this.getExtent(),t=xe((this.get("range")||[]).slice());return t[0]>e[1]&&(t[0]=e[1]),t[1]>e[1]&&(t[1]=e[1]),t[0]<e[0]&&(t[0]=e[0]),t[1]<e[0]&&(t[1]=e[0]),t},n.prototype.getValueState=function(e){var t=this.option.range,i=this.getExtent();return(t[0]<=i[0]||t[0]<=e)&&(t[1]>=i[1]||e<=t[1])?"inRange":"outOfRange"},n.prototype.findTargetDataIndices=function(e){var t=[];return this.eachTargetSeries((function(i){var n=[],o=i.getData();o.each(this.getDataDimensionIndex(o),(function(t,i){e[0]<=t&&t<=e[1]&&n.push(i)}),this),t.push({seriesId:i.id,dataIndex:n})}),this),t},n.prototype.getVisualMeta=function(e){var t=Ki(this,"outOfRange",this.getExtent()),i=Ki(this,"inRange",this.option.range.slice()),n=[];function o(t,i){n.push({value:t,color:e(t,i)})}for(var r=0,a=0,s=i.length,l=t.length;a<l&&(!i.length||t[a]<=i[0]);a++)t[a]<i[r]&&o(t[a],"outOfRange");for(var p=1;r<s;r++,p=0)p&&n.length&&o(i[r],"outOfRange"),o(i[r],"inRange");for(p=1;a<l;a++)(!i.length||i[i.length-1]<t[a])&&(p&&(n.length&&o(n[n.length-1].value,"outOfRange"),p=0),o(t[a],"outOfRange"));var u=n.length;return{stops:n,outerColors:[u?n[0].color:"transparent",u?n[u-1].color:"transparent"]}},n.type="visualMap.continuous",n.defaultOption=Ie(Ji.defaultOption,{align:"auto",calculable:!1,hoverLink:!0,realtime:!0,handleIcon:"path://M-11.39,9.77h0a3.5,3.5,0,0,1-3.5,3.5h-22a3.5,3.5,0,0,1-3.5-3.5h0a3.5,3.5,0,0,1,3.5-3.5h22A3.5,3.5,0,0,1-11.39,9.77Z",handleSize:"120%",handleStyle:{borderColor:"#fff",borderWidth:1},indicatorIcon:"circle",indicatorSize:"50%",indicatorStyle:{borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0,0,0,0.2)"}}),n}(Ji);function Ki(e,t,i){if(i[0]===i[1])return i.slice();for(var n=(i[1]-i[0])/200,o=i[0],r=[],a=0;a<=200&&o<i[1];a++)r.push(o),o+=n;return r.push(i[1]),r}var qi=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=n.type,t.autoPositionValues={left:1,right:1,top:1,bottom:1},t}return t(n,e),n.prototype.init=function(e,t){this.ecModel=e,this.api=t},n.prototype.render=function(e,t,i,n){this.visualMapModel=e,!1!==e.get("show")?this.doRender(e,t,i,n):this.group.removeAll()},n.prototype.renderBackground=function(e){var t=this.visualMapModel,i=De(t.get("padding")||0),n=e.getBoundingRect();e.add(new f({z2:-1,silent:!0,shape:{x:n.x-i[3],y:n.y-i[0],width:n.width+i[3]+i[1],height:n.height+i[0]+i[2]},style:{fill:t.get("backgroundColor"),stroke:t.get("borderColor"),lineWidth:t.get("borderWidth")}}))},n.prototype.getControllerVisual=function(e,t,n){var o=(n=n||{}).forceState,r=this.visualMapModel,a={};if("color"===t){var s=r.get("contentColor");a.color=s}function l(e){return a[e]}function p(e,t){a[e]=t}var u=r.controllerVisuals[o||r.getValueState(e)],c=ve.prepareVisualTypes(u);return i(c,(function(i){var o=u[i];n.convertOpacityToAlpha&&"opacity"===i&&(i="colorAlpha",o=u.__alphaForOpacity),ve.dependsOn(i,t)&&o&&o.applyVisual(e,l,p)})),a[t]},n.prototype.positionGroup=function(e){var t=this.visualMapModel,i=this.api;Te(e,t.getBoxLayoutParams(),{width:i.getWidth(),height:i.getHeight()})},n.prototype.doRender=function(e,t,i,n){},n.type="visualMap",n}(ge),Qi=[["left","right","width"],["top","bottom","height"]];function $i(e,t,i){var n=e.option,o=n.align;if(null!=o&&"auto"!==o)return o;for(var r={width:t.getWidth(),height:t.getHeight()},a="horizontal"===n.orient?1:0,s=Qi[a],l=[0,null,10],p={},u=0;u<3;u++)p[Qi[1-a][u]]=l[u],p[s[u]]=2===u?i[0]:n[s[u]];var c=[["x","width",3],["y","height",0]][a],h=X(p,r,n.padding);return s[(h.margin[c[2]]||0)+h[c[0]]+.5*h[c[1]]<.5*r[c[1]]?0:1]}function en(e,t){return i(e||[],(function(e){null!=e.dataIndex&&(e.dataIndexInside=e.dataIndex,e.dataIndex=null),e.highlightKey="visualMap"+(t?t.componentIndex:"")})),e}var tn=Me,nn=i,on=Math.min,rn=Math.max,an=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=i.type,t._shapes={},t._dataInterval=[],t._handleEnds=[],t._hoverLinkDataIndices=[],t}return t(i,e),i.prototype.init=function(t,i){e.prototype.init.call(this,t,i),this._hoverLinkFromSeriesMouseOver=be(this._hoverLinkFromSeriesMouseOver,this),this._hideIndicator=be(this._hideIndicator,this)},i.prototype.doRender=function(e,t,i,n){n&&"selectDataRange"===n.type&&n.from===this.uid||this._buildView()},i.prototype._buildView=function(){this.group.removeAll();var e=this.visualMapModel,t=this.group;this._orient=e.get("orient"),this._useHandle=e.get("calculable"),this._resetInterval(),this._renderBar(t);var i=e.get("text");this._renderEndsText(t,i,0),this._renderEndsText(t,i,1),this._updateView(!0),this.renderBackground(t),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(t)},i.prototype._renderEndsText=function(e,t,i){if(t){var n=t[1-i];n=null!=n?n+"":"";var o=this.visualMapModel,r=o.get("textGap"),a=o.itemSize,s=this._shapes.mainGroup,l=this._applyTransform([a[0]/2,0===i?-r:a[1]+r],s),p=this._applyTransform(0===i?"bottom":"top",s),u=this._orient,c=this.visualMapModel.textStyleModel;this.group.add(new Ce({style:Le(c,{x:l[0],y:l[1],verticalAlign:"horizontal"===u?"middle":p,align:"horizontal"===u?p:"center",text:n})}))}},i.prototype._renderBar=function(e){var t=this.visualMapModel,i=this._shapes,n=t.itemSize,o=this._orient,r=this._useHandle,a=$i(t,this.api,n),s=i.mainGroup=this._createBarGroup(a),l=new g;s.add(l),l.add(i.outOfRange=sn()),l.add(i.inRange=sn(null,r?pn(this._orient):null,be(this._dragHandle,this,"all",!1),be(this._dragHandle,this,"all",!0))),l.setClipPath(new f({shape:{x:0,y:0,width:n[0],height:n[1],r:3}}));var p=t.textStyleModel.getTextRect("国"),u=rn(p.width,p.height);r&&(i.handleThumbs=[],i.handleLabels=[],i.handleLabelPoints=[],this._createHandle(t,s,0,n,u,o),this._createHandle(t,s,1,n,u,o)),this._createIndicator(t,s,n,u,o),e.add(s)},i.prototype._createHandle=function(e,t,i,n,o,r){var a=be(this._dragHandle,this,i,!1),s=be(this._dragHandle,this,i,!0),l=Ae(e.get("handleSize"),n[0]),p=Re(e.get("handleIcon"),-l/2,-l/2,l,l,null,!0),u=pn(this._orient);p.attr({cursor:u,draggable:!0,drift:a,ondragend:s,onmousemove:function(e){Oe(e.event)}}),p.x=n[0]/2,p.useStyle(e.getModel("handleStyle").getItemStyle()),p.setStyle({strokeNoScale:!0,strokeFirst:!0}),p.style.lineWidth*=2,p.ensureState("emphasis").style=e.getModel(["emphasis","handleStyle"]).getItemStyle(),Ve(p,!0),t.add(p);var c=this.visualMapModel.textStyleModel,h=new Ce({cursor:u,draggable:!0,drift:a,onmousemove:function(e){Oe(e.event)},ondragend:s,style:Le(c,{x:0,y:0,text:""})});h.ensureState("blur").style={opacity:.1},h.stateTransition={duration:200},this.group.add(h);var d=[l,0],g=this._shapes;g.handleThumbs[i]=p,g.handleLabelPoints[i]=d,g.handleLabels[i]=h},i.prototype._createIndicator=function(e,t,i,n,o){var r=Ae(e.get("indicatorSize"),i[0]),a=Re(e.get("indicatorIcon"),-r/2,-r/2,r,r,null,!0);a.attr({cursor:"move",invisible:!0,silent:!0,x:i[0]/2});var s=e.getModel("indicatorStyle").getItemStyle();if(a instanceof x){var l=a.style;a.useStyle(k({image:l.image,x:l.x,y:l.y,width:l.width,height:l.height},s))}else a.useStyle(s);t.add(a);var p=this.visualMapModel.textStyleModel,u=new Ce({silent:!0,invisible:!0,style:Le(p,{x:0,y:0,text:""})});this.group.add(u);var c=[("horizontal"===o?n/2:6)+i[0]/2,0],h=this._shapes;h.indicator=a,h.indicatorLabel=u,h.indicatorLabelPoint=c,this._firstShowIndicator=!0},i.prototype._dragHandle=function(e,t,i,n){if(this._useHandle){if(this._dragging=!t,!t){var o=this._applyTransform([i,n],this._shapes.mainGroup,!0);this._updateInterval(e,o[1]),this._hideIndicator(),this._updateView()}t===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),t?!this._hovering&&this._clearHoverLinkToSeries():ln(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[e],!1)}},i.prototype._resetInterval=function(){var e=this.visualMapModel,t=this._dataInterval=e.getSelected(),i=e.getExtent(),n=[0,e.itemSize[1]];this._handleEnds=[tn(t[0],i,n,!0),tn(t[1],i,n,!0)]},i.prototype._updateInterval=function(e,t){t=t||0;var i=this.visualMapModel,n=this._handleEnds,o=[0,i.itemSize[1]];Fe(t,n,o,e,0);var r=i.getExtent();this._dataInterval=[tn(n[0],o,r,!0),tn(n[1],o,r,!0)]},i.prototype._updateView=function(e){var t=this.visualMapModel,i=t.getExtent(),n=this._shapes,o=[0,t.itemSize[1]],r=e?o:this._handleEnds,a=this._createBarVisual(this._dataInterval,i,r,"inRange"),s=this._createBarVisual(i,i,o,"outOfRange");n.inRange.setStyle({fill:a.barColor}).setShape("points",a.barPoints),n.outOfRange.setStyle({fill:s.barColor}).setShape("points",s.barPoints),this._updateHandle(r,a)},i.prototype._createBarVisual=function(e,t,i,n){var o={forceState:n,convertOpacityToAlpha:!0},r=this._makeColorGradient(e,o),a=[this.getControllerVisual(e[0],"symbolSize",o),this.getControllerVisual(e[1],"symbolSize",o)],s=this._createBarPoints(i,a);return{barColor:new I(0,0,0,1,r),barPoints:s,handlesColor:[r[0].color,r[r.length-1].color]}},i.prototype._makeColorGradient=function(e,t){var i=[],n=(e[1]-e[0])/100;i.push({color:this.getControllerVisual(e[0],"color",t),offset:0});for(var o=1;o<100;o++){var r=e[0]+n*o;if(r>e[1])break;i.push({color:this.getControllerVisual(r,"color",t),offset:o/100})}return i.push({color:this.getControllerVisual(e[1],"color",t),offset:1}),i},i.prototype._createBarPoints=function(e,t){var i=this.visualMapModel.itemSize;return[[i[0]-t[0],e[0]],[i[0],e[0]],[i[0],e[1]],[i[0]-t[1],e[1]]]},i.prototype._createBarGroup=function(e){var t=this._orient,i=this.visualMapModel.get("inverse");return new g("horizontal"!==t||i?"horizontal"===t&&i?{scaleX:"bottom"===e?-1:1,rotation:-Math.PI/2}:"vertical"!==t||i?{scaleX:"left"===e?1:-1}:{scaleX:"left"===e?1:-1,scaleY:-1}:{scaleX:"bottom"===e?1:-1,rotation:Math.PI/2})},i.prototype._updateHandle=function(e,t){if(this._useHandle){var i=this._shapes,n=this.visualMapModel,o=i.handleThumbs,r=i.handleLabels,a=n.itemSize,s=n.getExtent(),l=this._applyTransform("left",i.mainGroup);nn([0,1],(function(p){var u=o[p];u.setStyle("fill",t.handlesColor[p]),u.y=e[p];var c=tn(e[p],[0,a[1]],s,!0),h=this.getControllerVisual(c,"symbolSize");u.scaleX=u.scaleY=h/a[0],u.x=a[0]-h/2;var d=Ge(i.handleLabelPoints[p],ze(u,this.group));if("horizontal"===this._orient){var g="left"===l||"top"===l?(a[0]-h)/2:(a[0]-h)/-2;d[1]+=g}r[p].setStyle({x:d[0],y:d[1],text:n.formatValueText(this._dataInterval[p]),verticalAlign:"middle",align:"vertical"===this._orient?this._applyTransform("left",i.mainGroup):"center"})}),this)}},i.prototype._showIndicator=function(e,t,i,n){var o=this.visualMapModel,r=o.getExtent(),a=o.itemSize,s=[0,a[1]],l=this._shapes,p=l.indicator;if(p){p.attr("invisible",!1);var u=this.getControllerVisual(e,"color",{convertOpacityToAlpha:!0}),c=this.getControllerVisual(e,"symbolSize"),h=tn(e,r,s,!0),d=a[0]-c/2,g={x:p.x,y:p.y};p.y=h,p.x=d;var f=Ge(l.indicatorLabelPoint,ze(p,this.group)),v=l.indicatorLabel;v.attr("invisible",!1);var y=this._applyTransform("left",l.mainGroup),m="horizontal"===this._orient;v.setStyle({text:(i||"")+o.formatValueText(t),verticalAlign:m?y:"middle",align:m?"center":y});var _={x:d,y:h,style:{fill:u}},S={style:{x:f[0],y:f[1]}};if(o.ecModel.isAnimationEnabled()&&!this._firstShowIndicator){var b={duration:100,easing:"cubicInOut",additive:!0};p.x=g.x,p.y=g.y,p.animateTo(_,b),v.animateTo(S,b)}else p.attr(_),v.attr(S);this._firstShowIndicator=!1;var w=this._shapes.handleLabels;if(w)for(var x=0;x<w.length;x++)this.api.enterBlur(w[x])}},i.prototype._enableHoverLinkToSeries=function(){var e=this;this._shapes.mainGroup.on("mousemove",(function(t){if(e._hovering=!0,!e._dragging){var i=e.visualMapModel.itemSize,n=e._applyTransform([t.offsetX,t.offsetY],e._shapes.mainGroup,!0,!0);n[1]=on(rn(0,n[1]),i[1]),e._doHoverLinkToSeries(n[1],0<=n[0]&&n[0]<=i[0])}})).on("mouseout",(function(){e._hovering=!1,!e._dragging&&e._clearHoverLinkToSeries()}))},i.prototype._enableHoverLinkFromSeries=function(){var e=this.api.getZr();this.visualMapModel.option.hoverLink?(e.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),e.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries()},i.prototype._doHoverLinkToSeries=function(e,t){var i=this.visualMapModel,n=i.itemSize;if(i.option.hoverLink){var o=[0,n[1]],r=i.getExtent();e=on(rn(o[0],e),o[1]);var a=function(e,t,i){var n=6,o=e.get("hoverLinkDataSize");o&&(n=tn(o,t,i,!0)/2);return n}(i,r,o),s=[e-a,e+a],l=tn(e,o,r,!0),p=[tn(s[0],o,r,!0),tn(s[1],o,r,!0)];s[0]<o[0]&&(p[0]=-1/0),s[1]>o[1]&&(p[1]=1/0),t&&(p[0]===-1/0?this._showIndicator(l,p[1],"< ",a):p[1]===1/0?this._showIndicator(l,p[0],"> ",a):this._showIndicator(l,l,"≈ ",a));var u=this._hoverLinkDataIndices,c=[];(t||ln(i))&&(c=this._hoverLinkDataIndices=i.findTargetDataIndices(p));var h=Ne(u,c);this._dispatchHighDown("downplay",en(h[0],i)),this._dispatchHighDown("highlight",en(h[1],i))}},i.prototype._hoverLinkFromSeriesMouseOver=function(e){var t;if(de(e.target,(function(e){var i=le(e);if(null!=i.dataIndex)return t=i,!0}),!0),t){var i=this.ecModel.getSeriesByIndex(t.seriesIndex),n=this.visualMapModel;if(n.isTargetSeries(i)){var o=i.getData(t.dataType),r=o.getStore().get(n.getDataDimensionIndex(o),t.dataIndex);isNaN(r)||this._showIndicator(r,r)}}},i.prototype._hideIndicator=function(){var e=this._shapes;e.indicator&&e.indicator.attr("invisible",!0),e.indicatorLabel&&e.indicatorLabel.attr("invisible",!0);var t=this._shapes.handleLabels;if(t)for(var i=0;i<t.length;i++)this.api.leaveBlur(t[i])},i.prototype._clearHoverLinkToSeries=function(){this._hideIndicator();var e=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",en(e,this.visualMapModel)),e.length=0},i.prototype._clearHoverLinkFromSeries=function(){this._hideIndicator();var e=this.api.getZr();e.off("mouseover",this._hoverLinkFromSeriesMouseOver),e.off("mouseout",this._hideIndicator)},i.prototype._applyTransform=function(e,t,i,n){var o=ze(t,n?null:this.group);return Se(e)?Ge(e,o,i):Pe(e,o,i)},i.prototype._dispatchHighDown=function(e,t){t&&t.length&&this.api.dispatchAction({type:e,batch:t})},i.prototype.dispose=function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},i.type="visualMap.continuous",i}(qi);function sn(e,t,i,n){return new b({shape:{points:e},draggable:!!i,cursor:t,drift:i,onmousemove:function(e){Oe(e.event)},ondragend:n})}function ln(e){var t=e.get("hoverLinkOnHandle");return!!(null==t?e.get("realtime"):t)}function pn(e){return"vertical"===e?"ns-resize":"ew-resize"}var un={type:"selectDataRange",event:"dataRangeSelected",update:"update"},cn=function(e,t){t.eachComponent({mainType:"visualMap",query:e},(function(t){t.setSelected(e.selected)}))},hn=[{createOnAllSeries:!0,reset:function(e,t){var n=[];return t.eachComponent("visualMap",(function(t){var o,r,a,s,l,p=e.pipelineContext;!t.isTargetSeries(e)||p&&p.large||n.push((o=t.stateList,r=t.targetVisuals,a=be(t.getValueState,t),s=t.getDataDimensionIndex(e.getData()),l={},i(o,(function(e){var t=ve.prepareVisualTypes(r[e]);l[e]=t})),{progress:function(e,t){var i,n;function o(e){return me(t,n,e)}function p(e,i){_e(t,n,e,i)}null!=s&&(i=t.getDimensionIndex(s));for(var u=t.getStore();null!=(n=e.next());){var c=t.getRawDataItem(n);if(!c||!1!==c.visualMap)for(var h=null!=s?u.get(i,n):n,d=a(h),g=r[d],f=l[d],v=0,y=f.length;v<y;v++){var m=f[v];g[m]&&g[m].applyVisual(h,o,p)}}}}))})),n}},{createOnAllSeries:!0,reset:function(e,t){var i=e.getData(),n=[];t.eachComponent("visualMap",(function(t){if(t.isTargetSeries(e)){var o=t.getVisualMeta(be(dn,null,e,t))||{stops:[],outerColors:[]},r=t.getDataDimensionIndex(i);r>=0&&(o.dimension=r,n.push(o))}})),e.getData().setVisual("visualMeta",n)}}];function dn(e,t,i,n){for(var o=t.targetVisuals[n],r=ve.prepareVisualTypes(o),a={color:ke(e.getData(),"color")},s=0,l=r.length;s<l;s++){var p=r[s],u=o["opacity"===p?"__alphaForOpacity":p];u&&u.applyVisual(i,c,h)}return a.color;function c(e){return a[e]}function h(e,t){a[e]=t}}var gn=i;function fn(e){var t=e&&e.visualMap;Se(t)||(t=t?[t]:[]),gn(t,(function(e){if(e){vn(e,"splitList")&&!vn(e,"pieces")&&(e.pieces=e.splitList,delete e.splitList);var t=e.pieces;t&&Se(t)&&gn(t,(function(e){Ee(e)&&(vn(e,"start")&&!vn(e,"min")&&(e.min=e.start),vn(e,"end")&&!vn(e,"max")&&(e.max=e.end))}))}}))}function vn(e,t){return e&&e.hasOwnProperty&&e.hasOwnProperty(t)}var yn=!1;function mn(e){yn||(yn=!0,e.registerSubTypeDefaulter("visualMap",(function(e){return e.categories||(e.pieces?e.pieces.length>0:e.splitNumber>0)&&!e.calculable?"piecewise":"continuous"})),e.registerAction(un,cn),i(hn,(function(t){e.registerVisual(e.PRIORITY.VISUAL.COMPONENT,t)})),e.registerPreprocessor(fn))}function _n(e){e.registerComponentModel(Zi),e.registerComponentView(an),mn(e)}var Sn=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=n.type,t._pieceList=[],t}return t(n,e),n.prototype.optionUpdated=function(t,i){e.prototype.optionUpdated.apply(this,arguments),this.resetExtent();var n=this._mode=this._determineMode();this._pieceList=[],bn[this._mode].call(this,this._pieceList),this._resetSelected(t,i);var o=this.option.categories;this.resetVisual((function(e,t){"categories"===n?(e.mappingMethod="category",e.categories=ye(o)):(e.dataExtent=this.getExtent(),e.mappingMethod="piecewise",e.pieceList=u(this._pieceList,(function(e){return e=ye(e),"inRange"!==t&&(e.visual=null),e})))}))},n.prototype.completeVisualOption=function(){var t=this.option,n={},o=ve.listVisualTypes(),r=this.isCategory();function a(e,t,i){return e&&e[t]&&e[t].hasOwnProperty(i)}i(t.pieces,(function(e){i(o,(function(t){e.hasOwnProperty(t)&&(n[t]=1)}))})),i(n,(function(e,n){var o=!1;i(this.stateList,(function(e){o=o||a(t,e,n)||a(t.target,e,n)}),this),!o&&i(this.stateList,(function(e){(t[e]||(t[e]={}))[n]=ki(n,"inRange"===e?"active":"inactive",r)}))}),this),e.prototype.completeVisualOption.apply(this,arguments)},n.prototype._resetSelected=function(e,t){var n=this.option,o=this._pieceList,r=(t?n:e).selected||{};if(n.selected=r,i(o,(function(e,t){var i=this.getSelectedMapKey(e);r.hasOwnProperty(i)||(r[i]=!0)}),this),"single"===n.selectedMode){var a=!1;i(o,(function(e,t){var i=this.getSelectedMapKey(e);r[i]&&(a?r[i]=!1:a=!0)}),this)}},n.prototype.getItemSymbol=function(){return this.get("itemSymbol")},n.prototype.getSelectedMapKey=function(e){return"categories"===this._mode?e.value+"":e.index+""},n.prototype.getPieceList=function(){return this._pieceList},n.prototype._determineMode=function(){var e=this.option;return e.pieces&&e.pieces.length>0?"pieces":this.option.categories?"categories":"splitNumber"},n.prototype.setSelected=function(e){this.option.selected=ye(e)},n.prototype.getValueState=function(e){var t=ve.findPieceIndex(e,this._pieceList);return null!=t&&this.option.selected[this.getSelectedMapKey(this._pieceList[t])]?"inRange":"outOfRange"},n.prototype.findTargetDataIndices=function(e){var t=[],i=this._pieceList;return this.eachTargetSeries((function(n){var o=[],r=n.getData();r.each(this.getDataDimensionIndex(r),(function(t,n){ve.findPieceIndex(t,i)===e&&o.push(n)}),this),t.push({seriesId:n.id,dataIndex:o})}),this),t},n.prototype.getRepresentValue=function(e){var t;if(this.isCategory())t=e.value;else if(null!=e.value)t=e.value;else{var i=e.interval||[];t=i[0]===-1/0&&i[1]===1/0?0:(i[0]+i[1])/2}return t},n.prototype.getVisualMeta=function(e){if(!this.isCategory()){var t=[],n=["",""],o=this,r=this._pieceList.slice();if(r.length){var a=r[0].interval[0];a!==-1/0&&r.unshift({interval:[-1/0,a]}),(a=r[r.length-1].interval[1])!==1/0&&r.push({interval:[a,1/0]})}else r.push({interval:[-1/0,1/0]});var s=-1/0;return i(r,(function(e){var t=e.interval;t&&(t[0]>s&&l([s,t[0]],"outOfRange"),l(t.slice()),s=t[1])}),this),{stops:t,outerColors:n}}function l(i,r){var a=o.getRepresentValue({interval:i});r||(r=o.getValueState(a));var s=e(a,r);i[0]===-1/0?n[0]=s:i[1]===1/0?n[1]=s:t.push({value:i[0],color:s},{value:i[1],color:s})}},n.type="visualMap.piecewise",n.defaultOption=Ie(Ji.defaultOption,{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieces:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0}),n}(Ji),bn={splitNumber:function(e){var t=this.option,n=Math.min(t.precision,20),o=this.getExtent(),r=t.splitNumber;r=Math.max(parseInt(r,10),1),t.splitNumber=r;for(var a=(o[1]-o[0])/r;+a.toFixed(n)!==a&&n<5;)n++;t.precision=n,a=+a.toFixed(n),t.minOpen&&e.push({interval:[-1/0,o[0]],close:[0,0]});for(var s=0,l=o[0];s<r;l+=a,s++){var p=s===r-1?o[1]:l+a;e.push({interval:[l,p],close:[1,1]})}t.maxOpen&&e.push({interval:[o[1],1/0],close:[0,0]}),He(e),i(e,(function(e,t){e.index=t,e.text=this.formatValueText(e.interval)}),this)},categories:function(e){var t=this.option;i(t.categories,(function(t){e.push({text:this.formatValueText(t,!0),value:t})}),this),wn(t,e)},pieces:function(e){var t=this.option;i(t.pieces,(function(t,i){Ee(t)||(t={value:t});var n={text:"",index:i};if(null!=t.label&&(n.text=t.label),t.hasOwnProperty("value")){var o=n.value=t.value;n.interval=[o,o],n.close=[1,1]}else{for(var r=n.interval=[],a=n.close=[0,0],s=[1,0,1],l=[-1/0,1/0],p=[],u=0;u<2;u++){for(var c=[["gte","gt","min"],["lte","lt","max"]][u],h=0;h<3&&null==r[u];h++)r[u]=t[c[h]],a[u]=s[h],p[u]=2===h;null==r[u]&&(r[u]=l[u])}p[0]&&r[1]===1/0&&(a[0]=0),p[1]&&r[0]===-1/0&&(a[1]=0),r[0]===r[1]&&a[0]&&a[1]&&(n.value=r[0])}n.visual=ve.retrieveVisuals(t),e.push(n)}),this),wn(t,e),He(e),i(e,(function(e){var t=e.close,i=[["<","≤"][t[1]],[">","≥"][t[0]]];e.text=e.text||this.formatValueText(null!=e.value?e.value:e.interval,!1,i)}),this)}};function wn(e,t){var i=e.inverse;("vertical"===e.orient?!i:i)&&t.reverse()}var xn=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=n.type,t}return t(n,e),n.prototype.doRender=function(){var e=this.group;e.removeAll();var t=this.visualMapModel,n=t.get("textGap"),o=t.textStyleModel,r=o.getFont(),a=o.getTextColor(),s=this._getItemAlign(),l=t.itemSize,p=this._getViewData(),u=p.endsText,c=H(t.get("showLabel",!0),!u),h=!t.get("selectedMode");u&&this._renderEndsText(e,u[0],l,c,s),i(p.viewPieceList,(function(i){var o=i.piece,p=new g;p.onclick=be(this._onItemClick,this,o),this._enableHoverLink(p,i.indexInModelPieceList);var u=t.getRepresentValue(o);if(this._createItemSymbol(p,u,[0,0,l[0],l[1]],h),c){var d=this.visualMapModel.getValueState(u);p.add(new Ce({style:{x:"right"===s?-n:l[0]+n,y:l[1]/2,text:o.text,verticalAlign:"middle",align:s,font:r,fill:a,opacity:"outOfRange"===d?.5:1},silent:h}))}e.add(p)}),this),u&&this._renderEndsText(e,u[1],l,c,s),Be(t.get("orient"),e,t.get("itemGap")),this.renderBackground(e),this.positionGroup(e)},n.prototype._enableHoverLink=function(e,t){var i=this;e.on("mouseover",(function(){return n("highlight")})).on("mouseout",(function(){return n("downplay")}));var n=function(e){var n=i.visualMapModel;n.option.hoverLink&&i.api.dispatchAction({type:e,batch:en(n.findTargetDataIndices(t),n)})}},n.prototype._getItemAlign=function(){var e=this.visualMapModel,t=e.option;if("vertical"===t.orient)return $i(e,this.api,e.itemSize);var i=t.align;return i&&"auto"!==i||(i="left"),i},n.prototype._renderEndsText=function(e,t,i,n,o){if(t){var r=new g,a=this.visualMapModel.textStyleModel;r.add(new Ce({style:Le(a,{x:n?"right"===o?i[0]:0:i[0]/2,y:i[1]/2,verticalAlign:"middle",align:n?o:"center",text:t})})),e.add(r)}},n.prototype._getViewData=function(){var e=this.visualMapModel,t=u(e.getPieceList(),(function(e,t){return{piece:e,indexInModelPieceList:t}})),i=e.get("text"),n=e.get("orient"),o=e.get("inverse");return("horizontal"===n?o:!o)?t.reverse():i&&(i=i.slice().reverse()),{viewPieceList:t,endsText:i}},n.prototype._createItemSymbol=function(e,t,i,n){var o=Re(this.getControllerVisual(t,"symbol"),i[0],i[1],i[2],i[3],this.getControllerVisual(t,"color"));o.silent=n,e.add(o)},n.prototype._onItemClick=function(e){var t=this.visualMapModel,n=t.option,o=n.selectedMode;if(o){var r=ye(n.selected),a=t.getSelectedMapKey(e);"single"===o||!0===o?(r[a]=!0,i(r,(function(e,t){r[t]=t===a}))):r[a]=!r[a],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:r})}},n.type="visualMap.piecewise",n}(qi);function Mn(e){e.registerComponentModel(Sn),e.registerComponentView(xn),mn(e)}function In(e){Ue(_n),Ue(Mn)}function Dn(e,t){return{seriesType:e,plan:Xe(),reset:function(e){var i=e.getData(),n=e.coordinateSystem,o=e.pipelineContext,r=t||o.large;if(n){var a=u(n.dimensions,(function(e){return i.mapDimension(e)})).slice(0,2),s=a.length,l=i.getCalculationInfo("stackResultDimension");Ye(i,a[0])&&(a[0]=l),Ye(i,a[1])&&(a[1]=l);var p=i.getStore(),c=i.getDimensionIndex(a[0]),h=i.getDimensionIndex(a[1]);return s&&{progress:function(e,t){for(var i=e.end-e.start,o=r&&je(i*s),a=[],l=[],u=e.start,d=0;u<e.end;u++){var g=void 0;if(1===s){var f=p.get(c,u);g=n.dataToPoint(f,null,l)}else a[0]=p.get(c,u),a[1]=p.get(h,u),g=n.dataToPoint(a,null,l);r?(o[d++]=g[0],o[d++]=g[1]):t.setItemLayout(u,g.slice())}r&&t.setLayout("points",o)}}}}}}var Tn=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=i.type,t.hasSymbolVisual=!0,t}return t(i,e),i.prototype.getInitialData=function(e,t){return Je(null,this,{useEncodeDefaulter:!0})},i.prototype.getProgressive=function(){var e=this.option.progressive;return null==e?this.option.large?5e3:this.get("progressive"):e},i.prototype.getProgressiveThreshold=function(){var e=this.option.progressiveThreshold;return null==e?this.option.large?1e4:this.get("progressiveThreshold"):e},i.prototype.brushSelector=function(e,t,i){return i.point(t.getItemLayout(e))},i.prototype.getZLevelKey=function(){return this.getData().count()>this.getProgressiveThreshold()?this.id:""},i.type="series.scatter",i.dependencies=["grid","polar","geo","singleAxis","calendar"],i.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{opacity:.8},emphasis:{scale:!0},clip:!0,select:{itemStyle:{borderColor:"#212121"}},universalTransition:{divideShape:"clone"}},i}(We),Cn=function(){return function(){}}(),Ln=function(e){function i(t){var i=e.call(this,t)||this;return i._off=0,i.hoverDataIdx=-1,i}return t(i,e),i.prototype.getDefaultShape=function(){return new Cn},i.prototype.reset=function(){this.notClear=!1,this._off=0},i.prototype.buildPath=function(e,t){var i,n=t.points,o=t.size,r=this.symbolProxy,a=r.shape,s=e.getContext?e.getContext():e,l=s&&o[0]<4,p=this.softClipShape;if(l)this._ctx=s;else{for(this._ctx=null,i=this._off;i<n.length;){var u=n[i++],c=n[i++];isNaN(u)||isNaN(c)||(p&&!p.contain(u,c)||(a.x=u-o[0]/2,a.y=c-o[1]/2,a.width=o[0],a.height=o[1],r.buildPath(e,a,!0)))}this.incremental&&(this._off=i,this.notClear=!0)}},i.prototype.afterBrush=function(){var e,t=this.shape,i=t.points,n=t.size,o=this._ctx,r=this.softClipShape;if(o){for(e=this._off;e<i.length;){var a=i[e++],s=i[e++];isNaN(a)||isNaN(s)||(r&&!r.contain(a,s)||o.fillRect(a-n[0]/2,s-n[1]/2,n[0],n[1]))}this.incremental&&(this._off=e,this.notClear=!0)}},i.prototype.findDataIndex=function(e,t){for(var i=this.shape,n=i.points,o=i.size,r=Math.max(o[0],4),a=Math.max(o[1],4),s=n.length/2-1;s>=0;s--){var l=2*s,p=n[l]-r/2,u=n[l+1]-a/2;if(e>=p&&t>=u&&e<=p+r&&t<=u+a)return s}return-1},i.prototype.contain=function(e,t){var i=this.transformCoordToLocal(e,t),n=this.getBoundingRect();return e=i[0],t=i[1],n.contain(e,t)?(this.hoverDataIdx=this.findDataIndex(e,t))>=0:(this.hoverDataIdx=-1,!1)},i.prototype.getBoundingRect=function(){var e=this._rect;if(!e){for(var t=this.shape,i=t.points,o=t.size,r=o[0],a=o[1],s=1/0,l=1/0,p=-1/0,u=-1/0,c=0;c<i.length;){var h=i[c++],d=i[c++];s=Math.min(h,s),p=Math.max(h,p),l=Math.min(d,l),u=Math.max(d,u)}e=this._rect=new n(s-r/2,l-a/2,p-s+r,u-l+a)}return e},i}(Ze),An=function(){function e(){this.group=new g}return e.prototype.updateData=function(e,t){this._clear();var i=this._create();i.setShape({points:e.getLayout("points")}),this._setCommon(i,e,t)},e.prototype.updateLayout=function(e){var t=e.getLayout("points");this.group.eachChild((function(e){if(null!=e.startIndex){var i=2*(e.endIndex-e.startIndex),n=4*e.startIndex*2;t=new Float32Array(t.buffer,n,i)}e.setShape("points",t),e.reset()}))},e.prototype.incrementalPrepareUpdate=function(e){this._clear()},e.prototype.incrementalUpdate=function(e,t,i){var n=this._newAdded[0],o=t.getLayout("points"),r=n&&n.shape.points;if(r&&r.length<2e4){var a=r.length,s=new Float32Array(a+o.length);s.set(r),s.set(o,a),n.endIndex=e.end,n.setShape({points:s})}else{this._newAdded=[];var l=this._create();l.startIndex=e.start,l.endIndex=e.end,l.incremental=!0,l.setShape({points:o}),this._setCommon(l,t,i)}},e.prototype.eachRendered=function(e){this._newAdded[0]&&e(this._newAdded[0])},e.prototype._create=function(){var e=new Ln({cursor:"default"});return e.ignoreCoarsePointer=!0,this.group.add(e),this._newAdded.push(e),e},e.prototype._setCommon=function(e,t,i){var n=t.hostModel;i=i||{};var o=t.getVisual("symbolSize");e.setShape("size",o instanceof Array?o:[o,o]),e.softClipShape=i.clipShape||null,e.symbolProxy=Re(t.getVisual("symbol"),0,0,0,0),e.setColor=e.symbolProxy.setColor;var r=e.shape.size[0]<4;e.useStyle(n.getModel("itemStyle").getItemStyle(r?["color","shadowBlur","shadowColor"]:["color"]));var a=t.getVisual("style"),s=a&&a.fill;s&&e.setColor(s);var l=le(e);l.seriesIndex=n.seriesIndex,e.on("mousemove",(function(t){l.dataIndex=null;var i=e.hoverDataIdx;i>=0&&(l.dataIndex=i+(e.startIndex||0))}))},e.prototype.remove=function(){this._clear()},e.prototype._clear=function(){this._newAdded=[],this.group.removeAll()},e}(),Rn=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=i.type,t}return t(i,e),i.prototype.render=function(e,t,i){var n=e.getData();this._updateSymbolDraw(n,e).updateData(n,{clipShape:this._getClipShape(e)}),this._finished=!0},i.prototype.incrementalPrepareRender=function(e,t,i){var n=e.getData();this._updateSymbolDraw(n,e).incrementalPrepareUpdate(n),this._finished=!1},i.prototype.incrementalRender=function(e,t,i){this._symbolDraw.incrementalUpdate(e,t.getData(),{clipShape:this._getClipShape(t)}),this._finished=e.end===t.getData().count()},i.prototype.updateTransform=function(e,t,i){var n=e.getData();if(this.group.dirty(),!this._finished||n.count()>1e4)return{update:!0};var o=Dn("").reset(e,t,i);o.progress&&o.progress({start:0,end:n.count(),count:n.count()},n),this._symbolDraw.updateLayout(n)},i.prototype.eachRendered=function(e){this._symbolDraw&&this._symbolDraw.eachRendered(e)},i.prototype._getClipShape=function(e){if(e.get("clip",!0)){var t=e.coordinateSystem;return t&&t.getArea&&t.getArea(.1)}},i.prototype._updateSymbolDraw=function(e,t){var i=this._symbolDraw,n=t.pipelineContext.large;return i&&n===this._isLargeDraw||(i&&i.remove(),i=this._symbolDraw=n?new An:new Ke,this._isLargeDraw=n,this.group.removeAll()),this.group.add(i.group),i},i.prototype.remove=function(e,t){this._symbolDraw&&this._symbolDraw.remove(!0),this._symbolDraw=null},i.prototype.dispose=function(){},i.type="scatter",i}(qe);function On(e){Ue(ut),e.registerSeriesModel(Tn),e.registerChartView(Rn),e.registerLayout(Dn("scatter"))}var Vn=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=i.type,t}return t(i,e),i.prototype.render=function(e,t,i,n){if(!n||"mapToggleSelect"!==n.type||n.from!==this.uid){var o=this.group;if(o.removeAll(),!e.getHostGeoModel()){if(this._mapDraw&&n&&"geoRoam"===n.type&&this._mapDraw.resetForLabelLayout(),n&&"geoRoam"===n.type&&"series"===n.componentType&&n.seriesId===e.id)(r=this._mapDraw)&&o.add(r.group);else if(e.needsDrawMap){var r=this._mapDraw||new Mi(i);o.add(r.group),r.draw(e,t,i,this,n),this._mapDraw=r}else this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;e.get("showLegendSymbol")&&t.getComponent("legend")&&this._renderSymbols(e,t,i)}}},i.prototype.remove=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null,this.group.removeAll()},i.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null},i.prototype._renderSymbols=function(e,t,i){var n=e.originalData,o=this.group;n.each(n.mapDimension("value"),(function(t,i){if(!isNaN(t)){var r=n.getItemLayout(i);if(r&&r.point){var a=r.point,s=r.offset,l=new m({style:{fill:e.getData().getVisual("style").fill},shape:{cx:a[0]+9*s,cy:a[1],r:3},silent:!0,z2:8+(s?0:Qe+1)});if(!s){var p=e.mainSeries.getData(),u=n.getName(i),c=p.indexOfName(u),h=n.getItemModel(i),d=h.getModel("label"),g=p.getItemGraphicEl(c);ae(l,se(h),{labelFetcher:{getFormattedLabel:function(t,i){return e.getFormattedLabel(c,i)}},defaultText:u}),l.disableLabelAnimation=!0,d.get("position")||l.setTextConfig({position:"bottom"}),g.onHoverStateChange=function(e){$e(l,e)}}o.add(l)}}}))},i.type="map",i}(qe),Fn=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=n.type,t.needsDrawMap=!1,t.seriesGroup=[],t.getTooltipPosition=function(e){if(null!=e){var t=this.getData().getName(e),i=this.coordinateSystem,n=i.getRegion(t);return n&&i.dataToPoint(n.getCenter())}},t}return t(n,e),n.prototype.getInitialData=function(e){for(var t=ct(this,{coordDimensions:["value"],encodeDefaulter:et(tt,this)}),n=V(),o=[],r=0,a=t.count();r<a;r++){var s=t.getName(r);n.set(s,r)}var l=li(this.getMapType(),this.option.nameMap,this.option.nameProperty);return i(l.regions,(function(e){var i,r=e.name,a=n.get(r),s=e.properties&&e.properties.echartsStyle;null==a?(i={name:r},o.push(i)):i=t.getRawDataItem(a),s&&B(i,s)})),t.appendData(o),t},n.prototype.getHostGeoModel=function(){var e=this.option.geoIndex;return null!=e?this.ecModel.getComponent("geo",e):null},n.prototype.getMapType=function(){return(this.getHostGeoModel()||this).option.map},n.prototype.getRawValue=function(e){var t=this.getData();return t.get(t.mapDimension("value"),e)},n.prototype.getRegionModel=function(e){var t=this.getData();return t.getItemModel(t.indexOfName(e))},n.prototype.formatTooltip=function(e,t,i){for(var n=this.getData(),o=this.getRawValue(e),r=n.getName(e),a=this.seriesGroup,s=[],l=0;l<a.length;l++){var p=a[l].originalData.indexOfName(r),u=n.mapDimension("value");isNaN(a[l].originalData.get(u,p))||s.push(a[l].name)}return it("section",{header:s.join(", "),noHeader:!s.length,blocks:[it("nameValue",{name:r,value:o})]})},n.prototype.setZoom=function(e){this.option.zoom=e},n.prototype.setCenter=function(e){this.option.center=e},n.prototype.getLegendIcon=function(e){var t=e.icon||"roundRect",i=Re(t,0,0,e.itemWidth,e.itemHeight,e.itemStyle.fill);return i.setStyle(e.itemStyle),i.style.stroke="none",t.indexOf("empty")>-1&&(i.style.stroke=i.style.fill,i.style.fill="#fff",i.style.lineWidth=2),i},n.type="series.map",n.dependencies=["geo"],n.layoutMode="box",n.defaultOption={z:2,coordinateSystem:"geo",map:"",left:"center",top:"center",aspectScale:null,showLegendSymbol:!0,boundingCoords:null,center:null,zoom:1,scaleLimit:null,selectedMode:!0,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444",areaColor:"#eee"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{areaColor:"rgba(255,215,0,0.8)"}},select:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},nameProperty:"name"},n}(We);function Gn(e){var t={};e.eachSeriesByType("map",(function(e){var i=e.getHostGeoModel(),n=i?"o"+i.id:"i"+e.getMapType();(t[n]=t[n]||[]).push(e)})),i(t,(function(e,t){for(var n,o,r,a=(n=u(e,(function(e){return e.getData()})),o=e[0].get("mapValueCalculation"),r={},i(n,(function(e){e.each(e.mapDimension("value"),(function(t,i){var n="ec-"+e.getName(i);r[n]=r[n]||[],isNaN(t)||r[n].push(t)}))})),n[0].map(n[0].mapDimension("value"),(function(e,t){for(var i="ec-"+n[0].getName(t),a=0,s=1/0,l=-1/0,p=r[i].length,u=0;u<p;u++)s=Math.min(s,r[i][u]),l=Math.max(l,r[i][u]),a+=r[i][u];return 0===p?NaN:"min"===o?s:"max"===o?l:"average"===o?a/p:a}))),s=0;s<e.length;s++)e[s].originalData=e[s].getData();for(s=0;s<e.length;s++)e[s].seriesGroup=e,e[s].needsDrawMap=0===s&&!e[s].getHostGeoModel(),e[s].setData(a.cloneShallow()),e[s].mainSeries=e[0]}))}function zn(e){var t={};e.eachSeriesByType("map",(function(n){var o=n.getMapType();if(!n.getHostGeoModel()&&!t[o]){var r={};i(n.seriesGroup,(function(t){var i=t.coordinateSystem,n=t.originalData;t.get("showLegendSymbol")&&e.getComponent("legend")&&n.each(n.mapDimension("value"),(function(e,t){var o=n.getName(t),a=i.getRegion(o);if(a&&!isNaN(e)){var s=r[o]||0,l=i.dataToPoint(a.getCenter());r[o]=s+1,n.setItemLayout(t,{point:l,offset:s})}}))}));var a=n.getData();a.each((function(e){var t=a.getName(e),i=a.getItemLayout(e)||{};i.showLabel=!r[t],a.setItemLayout(e,i)})),t[o]=!0}}))}function Nn(e){Ue(Vi),e.registerChartView(Vn),e.registerSeriesModel(Fn),e.registerLayout(zn),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,Gn),nt("map",e.registerAction)}function Pn(e,t){var i=t.rippleEffectColor||t.color;e.eachChild((function(e){e.attr({z:t.z,zlevel:t.zlevel,style:{stroke:"stroke"===t.brushType?i:null,fill:"fill"===t.brushType?i:null}})}))}var kn=function(e){function i(t,i){var n=e.call(this)||this,o=new ot(t,i),r=new g;return n.add(o),n.add(r),n.updateData(t,i),n}return t(i,e),i.prototype.stopEffectAnimation=function(){this.childAt(1).removeAll()},i.prototype.startEffectAnimation=function(e){for(var t=e.symbolType,i=e.color,n=e.rippleNumber,o=this.childAt(1),r=0;r<n;r++){var a=Re(t,-1,-1,2,2,i);a.attr({style:{strokeNoScale:!0},z2:99,silent:!0,scaleX:.5,scaleY:.5});var s=-r/n*e.period+e.effectOffset;a.animate("",!0).when(e.period,{scaleX:e.rippleScale/2,scaleY:e.rippleScale/2}).delay(s).start(),a.animateStyle(!0).when(e.period,{opacity:0}).delay(s).start(),o.add(a)}Pn(o,e)},i.prototype.updateEffectAnimation=function(e){for(var t=this._effectCfg,i=this.childAt(1),n=["symbolType","period","rippleScale","rippleNumber"],o=0;o<n.length;o++){var r=n[o];if(t[r]!==e[r])return this.stopEffectAnimation(),void this.startEffectAnimation(e)}Pn(i,e)},i.prototype.highlight=function(){rt(this)},i.prototype.downplay=function(){at(this)},i.prototype.getSymbolType=function(){var e=this.childAt(0);return e&&e.getSymbolType()},i.prototype.updateData=function(e,t){var i=this,n=e.hostModel;this.childAt(0).updateData(e,t);var o=this.childAt(1),r=e.getItemModel(t),a=e.getItemVisual(t,"symbol"),s=st(e.getItemVisual(t,"symbolSize")),l=e.getItemVisual(t,"style"),p=l&&l.fill,u=r.getModel("emphasis");o.setScale(s),o.traverse((function(e){e.setStyle("fill",p)}));var c=lt(e.getItemVisual(t,"symbolOffset"),s);c&&(o.x=c[0],o.y=c[1]);var h=e.getItemVisual(t,"symbolRotate");o.rotation=(h||0)*Math.PI/180||0;var d={};d.showEffectOn=n.get("showEffectOn"),d.rippleScale=r.get(["rippleEffect","scale"]),d.brushType=r.get(["rippleEffect","brushType"]),d.period=1e3*r.get(["rippleEffect","period"]),d.effectOffset=t/e.count(),d.z=n.getShallow("z")||0,d.zlevel=n.getShallow("zlevel")||0,d.symbolType=a,d.color=p,d.rippleEffectColor=r.get(["rippleEffect","color"]),d.rippleNumber=r.get(["rippleEffect","number"]),"render"===d.showEffectOn?(this._effectCfg?this.updateEffectAnimation(d):this.startEffectAnimation(d),this._effectCfg=d):(this._effectCfg=null,this.stopEffectAnimation(),this.onHoverStateChange=function(e){"emphasis"===e?"render"!==d.showEffectOn&&i.startEffectAnimation(d):"normal"===e&&"render"!==d.showEffectOn&&i.stopEffectAnimation()}),this._effectCfg=d,ue(this,u.get("focus"),u.get("blurScope"),u.get("disabled"))},i.prototype.fadeOut=function(e){e&&e()},i}(g),En=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=i.type,t}return t(i,e),i.prototype.init=function(){this._symbolDraw=new Ke(kn)},i.prototype.render=function(e,t,i){var n=e.getData(),o=this._symbolDraw;o.updateData(n,{clipShape:this._getClipShape(e)}),this.group.add(o.group)},i.prototype._getClipShape=function(e){var t=e.coordinateSystem,i=t&&t.getArea&&t.getArea();return e.get("clip",!0)?i:null},i.prototype.updateTransform=function(e,t,i){var n=e.getData();this.group.dirty();var o=Dn("").reset(e,t,i);o.progress&&o.progress({start:0,end:n.count(),count:n.count()},n),this._symbolDraw.updateLayout()},i.prototype._updateGroupTransform=function(e){var t=e.coordinateSystem;t&&t.getRoamTransform&&(this.group.transform=pt(t.getRoamTransform()),this.group.decomposeTransform())},i.prototype.remove=function(e,t){this._symbolDraw&&this._symbolDraw.remove(!0)},i.type="effectScatter",i}(qe),Hn=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=i.type,t.hasSymbolVisual=!0,t}return t(i,e),i.prototype.getInitialData=function(e,t){return Je(null,this,{useEncodeDefaulter:!0})},i.prototype.brushSelector=function(e,t,i){return i.point(t.getItemLayout(e))},i.type="series.effectScatter",i.dependencies=["grid","polar"],i.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,effectType:"ripple",progressive:0,showEffectOn:"render",clip:!0,rippleEffect:{period:4,scale:2.5,brushType:"fill",number:3},universalTransition:{divideShape:"clone"},symbolSize:10},i}(We);function Bn(e){e.registerChartView(En),e.registerSeriesModel(Hn),e.registerLayout(Dn("effectScatter"))}export{Nn as a,On as b,Bn as c,dt as d,zi as e,Pi as f,Vi as g,_n as h,In as i,Mn as j,Dn as p,Ni as r};
