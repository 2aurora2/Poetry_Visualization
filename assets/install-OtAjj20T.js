import{g as e}from"./install-09CvjRxq.js";import{u as t,a0 as a,_ as i,aV as n,ak as o,D as r,ah as s,w as l,a1 as d,bQ as h,ag as u,al as c,ai as g,U as p,aq as f,ab as y,c1 as v,aF as m,dZ as x,b1 as _,y as b,aY as w,Z as S,g as M,at as I,ao as A,dx as L,dz as D,l as E,a4 as k,a3 as R,dv as C,c5 as P,a6 as T,a5 as V,bA as z,am as O,T as Z,bu as B,S as N,aE as G,d_ as H,a8 as F,z as W,cg as Y,aM as X,bM as j,bH as U,c8 as q,H as K,Q,C as $,aj as J,dO as ee,bf as te,be as ae,bF as ie,c3 as ne,bh as oe,bg as re,d$ as se,bE as le,cq as de,cr as he,dE as ue,dF as ce,cw as ge,bI as pe,P as fe,aX as ye,X as ve,ct as me,dr as xe}from"./vintage-W2u9YdUI.js";import{D as _e,f as be,g as we,h as Se,j as Me,k as Ie}from"./install-Cw1SDNr2.js";function Ae(i){t(e),t(a)}function Le(e,t){return e.type===t}var De=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return i(t,e),t.type="dataZoom.inside",t.defaultOption=n(_e.defaultOption,{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),t}(_e),Ee=l();function ke(e,t){if(t){e.removeKey(t.model.uid);var a=t.controller;a&&a.dispose()}}function Re(e,t){e.isDisposed()||e.dispatchAction({type:"dataZoom",animation:{easing:"cubicOut",duration:100},batch:t})}function Ce(e,t,a,i){return e.coordinateSystem.containPoint([a,i])}function Pe(e){e.registerProcessor(e.PRIORITY.PROCESSOR.FILTER,(function(e,t){var a=Ee(t),i=a.coordSysRecordMap||(a.coordSysRecordMap=o());i.each((function(e){e.dataZoomInfoMap=null})),e.eachComponent({mainType:"dataZoom",subType:"inside"},(function(e){var a=be(e);r(a.infoList,(function(a){var n=a.model.uid,s=i.get(n)||i.set(n,function(e,t){var a={model:t,containsPoint:d(Ce,t),dispatchAction:d(Re,e),dataZoomInfoMap:null,controller:null},i=a.controller=new h(e.getZr());return r(["pan","zoom","scrollMove"],(function(e){i.on(e,(function(t){var i=[];a.dataZoomInfoMap.each((function(n){if(t.isAvailableBehavior(n.model.option)){var o=(n.getRange||{})[e],r=o&&o(n.dzReferCoordSysInfo,a.model.mainType,a.controller,t);!n.model.get("disabled",!0)&&r&&i.push({dataZoomId:n.model.id,start:r[0],end:r[1]})}})),i.length&&a.dispatchAction(i)}))})),a}(t,a.model));(s.dataZoomInfoMap||(s.dataZoomInfoMap=o())).set(e.uid,{dzReferCoordSysInfo:a,model:e,getRange:null})}))})),i.each((function(e){var t,a=e.controller,n=e.dataZoomInfoMap;if(n){var o=n.keys()[0];null!=o&&(t=n.get(o))}if(t){var r=function(e){var t,a="type_",i={type_true:2,type_move:1,type_false:0,type_undefined:-1},n=!0;return e.each((function(e){var o=e.model,r=!o.get("disabled",!0)&&(!o.get("zoomLock",!0)||"move");i[a+r]>i[a+t]&&(t=r),n=n&&o.get("preventDefaultMouseMove",!0)})),{controlType:t,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!n}}}(n);a.enable(r.controlType,r.opt),a.setPointerChecker(e.containsPoint),s(e,"dispatchAction",t.model.get("throttle",!0),"fixRate")}else ke(i,e)}))}))}var Te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="dataZoom.inside",t}return i(t,e),t.prototype.render=function(t,a,i){e.prototype.render.apply(this,arguments),t.noTarget()?this._clear():(this.range=t.getPercentRange(),function(e,t,a){Ee(e).coordSysRecordMap.each((function(e){var i=e.dataZoomInfoMap.get(t.uid);i&&(i.getRange=a)}))}(i,t,{pan:u(Ve.pan,this),zoom:u(Ve.zoom,this),scrollMove:u(Ve.scrollMove,this)}))},t.prototype.dispose=function(){this._clear(),e.prototype.dispose.apply(this,arguments)},t.prototype._clear=function(){!function(e,t){for(var a=Ee(e).coordSysRecordMap,i=a.keys(),n=0;n<i.length;n++){var o=i[n],r=a.get(o),s=r.dataZoomInfoMap;if(s){var l=t.uid;s.get(l)&&(s.removeKey(l),s.keys().length||ke(a,r))}}}(this.api,this.dataZoomModel),this.range=null},t.type="dataZoom.inside",t}(we),Ve={zoom:function(e,t,a,i){var n=this.range,o=n.slice(),r=e.axisModels[0];if(r){var s=Oe[t](null,[i.originX,i.originY],r,a,e),l=(s.signal>0?s.pixelStart+s.pixelLength-s.pixel:s.pixel-s.pixelStart)/s.pixelLength*(o[1]-o[0])+o[0],d=Math.max(1/i.scale,0);o[0]=(o[0]-l)*d+l,o[1]=(o[1]-l)*d+l;var h=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();return c(0,o,[0,100],0,h.minSpan,h.maxSpan),this.range=o,n[0]!==o[0]||n[1]!==o[1]?o:void 0}},pan:ze((function(e,t,a,i,n,o){var r=Oe[i]([o.oldX,o.oldY],[o.newX,o.newY],t,n,a);return r.signal*(e[1]-e[0])*r.pixel/r.pixelLength})),scrollMove:ze((function(e,t,a,i,n,o){return Oe[i]([0,0],[o.scrollDelta,o.scrollDelta],t,n,a).signal*(e[1]-e[0])*o.scrollDelta}))};function ze(e){return function(t,a,i,n){var o=this.range,r=o.slice(),s=t.axisModels[0];if(s){var l=e(r,s,t,a,i,n);return c(l,r,[0,100],"all"),this.range=r,o[0]!==r[0]||o[1]!==r[1]?r:void 0}}}var Oe={grid:function(e,t,a,i,n){var o=a.axis,r={},s=n.model.coordinateSystem.getRect();return e=e||[0,0],"x"===o.dim?(r.pixel=t[0]-e[0],r.pixelLength=s.width,r.pixelStart=s.x,r.signal=o.inverse?1:-1):(r.pixel=t[1]-e[1],r.pixelLength=s.height,r.pixelStart=s.y,r.signal=o.inverse?-1:1),r},polar:function(e,t,a,i,n){var o=a.axis,r={},s=n.model.coordinateSystem,l=s.getRadiusAxis().getExtent(),d=s.getAngleAxis().getExtent();return e=e?s.pointToCoord(e):[0,0],t=s.pointToCoord(t),"radiusAxis"===a.mainType?(r.pixel=t[0]-e[0],r.pixelLength=l[1]-l[0],r.pixelStart=l[0],r.signal=o.inverse?1:-1):(r.pixel=t[1]-e[1],r.pixelLength=d[1]-d[0],r.pixelStart=d[0],r.signal=o.inverse?-1:1),r},singleAxis:function(e,t,a,i,n){var o=a.axis,r=n.model.coordinateSystem.getRect(),s={};return e=e||[0,0],"horizontal"===o.orient?(s.pixel=t[0]-e[0],s.pixelLength=r.width,s.pixelStart=r.x,s.signal=o.inverse?1:-1):(s.pixel=t[1]-e[1],s.pixelLength=r.height,s.pixelStart=r.y,s.signal=o.inverse?-1:1),s}};function Ze(e){Se(e),e.registerComponentModel(De),e.registerComponentView(Te),Pe(e)}var Be=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return i(t,e),t.type="dataZoom.slider",t.layoutMode="box",t.defaultOption=n(_e.defaultOption,{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,borderColor:"#d2dbee",borderRadius:3,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#d2dbee",width:.5},areaStyle:{color:"#d2dbee",opacity:.2}},selectedDataBackground:{lineStyle:{color:"#8fb0f7",width:.5},areaStyle:{color:"#8fb0f7",opacity:.2}},fillerColor:"rgba(135,175,274,0.2)",handleIcon:"path://M-9.35,34.56V42m0-40V9.5m-2,0h4a2,2,0,0,1,2,2v21a2,2,0,0,1-2,2h-4a2,2,0,0,1-2-2v-21A2,2,0,0,1-11.35,9.5Z",handleSize:"100%",handleStyle:{color:"#fff",borderColor:"#ACB8D1"},moveHandleSize:7,moveHandleIcon:"path://M-320.9-50L-320.9-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-348-41-339-50-320.9-50z M-212.3-50L-212.3-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-239.4-41-230.4-50-212.3-50z M-103.7-50L-103.7-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-130.9-41-121.8-50-103.7-50z",moveHandleStyle:{color:"#D2DBEE",opacity:.7},showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#6E7079"},brushSelect:!0,brushStyle:{color:"rgba(135,175,274,0.15)"},emphasis:{handleLabel:{show:!0},handleStyle:{borderColor:"#8FB0F7"},moveHandleStyle:{color:"#8FB0F7"}}}),t}(_e),Ne=I,Ge="horizontal",He="vertical",Fe=["line","bar","candlestick","scatter"],We={easing:"cubicOut",duration:100,delay:0},Ye=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a._displayables={},a}return i(t,e),t.prototype.init=function(e,t){this.api=t,this._onBrush=u(this._onBrush,this),this._onBrushEnd=u(this._onBrushEnd,this)},t.prototype.render=function(t,a,i,n){if(e.prototype.render.apply(this,arguments),s(this,"_dispatchZoomAction",t.get("throttle"),"fixRate"),this._orient=t.getOrient(),!1!==t.get("show")){if(t.noTarget())return this._clear(),void this.group.removeAll();n&&"dataZoom"===n.type&&n.from===this.uid||this._buildView(),this._updateView()}else this.group.removeAll()},t.prototype.dispose=function(){this._clear(),e.prototype.dispose.apply(this,arguments)},t.prototype._clear=function(){g(this,"_dispatchZoomAction");var e=this.api.getZr();e.off("mousemove",this._onBrush),e.off("mouseup",this._onBrushEnd)},t.prototype._buildView=function(){var e=this.group;e.removeAll(),this._brushing=!1,this._displayables.brushRect=null,this._resetLocation(),this._resetInterval();var t=this._displayables.sliderGroup=new p;this._renderBackground(),this._renderHandle(),this._renderDataShadow(),e.add(t),this._positionGroup()},t.prototype._resetLocation=function(){var e=this.dataZoomModel,t=this.api,a=e.get("brushSelect")?7:0,i=this._findCoordRect(),n={width:t.getWidth(),height:t.getHeight()},o=this._orient===Ge?{right:n.width-i.x-i.width,top:n.height-30-7-a,width:i.width,height:30}:{right:7,top:i.y,width:30,height:i.height},s=f(e.option);r(["right","top","width","height"],(function(e){"ph"===s[e]&&(s[e]=o[e])}));var l=y(s,n);this._location={x:l.x,y:l.y},this._size=[l.width,l.height],this._orient===He&&this._size.reverse()},t.prototype._positionGroup=function(){var e=this.group,t=this._location,a=this._orient,i=this.dataZoomModel.getFirstTargetAxisModel(),n=i&&i.get("inverse"),o=this._displayables.sliderGroup,r=(this._dataShadowInfo||{}).otherAxisInverse;o.attr(a!==Ge||n?a===Ge&&n?{scaleY:r?1:-1,scaleX:-1}:a!==He||n?{scaleY:r?-1:1,scaleX:-1,rotation:Math.PI/2}:{scaleY:r?-1:1,scaleX:1,rotation:Math.PI/2}:{scaleY:r?1:-1,scaleX:1});var s=e.getBoundingRect([o]);e.x=t.x-s.x,e.y=t.y-s.y,e.markRedraw()},t.prototype._getViewExtent=function(){return[0,this._size[0]]},t.prototype._renderBackground=function(){var e=this.dataZoomModel,t=this._size,a=this._displayables.sliderGroup,i=e.get("brushSelect");a.add(new Ne({silent:!0,shape:{x:0,y:0,width:t[0],height:t[1]},style:{fill:e.get("backgroundColor")},z2:-40}));var n=new Ne({shape:{x:0,y:0,width:t[0],height:t[1]},style:{fill:"transparent"},z2:0,onclick:u(this._onClickPanel,this)}),o=this.api.getZr();i?(n.on("mousedown",this._onBrushStart,this),n.cursor="crosshair",o.on("mousemove",this._onBrush),o.on("mouseup",this._onBrushEnd)):(o.off("mousemove",this._onBrush),o.off("mouseup",this._onBrushEnd)),a.add(n)},t.prototype._renderDataShadow=function(){var e=this._dataShadowInfo=this._prepareDataShadowInfo();if(this._displayables.dataShadowSegs=[],e){var t=this._size,a=this._shadowSize||[],i=e.series,n=i.getRawData(),o=i.getShadowDim&&i.getShadowDim(),r=o&&n.getDimensionInfo(o)?i.getShadowDim():e.otherDim;if(null!=r){var s=this._shadowPolygonPts,l=this._shadowPolylinePts;if(n!==this._shadowData||r!==this._shadowDim||t[0]!==a[0]||t[1]!==a[1]){var d=n.getDataExtent(r),h=.3*(d[1]-d[0]);d=[d[0]-h,d[1]+h];var u,c=[0,t[1]],g=[0,t[0]],f=[[t[0],0],[0,0]],y=[],m=g[1]/(n.count()-1),x=0,_=Math.round(n.count()/t[0]);n.each([r],(function(e,t){if(_>0&&t%_)x+=m;else{var a=null==e||isNaN(e)||""===e,i=a?0:v(e,d,c,!0);a&&!u&&t?(f.push([f[f.length-1][0],0]),y.push([y[y.length-1][0],0])):!a&&u&&(f.push([x,0]),y.push([x,0])),f.push([x,i]),y.push([x,i]),x+=m,u=a}})),s=this._shadowPolygonPts=f,l=this._shadowPolylinePts=y}this._shadowData=n,this._shadowDim=r,this._shadowSize=[t[0],t[1]];for(var b,w,S,M,I,A=this.dataZoomModel,L=0;L<3;L++){var D=(b=1===L,w=void 0,S=void 0,M=void 0,I=void 0,w=A.getModel(b?"selectedDataBackground":"dataBackground"),S=new p,M=new T({shape:{points:s},segmentIgnoreThreshold:1,style:w.getModel("areaStyle").getAreaStyle(),silent:!0,z2:-20}),I=new V({shape:{points:l},segmentIgnoreThreshold:1,style:w.getModel("lineStyle").getLineStyle(),silent:!0,z2:-19}),S.add(M),S.add(I),S);this._displayables.sliderGroup.add(D),this._displayables.dataShadowSegs.push(D)}}}},t.prototype._prepareDataShadowInfo=function(){var e=this.dataZoomModel,t=e.get("showDataShadow");if(!1!==t){var a,i=this.ecModel;return e.eachTargetAxis((function(n,o){var s=e.getAxisProxy(n,o).getTargetSeriesModels();r(s,(function(e){if(!(a||!0!==t&&m(Fe,e.get("type"))<0)){var r,s=i.getComponent(Me(n),o).axis,l={x:"y",y:"x",radius:"angle",angle:"radius"}[n],d=e.coordinateSystem;null!=l&&d.getOtherAxis&&(r=d.getOtherAxis(s).inverse),l=e.getData().mapDimension(l),a={thisAxis:s,series:e,thisDim:n,otherDim:l,otherAxisInverse:r}}}),this)}),this),a}},t.prototype._renderHandle=function(){var e=this.group,t=this._displayables,a=t.handles=[null,null],i=t.handleLabels=[null,null],n=this._displayables.sliderGroup,o=this._size,s=this.dataZoomModel,l=this.api,d=s.get("borderRadius")||0,h=s.get("brushSelect"),c=t.filler=new Ne({silent:h,style:{fill:s.get("fillerColor")},textConfig:{position:"inside"}});n.add(c),n.add(new Ne({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:o[0],height:o[1],r:d},style:{stroke:s.get("dataBackgroundColor")||s.get("borderColor"),lineWidth:1,fill:"rgba(0,0,0,0)"}})),r([0,1],(function(t){var o=s.get("handleIcon");!x[o]&&o.indexOf("path://")<0&&o.indexOf("image://")<0&&(o="path://"+o);var r=_(o,-1,0,2,2,null,!0);r.attr({cursor:Xe(this._orient),draggable:!0,drift:u(this._onDragMove,this,t),ondragend:u(this._onDragEnd,this),onmouseover:u(this._showDataInfo,this,!0),onmouseout:u(this._showDataInfo,this,!1),z2:5});var l=r.getBoundingRect(),d=s.get("handleSize");this._handleHeight=b(d,this._size[1]),this._handleWidth=l.width/l.height*this._handleHeight,r.setStyle(s.getModel("handleStyle").getItemStyle()),r.style.strokeNoScale=!0,r.rectHover=!0,r.ensureState("emphasis").style=s.getModel(["emphasis","handleStyle"]).getItemStyle(),w(r);var h=s.get("handleColor");null!=h&&(r.style.fill=h),n.add(a[t]=r);var c=s.getModel("textStyle"),g=(s.get("handleLabel")||{}).show||!1;e.add(i[t]=new S({silent:!0,invisible:!g,style:M(c,{x:0,y:0,text:"",verticalAlign:"middle",align:"center",fill:c.getTextColor(),font:c.getFont()}),z2:10}))}),this);var g=c;if(h){var p=b(s.get("moveHandleSize"),o[1]),f=t.moveHandle=new I({style:s.getModel("moveHandleStyle").getItemStyle(),silent:!0,shape:{r:[0,0,2,2],y:o[1]-.5,height:p}}),y=.8*p,v=t.moveHandleIcon=_(s.get("moveHandleIcon"),-y/2,-y/2,y,y,"#fff",!0);v.silent=!0,v.y=o[1]+p/2-.5,f.ensureState("emphasis").style=s.getModel(["emphasis","moveHandleStyle"]).getItemStyle();var m=Math.min(o[1]/2,Math.max(p,10));(g=t.moveZone=new I({invisible:!0,shape:{y:o[1]-m,height:p+m}})).on("mouseover",(function(){l.enterEmphasis(f)})).on("mouseout",(function(){l.leaveEmphasis(f)})),n.add(f),n.add(v),n.add(g)}g.attr({draggable:!0,cursor:Xe(this._orient),drift:u(this._onDragMove,this,"all"),ondragstart:u(this._showDataInfo,this,!0),ondragend:u(this._onDragEnd,this),onmouseover:u(this._showDataInfo,this,!0),onmouseout:u(this._showDataInfo,this,!1)})},t.prototype._resetInterval=function(){var e=this._range=this.dataZoomModel.getPercentRange(),t=this._getViewExtent();this._handleEnds=[v(e[0],[0,100],t,!0),v(e[1],[0,100],t,!0)]},t.prototype._updateInterval=function(e,t){var a=this.dataZoomModel,i=this._handleEnds,n=this._getViewExtent(),o=a.findRepresentativeAxisProxy().getMinMaxSpan(),r=[0,100];c(t,i,n,a.get("zoomLock")?"all":e,null!=o.minSpan?v(o.minSpan,r,n,!0):null,null!=o.maxSpan?v(o.maxSpan,r,n,!0):null);var s=this._range,l=this._range=A([v(i[0],n,r,!0),v(i[1],n,r,!0)]);return!s||s[0]!==l[0]||s[1]!==l[1]},t.prototype._updateView=function(e){var t=this._displayables,a=this._handleEnds,i=A(a.slice()),n=this._size;r([0,1],(function(e){var i=t.handles[e],o=this._handleHeight;i.attr({scaleX:o/2,scaleY:o/2,x:a[e]+(e?-1:1),y:n[1]/2-o/2})}),this),t.filler.setShape({x:i[0],y:0,width:i[1]-i[0],height:n[1]});var o={x:i[0],width:i[1]-i[0]};t.moveHandle&&(t.moveHandle.setShape(o),t.moveZone.setShape(o),t.moveZone.getBoundingRect(),t.moveHandleIcon&&t.moveHandleIcon.attr("x",o.x+o.width/2));for(var s=t.dataShadowSegs,l=[0,i[0],i[1],n[0]],d=0;d<s.length;d++){var h=s[d],u=h.getClipPath();u||(u=new I,h.setClipPath(u)),u.setShape({x:l[d],y:0,width:l[d+1]-l[d],height:n[1]})}this._updateDataInfo(e)},t.prototype._updateDataInfo=function(e){var t=this.dataZoomModel,a=this._displayables,i=a.handleLabels,n=this._orient,o=["",""];if(t.get("showDetail")){var r=t.findRepresentativeAxisProxy();if(r){var s=r.getAxisModel().axis,l=this._range,d=e?r.calculateDataWindow({start:l[0],end:l[1]}).valueWindow:r.getDataValueWindow();o=[this._formatLabel(d[0],s),this._formatLabel(d[1],s)]}}var h=A(this._handleEnds.slice());function u(e){var t=L(a.handles[e].parent,this.group),r=D(0===e?"right":"left",t),s=this._handleWidth/2+5,l=E([h[e]+(0===e?-s:s),this._size[1]/2],t);i[e].setStyle({x:l[0],y:l[1],verticalAlign:n===Ge?"middle":r,align:n===Ge?r:"center",text:o[e]})}u.call(this,0),u.call(this,1)},t.prototype._formatLabel=function(e,t){var a=this.dataZoomModel,i=a.get("labelFormatter"),n=a.get("labelPrecision");null!=n&&"auto"!==n||(n=t.getPixelPrecision());var o=null==e||isNaN(e)?"":"category"===t.type||"time"===t.type?t.scale.getLabel({value:Math.round(e)}):e.toFixed(Math.min(n,20));return k(i)?i(e,o):R(i)?i.replace("{value}",o):o},t.prototype._showDataInfo=function(e){var t=(this.dataZoomModel.get("handleLabel")||{}).show||!1,a=this.dataZoomModel.getModel(["emphasis","handleLabel"]).get("show")||!1,i=e||this._dragging?a:t,n=this._displayables,o=n.handleLabels;o[0].attr("invisible",!i),o[1].attr("invisible",!i),n.moveHandle&&this.api[i?"enterEmphasis":"leaveEmphasis"](n.moveHandle,1)},t.prototype._onDragMove=function(e,t,a,i){this._dragging=!0,C(i.event);var n=this._displayables.sliderGroup.getLocalTransform(),o=E([t,a],n,!0),r=this._updateInterval(e,o[0]),s=this.dataZoomModel.get("realtime");this._updateView(!s),r&&s&&this._dispatchZoomAction(!0)},t.prototype._onDragEnd=function(){this._dragging=!1,this._showDataInfo(!1),!this.dataZoomModel.get("realtime")&&this._dispatchZoomAction(!1)},t.prototype._onClickPanel=function(e){var t=this._size,a=this._displayables.sliderGroup.transformCoordToLocal(e.offsetX,e.offsetY);if(!(a[0]<0||a[0]>t[0]||a[1]<0||a[1]>t[1])){var i=this._handleEnds,n=(i[0]+i[1])/2,o=this._updateInterval("all",a[0]-n);this._updateView(),o&&this._dispatchZoomAction(!1)}},t.prototype._onBrushStart=function(e){var t=e.offsetX,a=e.offsetY;this._brushStart=new P(t,a),this._brushing=!0,this._brushStartTime=+new Date},t.prototype._onBrushEnd=function(e){if(this._brushing){var t=this._displayables.brushRect;if(this._brushing=!1,t){t.attr("ignore",!0);var a=t.shape;if(!(+new Date-this._brushStartTime<200&&Math.abs(a.width)<5)){var i=this._getViewExtent(),n=[0,100];this._range=A([v(a.x,i,n,!0),v(a.x+a.width,i,n,!0)]),this._handleEnds=[a.x,a.x+a.width],this._updateView(),this._dispatchZoomAction(!1)}}}},t.prototype._onBrush=function(e){this._brushing&&(C(e.event),this._updateBrushRect(e.offsetX,e.offsetY))},t.prototype._updateBrushRect=function(e,t){var a=this._displayables,i=this.dataZoomModel,n=a.brushRect;n||(n=a.brushRect=new Ne({silent:!0,style:i.getModel("brushStyle").getItemStyle()}),a.sliderGroup.add(n)),n.attr("ignore",!1);var o=this._brushStart,r=this._displayables.sliderGroup,s=r.transformCoordToLocal(e,t),l=r.transformCoordToLocal(o.x,o.y),d=this._size;s[0]=Math.max(Math.min(d[0],s[0]),0),n.setShape({x:l[0],y:0,width:s[0]-l[0],height:d[1]})},t.prototype._dispatchZoomAction=function(e){var t=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,animation:e?We:null,start:t[0],end:t[1]})},t.prototype._findCoordRect=function(){var e,t=be(this.dataZoomModel).infoList;if(!e&&t.length){var a=t[0].model.coordinateSystem;e=a.getRect&&a.getRect()}if(!e){var i=this.api.getWidth(),n=this.api.getHeight();e={x:.2*i,y:.2*n,width:.6*i,height:.6*n}}return e},t.type="dataZoom.slider",t}(we);function Xe(e){return"vertical"===e?"ns-resize":"ew-resize"}function je(e){e.registerComponentModel(Be),e.registerComponentView(Ye),Se(e)}function Ue(e){t(Ze),t(je)}function qe(e,t,a,i,n){var o=e.getArea(),r=o.x,s=o.y,l=o.width,d=o.height,h=a.get(["lineStyle","width"])||0;r-=h/2,s-=h/2,l+=h,d+=h,l=Math.ceil(l),r!==Math.floor(r)&&(r=Math.floor(r),l++);var u=new I({shape:{x:r,y:s,width:l,height:d}});if(t){var c=e.getBaseAxis(),g=c.isHorizontal(),p=c.inverse;g?(p&&(u.shape.x+=l),u.shape.width=0):(p||(u.shape.y+=d),u.shape.height=0);var f=k(n)?function(e){n(e,u)}:null;z(u,{shape:{width:l,height:d,x:r,y:s}},a,null,i,f)}return u}function Ke(e,t,a){var i=e.getArea(),n=O(i.r0,1),o=O(i.r,1),r=new Z({shape:{cx:O(e.cx,1),cy:O(e.cy,1),r0:n,r:o,startAngle:i.startAngle,endAngle:i.endAngle,clockwise:i.clockwise}});t&&("angle"===e.getBaseAxis().dim?r.shape.endAngle=i.startAngle:r.shape.r=n,z(r,{shape:{endAngle:i.endAngle,r:o}},a));return r}function Qe(e,t,a,i,n){return e?"polar"===e.type?Ke(e,t,a):"cartesian2d"===e.type?qe(e,t,a,i,n):null:null}var $e={average:function(e){for(var t=0,a=0,i=0;i<e.length;i++)isNaN(e[i])||(t+=e[i],a++);return 0===a?NaN:t/a},sum:function(e){for(var t=0,a=0;a<e.length;a++)t+=e[a]||0;return t},max:function(e){for(var t=-1/0,a=0;a<e.length;a++)e[a]>t&&(t=e[a]);return isFinite(t)?t:NaN},min:function(e){for(var t=1/0,a=0;a<e.length;a++)e[a]<t&&(t=e[a]);return isFinite(t)?t:NaN},nearest:function(e){return e[0]}},Je=function(e){return Math.round(e.length/2)};function et(e){return{seriesType:e,reset:function(e,t,a){var i=e.getData(),n=e.get("sampling"),o=e.coordinateSystem,r=i.count();if(r>10&&"cartesian2d"===o.type&&n){var s=o.getBaseAxis(),l=o.getOtherAxis(s),d=s.getExtent(),h=a.getDevicePixelRatio(),u=Math.abs(d[1]-d[0])*(h||1),c=Math.round(r/u);if(isFinite(c)&&c>1){"lttb"===n?e.setData(i.lttbDownSample(i.mapDimension(l.dim),1/c)):"minmax"===n&&e.setData(i.minmaxDownSample(i.mapDimension(l.dim),1/c));var g=void 0;R(n)?g=$e[n]:k(n)&&(g=n),g&&e.setData(i.downSample(i.mapDimension(l.dim),1/c,g,Je))}}}}}var tt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return i(t,e),t.prototype.getInitialData=function(e,t){return B(null,this,{useEncodeDefaulter:!0})},t.prototype.getMarkerPosition=function(e,t,a){var i=this.coordinateSystem;if(i&&i.clampData){var n=i.clampData(e),o=i.dataToPoint(n);if(a)r(i.getAxes(),(function(e,a){if("category"===e.type&&null!=t){var i=e.getTicksCoords(),r=e.getTickModel().get("alignWithLabel"),s=n[a],l="x1"===t[a]||"y1"===t[a];if(l&&!r&&(s+=1),i.length<2)return;if(2===i.length)return void(o[a]=e.toGlobalCoord(e.getExtent()[l?1:0]));for(var d=void 0,h=void 0,u=1,c=0;c<i.length;c++){var g=i[c].coord,p=c===i.length-1?i[c-1].tickValue+u:i[c].tickValue;if(p===s){h=g;break}if(p<s)d=g;else if(null!=d&&p>s){h=(g+d)/2;break}1===c&&(u=p-i[0].tickValue)}null==h&&(d?d&&(h=i[i.length-1].coord):h=i[0].coord),o[a]=e.toGlobalCoord(h)}}));else{var s=this.getData(),l=s.getLayout("offset"),d=s.getLayout("size"),h=i.getBaseAxis().isHorizontal()?0:1;o[h]+=l+d/2}return o}return[NaN,NaN]},t.type="series.__base_bar__",t.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},t}(N);N.registerClass(tt);var at=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return i(t,e),t.prototype.getInitialData=function(){return B(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},t.prototype.getProgressive=function(){return!!this.get("large")&&this.get("progressive")},t.prototype.getProgressiveThreshold=function(){var e=this.get("progressiveThreshold"),t=this.get("largeThreshold");return t>e&&(e=t),e},t.prototype.brushSelector=function(e,t,a){return a.rect(t.getItemLayout(e))},t.type="series.bar",t.dependencies=["grid","polar"],t.defaultOption=n(tt.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),t}(tt),it=function(){return function(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0}}(),nt=function(e){function t(t){var a=e.call(this,t)||this;return a.type="sausage",a}return i(t,e),t.prototype.getDefaultShape=function(){return new it},t.prototype.buildPath=function(e,t){var a=t.cx,i=t.cy,n=Math.max(t.r0||0,0),o=Math.max(t.r,0),r=.5*(o-n),s=n+r,l=t.startAngle,d=t.endAngle,h=t.clockwise,u=2*Math.PI,c=h?d-l<u:l-d<u;c||(l=d-(h?u:-u));var g=Math.cos(l),p=Math.sin(l),f=Math.cos(d),y=Math.sin(d);c?(e.moveTo(g*n+a,p*n+i),e.arc(g*s+a,p*s+i,r,-Math.PI+l,l,!h)):e.moveTo(g*o+a,p*o+i),e.arc(a,i,o,l,d,!h),e.arc(f*s+a,y*s+i,r,d-2*Math.PI,d-Math.PI,!h),0!==n&&e.arc(a,i,n,d,l,h)},t}(G);function ot(e,t,a){return t*Math.sin(e)*(a?-1:1)}function rt(e,t,a){return t*Math.cos(e)*(a?1:-1)}var st=Math.max,lt=Math.min;var dt=function(e){function t(){var a=e.call(this)||this;return a.type=t.type,a._isFirstFrame=!0,a}return i(t,e),t.prototype.render=function(e,t,a,i){this._model=e,this._removeOnRenderedListener(a),this._updateDrawMode(e);var n=e.get("coordinateSystem");"cartesian2d"!==n&&"polar"!==n||(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(e,t,a):this._renderNormal(e,t,a,i))},t.prototype.incrementalPrepareRender=function(e){this._clear(),this._updateDrawMode(e),this._updateLargeClip(e)},t.prototype.incrementalRender=function(e,t){this._progressiveEls=[],this._incrementalRenderLarge(e,t)},t.prototype.eachRendered=function(e){Y(this._progressiveEls||this.group,e)},t.prototype._updateDrawMode=function(e){var t=e.pipelineContext.large;null!=this._isLargeDraw&&t===this._isLargeDraw||(this._isLargeDraw=t,this._clear())},t.prototype._renderNormal=function(e,t,a,i){var n,o=this.group,r=e.getData(),s=this._data,l=e.coordinateSystem,d=l.getBaseAxis();"cartesian2d"===l.type?n=d.isHorizontal():"polar"===l.type&&(n="angle"===d.dim);var h=e.isAnimationEnabled()?e:null,u=function(e,t){var a=e.get("realtimeSort",!0),i=t.getBaseAxis();if(a&&"category"===i.type&&"cartesian2d"===t.type)return{baseAxis:i,otherAxis:t.getOtherAxis(i)}}(e,l);u&&this._enableRealtimeSort(u,r,a);var c=e.get("clip",!0)||u,g=function(e,t){var a=e.getArea&&e.getArea();if(Le(e,"cartesian2d")){var i=e.getBaseAxis();if("category"!==i.type||!i.onBand){var n=t.getLayout("bandWidth");i.isHorizontal()?(a.x-=n,a.width+=2*n):(a.y-=n,a.height+=2*n)}}return a}(l,r);o.removeClipPath();var f=e.get("roundCap",!0),y=e.get("showBackground",!0),v=e.getModel("backgroundStyle"),m=v.get("borderRadius")||0,x=[],_=this._backgroundEls,b=i&&i.isInitSort,w=i&&"changeAxisOrder"===i.type;function S(e){var t=vt[l.type](r,e),a=function(e,t,a){var i="polar"===e.type?Z:I;return new i({shape:Mt(t,a,e),silent:!0,z2:0})}(l,n,t);return a.useStyle(v.getItemStyle()),"cartesian2d"===l.type?a.setShape("r",m):a.setShape("cornerRadius",m),x[e]=a,a}r.diff(s).add((function(t){var a=r.getItemModel(t),i=vt[l.type](r,t,a);if(y&&S(t),r.hasValue(t)&&yt[l.type](i)){var s=!1;c&&(s=ht[l.type](g,i));var p=ut[l.type](e,r,t,i,n,h,d.model,!1,f);u&&(p.forceLabelAnimation=!0),xt(p,r,t,a,i,e,n,"polar"===l.type),b?p.attr({shape:i}):u?ct(u,h,p,i,t,n,!1,!1):z(p,{shape:i},e,t),r.setItemGraphicEl(t,p),o.add(p),p.ignore=s}})).update((function(t,a){var i=r.getItemModel(t),p=vt[l.type](r,t,i);if(y){var M=void 0;0===_.length?M=S(a):((M=_[a]).useStyle(v.getItemStyle()),"cartesian2d"===l.type?M.setShape("r",m):M.setShape("cornerRadius",m),x[t]=M);var I=vt[l.type](r,t),A=Mt(n,I,l);X(M,{shape:A},h,t)}var L=s.getItemGraphicEl(a);if(r.hasValue(t)&&yt[l.type](p)){var D=!1;if(c&&(D=ht[l.type](g,p))&&o.remove(L),L?j(L):L=ut[l.type](e,r,t,p,n,h,d.model,!!L,f),u&&(L.forceLabelAnimation=!0),w){var E=L.getTextContent();if(E){var k=U(E);null!=k.prevValue&&(k.prevValue=k.value)}}else xt(L,r,t,i,p,e,n,"polar"===l.type);b?L.attr({shape:p}):u?ct(u,h,L,p,t,n,!0,w):X(L,{shape:p},e,t,null),r.setItemGraphicEl(t,L),L.ignore=D,o.add(L)}else o.remove(L)})).remove((function(t){var a=s.getItemGraphicEl(t);a&&q(a,e,t)})).execute();var M=this._backgroundGroup||(this._backgroundGroup=new p);M.removeAll();for(var A=0;A<x.length;++A)M.add(x[A]);o.add(M),this._backgroundEls=x,this._data=r},t.prototype._renderLarge=function(e,t,a){this._clear(),wt(e,this.group),this._updateLargeClip(e)},t.prototype._incrementalRenderLarge=function(e,t){this._removeBackground(),wt(t,this.group,this._progressiveEls,!0)},t.prototype._updateLargeClip=function(e){var t=e.get("clip",!0)&&Qe(e.coordinateSystem,!1,e),a=this.group;t?a.setClipPath(t):a.removeClipPath()},t.prototype._enableRealtimeSort=function(e,t,a){var i=this;if(t.count()){var n=e.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(t,e,a),this._isFirstFrame=!1;else{var o=function(e){var a=t.getItemGraphicEl(e),i=a&&a.shape;return i&&Math.abs(n.isHorizontal()?i.height:i.width)||0};this._onRendered=function(){i._updateSortWithinSameData(t,o,n,a)},a.getZr().on("rendered",this._onRendered)}}},t.prototype._dataSort=function(e,t,a){var i=[];return e.each(e.mapDimension(t.dim),(function(e,t){var n=a(t);n=null==n?NaN:n,i.push({dataIndex:t,mappedValue:n,ordinalNumber:e})})),i.sort((function(e,t){return t.mappedValue-e.mappedValue})),{ordinalNumbers:K(i,(function(e){return e.ordinalNumber}))}},t.prototype._isOrderChangedWithinSameData=function(e,t,a){for(var i=a.scale,n=e.mapDimension(a.dim),o=Number.MAX_VALUE,r=0,s=i.getOrdinalMeta().categories.length;r<s;++r){var l=e.rawIndexOf(n,i.getRawOrdinalNumber(r)),d=l<0?Number.MIN_VALUE:t(e.indexOfRawIndex(l));if(d>o)return!0;o=d}return!1},t.prototype._isOrderDifferentInView=function(e,t){for(var a=t.scale,i=a.getExtent(),n=Math.max(0,i[0]),o=Math.min(i[1],a.getOrdinalMeta().categories.length-1);n<=o;++n)if(e.ordinalNumbers[n]!==a.getRawOrdinalNumber(n))return!0},t.prototype._updateSortWithinSameData=function(e,t,a,i){if(this._isOrderChangedWithinSameData(e,t,a)){var n=this._dataSort(e,a,t);this._isOrderDifferentInView(n,a)&&(this._removeOnRenderedListener(i),i.dispatchAction({type:"changeAxisOrder",componentType:a.dim+"Axis",axisId:a.index,sortInfo:n}))}},t.prototype._dispatchInitSort=function(e,t,a){var i=t.baseAxis,n=this._dataSort(e,i,(function(a){return e.get(e.mapDimension(t.otherAxis.dim),a)}));a.dispatchAction({type:"changeAxisOrder",componentType:i.dim+"Axis",isInitSort:!0,axisId:i.index,sortInfo:n})},t.prototype.remove=function(e,t){this._clear(this._model),this._removeOnRenderedListener(t)},t.prototype.dispose=function(e,t){this._removeOnRenderedListener(t)},t.prototype._removeOnRenderedListener=function(e){this._onRendered&&(e.getZr().off("rendered",this._onRendered),this._onRendered=null)},t.prototype._clear=function(e){var t=this.group,a=this._data;e&&e.isAnimationEnabled()&&a&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],a.eachItemGraphicEl((function(t){q(t,e,Q(t).dataIndex)}))):t.removeAll(),this._data=null,this._isFirstFrame=!0},t.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},t.type="bar",t}($),ht={cartesian2d:function(e,t){var a=t.width<0?-1:1,i=t.height<0?-1:1;a<0&&(t.x+=t.width,t.width=-t.width),i<0&&(t.y+=t.height,t.height=-t.height);var n=e.x+e.width,o=e.y+e.height,r=st(t.x,e.x),s=lt(t.x+t.width,n),l=st(t.y,e.y),d=lt(t.y+t.height,o),h=s<r,u=d<l;return t.x=h&&r>n?s:r,t.y=u&&l>o?d:l,t.width=h?0:s-r,t.height=u?0:d-l,a<0&&(t.x+=t.width,t.width=-t.width),i<0&&(t.y+=t.height,t.height=-t.height),h||u},polar:function(e,t){var a=t.r0<=t.r?1:-1;if(a<0){var i=t.r;t.r=t.r0,t.r0=i}var n=lt(t.r,e.r),o=st(t.r0,e.r0);t.r=n,t.r0=o;var r=n-o<0;if(a<0){i=t.r;t.r=t.r0,t.r0=i}return r}},ut={cartesian2d:function(e,t,a,i,n,o,r,s,l){var d=new I({shape:J({},i),z2:1});(d.__dataIndex=a,d.name="item",o)&&(d.shape[n?"height":"width"]=0);return d},polar:function(e,t,a,i,n,o,r,s,l){var d=!n&&l?nt:Z,h=new d({shape:i,z2:1});h.name="item";var u,c,g=mt(n);if(h.calculateTextPosition=(u=g,c=({isRoundCap:d===nt}||{}).isRoundCap,function(e,t,a){var i=t.position;if(!i||i instanceof Array)return H(e,t,a);var n=u(i),o=null!=t.distance?t.distance:5,r=this.shape,s=r.cx,l=r.cy,d=r.r,h=r.r0,g=(d+h)/2,p=r.startAngle,f=r.endAngle,y=(p+f)/2,v=c?Math.abs(d-h)/2:0,m=Math.cos,x=Math.sin,_=s+d*m(p),b=l+d*x(p),w="left",S="top";switch(n){case"startArc":_=s+(h-o)*m(y),b=l+(h-o)*x(y),w="center",S="top";break;case"insideStartArc":_=s+(h+o)*m(y),b=l+(h+o)*x(y),w="center",S="bottom";break;case"startAngle":_=s+g*m(p)+ot(p,o+v,!1),b=l+g*x(p)+rt(p,o+v,!1),w="right",S="middle";break;case"insideStartAngle":_=s+g*m(p)+ot(p,-o+v,!1),b=l+g*x(p)+rt(p,-o+v,!1),w="left",S="middle";break;case"middle":_=s+g*m(y),b=l+g*x(y),w="center",S="middle";break;case"endArc":_=s+(d+o)*m(y),b=l+(d+o)*x(y),w="center",S="bottom";break;case"insideEndArc":_=s+(d-o)*m(y),b=l+(d-o)*x(y),w="center",S="top";break;case"endAngle":_=s+g*m(f)+ot(f,o+v,!0),b=l+g*x(f)+rt(f,o+v,!0),w="left",S="middle";break;case"insideEndAngle":_=s+g*m(f)+ot(f,-o+v,!0),b=l+g*x(f)+rt(f,-o+v,!0),w="right",S="middle";break;default:return H(e,t,a)}return(e=e||{}).x=_,e.y=b,e.align=w,e.verticalAlign=S,e}),o){var p=n?"r":"endAngle",f={};h.shape[p]=n?i.r0:i.startAngle,f[p]=i[p],(s?X:z)(h,{shape:f},o)}return h}};function ct(e,t,a,i,n,o,r,s){var l,d;o?(d={x:i.x,width:i.width},l={y:i.y,height:i.height}):(d={y:i.y,height:i.height},l={x:i.x,width:i.width}),s||(r?X:z)(a,{shape:l},t,n,null);var h=t?e.baseAxis.model:null;(r?X:z)(a,{shape:d},h,n)}function gt(e,t){for(var a=0;a<t.length;a++)if(!isFinite(e[t[a]]))return!0;return!1}var pt=["x","y","width","height"],ft=["cx","cy","r","startAngle","endAngle"],yt={cartesian2d:function(e){return!gt(e,pt)},polar:function(e){return!gt(e,ft)}},vt={cartesian2d:function(e,t,a){var i=e.getItemLayout(t),n=a?function(e,t){var a=e.get(["itemStyle","borderColor"]);if(!a||"none"===a)return 0;var i=e.get(["itemStyle","borderWidth"])||0,n=isNaN(t.width)?Number.MAX_VALUE:Math.abs(t.width),o=isNaN(t.height)?Number.MAX_VALUE:Math.abs(t.height);return Math.min(i,n,o)}(a,i):0,o=i.width>0?1:-1,r=i.height>0?1:-1;return{x:i.x+o*n/2,y:i.y+r*n/2,width:i.width-o*n,height:i.height-r*n}},polar:function(e,t,a){var i=e.getItemLayout(t);return{cx:i.cx,cy:i.cy,r0:i.r0,r:i.r,startAngle:i.startAngle,endAngle:i.endAngle,clockwise:i.clockwise}}};function mt(e){return function(e){var t=e?"Arc":"Angle";return function(e){switch(e){case"start":case"insideStart":case"end":case"insideEnd":return e+t;default:return e}}}(e)}function xt(e,t,a,i,n,o,s,l){var d=t.getItemVisual(a,"style");if(l){if(!o.get("roundCap")){var h=e.shape,u=ee(i.getModel("itemStyle"),h,!0);J(h,u),e.setShape(h)}}else{var c=i.get(["itemStyle","borderRadius"])||0;e.setShape("r",c)}e.useStyle(d);var g=i.getShallow("cursor");g&&e.attr("cursor",g);var p=l?s?n.r>=n.r0?"endArc":"startArc":n.endAngle>=n.startAngle?"endAngle":"startAngle":s?n.height>=0?"bottom":"top":n.width>=0?"right":"left",f=te(i);ae(e,f,{labelFetcher:o,labelDataIndex:a,defaultText:ie(o.getData(),a),inheritColor:d.fill,defaultOpacity:d.opacity,defaultOutsidePosition:p});var y=e.getTextContent();if(l&&y){var v=i.get(["label","position"]);e.textConfig.inside="middle"===v||null,function(e,t,a,i){if(F(i))e.setTextConfig({rotation:i});else if(W(t))e.setTextConfig({rotation:0});else{var n,o=e.shape,r=o.clockwise?o.startAngle:o.endAngle,s=o.clockwise?o.endAngle:o.startAngle,l=(r+s)/2,d=a(t);switch(d){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":n=l;break;case"startAngle":case"insideStartAngle":n=r;break;case"endAngle":case"insideEndAngle":n=s;break;default:return void e.setTextConfig({rotation:0})}var h=1.5*Math.PI-n;"middle"===d&&h>Math.PI/2&&h<1.5*Math.PI&&(h-=Math.PI),e.setTextConfig({rotation:h})}}(e,"outside"===v?p:v,mt(s),i.get(["label","rotate"]))}ne(y,f,o.getRawValue(a),(function(e){return le(t,e)}));var m=i.getModel(["emphasis"]);oe(e,m.get("focus"),m.get("blurScope"),m.get("disabled")),re(e,i),function(e){return null!=e.startAngle&&null!=e.endAngle&&e.startAngle===e.endAngle}(n)&&(e.style.fill="none",e.style.stroke="none",r(e.states,(function(e){e.style&&(e.style.fill=e.style.stroke="none")})))}var _t=function(){return function(){}}(),bt=function(e){function t(t){var a=e.call(this,t)||this;return a.type="largeBar",a}return i(t,e),t.prototype.getDefaultShape=function(){return new _t},t.prototype.buildPath=function(e,t){for(var a=t.points,i=this.baseDimIdx,n=1-this.baseDimIdx,o=[],r=[],s=this.barWidth,l=0;l<a.length;l+=3)r[i]=s,r[n]=a[l+2],o[i]=a[l+i],o[n]=a[l+n],e.rect(o[0],o[1],r[0],r[1])},t}(G);function wt(e,t,a,i){var n=e.getData(),o=n.getLayout("valueAxisHorizontal")?1:0,r=n.getLayout("largeDataIndices"),s=n.getLayout("size"),l=e.getModel("backgroundStyle"),d=n.getLayout("largeBackgroundPoints");if(d){var h=new bt({shape:{points:d},incremental:!!i,silent:!0,z2:0});h.baseDimIdx=o,h.largeDataIndices=r,h.barWidth=s,h.useStyle(l.getItemStyle()),t.add(h),a&&a.push(h)}var u=new bt({shape:{points:n.getLayout("largePoints")},incremental:!!i,ignoreCoarsePointer:!0,z2:1});u.baseDimIdx=o,u.largeDataIndices=r,u.barWidth=s,t.add(u),u.useStyle(n.getVisual("style")),u.style.stroke=null,Q(u).seriesIndex=e.seriesIndex,e.get("silent")||(u.on("mousedown",St),u.on("mousemove",St)),a&&a.push(u)}var St=se((function(e){var t=function(e,t,a){for(var i=e.baseDimIdx,n=1-i,o=e.shape.points,r=e.largeDataIndices,s=[],l=[],d=e.barWidth,h=0,u=o.length/3;h<u;h++){var c=3*h;if(l[i]=d,l[n]=o[c+2],s[i]=o[c+i],s[n]=o[c+n],l[n]<0&&(s[n]+=l[n],l[n]=-l[n]),t>=s[0]&&t<=s[0]+l[0]&&a>=s[1]&&a<=s[1]+l[1])return r[h]}return-1}(this,e.offsetX,e.offsetY);Q(this).dataIndex=t>=0?t:null}),30,!1);function Mt(e,t,a){if(Le(a,"cartesian2d")){var i=t,n=a.getArea();return{x:e?i.x:n.x,y:e?n.y:i.y,width:e?i.width:n.width,height:e?n.height:i.height}}var o=t;return{cx:(n=a.getArea()).cx,cy:n.cy,r0:e?n.r0:o.r0,r:e?n.r:o.r,startAngle:e?o.startAngle:0,endAngle:e?o.endAngle:2*Math.PI}}function It(e){e.registerChartView(dt),e.registerSeriesModel(at),e.registerLayout(e.PRIORITY.VISUAL.LAYOUT,d(he,"bar")),e.registerLayout(e.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,de("bar")),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,et("bar")),e.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},(function(e,t){var a=e.componentType||"series";t.eachComponent({mainType:a,query:e},(function(t){e.sortInfo&&t.axis.setCategorySortInfo(e.sortInfo)}))}))}var At=function(){return function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.cpx2=0,this.cpy2=0,this.extent=0}}(),Lt=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.getDefaultShape=function(){return new At},t.prototype.buildPath=function(e,t){var a=t.extent;e.moveTo(t.x1,t.y1),e.bezierCurveTo(t.cpx1,t.cpy1,t.cpx2,t.cpy2,t.x2,t.y2),"vertical"===t.orient?(e.lineTo(t.x2+a,t.y2),e.bezierCurveTo(t.cpx2+a,t.cpy2,t.cpx1+a,t.cpy1,t.x1+a,t.y1)):(e.lineTo(t.x2,t.y2+a),e.bezierCurveTo(t.cpx2,t.cpy2+a,t.cpx1,t.cpy1+a,t.x1,t.y1+a)),e.closePath()},t.prototype.highlight=function(){ue(this)},t.prototype.downplay=function(){ce(this)},t}(G),Dt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a._focusAdjacencyDisabled=!1,a}return i(t,e),t.prototype.render=function(e,t,a){var i=this,n=e.getGraph(),o=this.group,r=e.layoutInfo,s=r.width,l=r.height,d=e.getData(),h=e.getData("edge"),u=e.get("orient");this._model=e,o.removeAll(),o.x=r.x,o.y=r.y,n.eachEdge((function(t){var a=new Lt,i=Q(a);i.dataIndex=t.dataIndex,i.seriesIndex=e.seriesIndex,i.dataType="edge";var n,r,d,c,g,p,f,y,v=t.getModel(),m=v.getModel("lineStyle"),x=m.get("curveness"),_=t.node1.getLayout(),b=t.node1.getModel(),w=b.get("localX"),S=b.get("localY"),M=t.node2.getLayout(),I=t.node2.getModel(),A=I.get("localX"),L=I.get("localY"),D=t.getLayout();a.shape.extent=Math.max(1,D.dy),a.shape.orient=u,"vertical"===u?(n=(null!=w?w*s:_.x)+D.sy,r=(null!=S?S*l:_.y)+_.dy,d=(null!=A?A*s:M.x)+D.ty,g=n,p=r*(1-x)+(c=null!=L?L*l:M.y)*x,f=d,y=r*x+c*(1-x)):(n=(null!=w?w*s:_.x)+_.dx,r=(null!=S?S*l:_.y)+D.sy,g=n*(1-x)+(d=null!=A?A*s:M.x)*x,p=r,f=n*x+d*(1-x),y=c=(null!=L?L*l:M.y)+D.ty),a.setShape({x1:n,y1:r,x2:d,y2:c,cpx1:g,cpy1:p,cpx2:f,cpy2:y}),a.useStyle(m.getItemStyle()),Et(a.style,u,t);var E=""+v.get("value"),k=te(v,"edgeLabel");ae(a,k,{labelFetcher:{getFormattedLabel:function(t,a,i,n,o,r){return e.getFormattedLabel(t,a,"edge",n,ge(o,k.normal&&k.normal.get("formatter"),E),r)}},labelDataIndex:t.dataIndex,defaultText:E}),a.setTextConfig({position:"inside"});var R=v.getModel("emphasis");re(a,v,"lineStyle",(function(e){var a=e.getItemStyle();return Et(a,u,t),a})),o.add(a),h.setItemGraphicEl(t.dataIndex,a);var C=R.get("focus");oe(a,"adjacency"===C?t.getAdjacentDataIndices():"trajectory"===C?t.getTrajectoryDataIndices():C,R.get("blurScope"),R.get("disabled"))})),n.eachNode((function(t){var a=t.getLayout(),i=t.getModel(),n=i.get("localX"),r=i.get("localY"),h=i.getModel("emphasis"),u=i.get(["itemStyle","borderRadius"])||0,c=new I({shape:{x:null!=n?n*s:a.x,y:null!=r?r*l:a.y,width:a.dx,height:a.dy,r:u},style:i.getModel("itemStyle").getItemStyle(),z2:10});ae(c,te(i),{labelFetcher:{getFormattedLabel:function(t,a){return e.getFormattedLabel(t,a,"node")}},labelDataIndex:t.dataIndex,defaultText:t.id}),c.disableLabelAnimation=!0,c.setStyle("fill",t.getVisual("color")),c.setStyle("decal",t.getVisual("style").decal),re(c,i),o.add(c),d.setItemGraphicEl(t.dataIndex,c),Q(c).dataType="node";var g=h.get("focus");oe(c,"adjacency"===g?t.getAdjacentDataIndices():"trajectory"===g?t.getTrajectoryDataIndices():g,h.get("blurScope"),h.get("disabled"))})),d.eachItemGraphicEl((function(t,n){d.getItemModel(n).get("draggable")&&(t.drift=function(t,o){i._focusAdjacencyDisabled=!0,this.shape.x+=t,this.shape.y+=o,this.dirty(),a.dispatchAction({type:"dragNode",seriesId:e.id,dataIndex:d.getRawIndex(n),localX:this.shape.x/s,localY:this.shape.y/l})},t.ondragend=function(){i._focusAdjacencyDisabled=!1},t.draggable=!0,t.cursor="move")})),!this._data&&e.isAnimationEnabled()&&o.setClipPath(function(e,t,a){var i=new I({shape:{x:e.x-10,y:e.y-10,width:0,height:e.height+20}});return z(i,{shape:{width:e.width+20}},t,a),i}(o.getBoundingRect(),e,(function(){o.removeClipPath()}))),this._data=e.getData()},t.prototype.dispose=function(){},t.type="sankey",t}($);function Et(e,t,a){switch(e.fill){case"source":e.fill=a.node1.getVisual("color"),e.decal=a.node1.getVisual("style").decal;break;case"target":e.fill=a.node2.getVisual("color"),e.decal=a.node2.getVisual("style").decal;break;case"gradient":var i=a.node1.getVisual("color"),n=a.node2.getVisual("color");R(i)&&R(n)&&(e.fill=new pe(0,0,+("horizontal"===t),+("vertical"===t),[{color:i,offset:0},{color:n,offset:1}]))}}var kt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return i(t,e),t.prototype.getInitialData=function(e,t){var a=e.edges||e.links||[],i=e.data||e.nodes||[],n=e.levels||[];this.levelModels=[];for(var o=this.levelModels,r=0;r<n.length;r++)null!=n[r].depth&&n[r].depth>=0&&(o[n[r].depth]=new fe(n[r],this,t));return Ie(i,a,this,!0,(function(e,t){e.wrapMethod("getItemModel",(function(e,t){var a=e.parentModel,i=a.getData().getItemLayout(t);if(i){var n=i.depth,o=a.levelModels[n];o&&(e.parentModel=o)}return e})),t.wrapMethod("getItemModel",(function(e,t){var a=e.parentModel,i=a.getGraph().getEdgeByIndex(t).node1.getLayout();if(i){var n=i.depth,o=a.levelModels[n];o&&(e.parentModel=o)}return e}))})).data},t.prototype.setNodePosition=function(e,t){var a=(this.option.data||this.option.nodes)[e];a.localX=t[0],a.localY=t[1]},t.prototype.getGraph=function(){return this.getData().graph},t.prototype.getEdgeData=function(){return this.getGraph().edgeData},t.prototype.formatTooltip=function(e,t,a){function i(e){return isNaN(e)||null==e}if("edge"===a){var n=this.getDataParams(e,a),o=n.data,r=n.value,s=o.source+" -- "+o.target;return ye("nameValue",{name:s,value:r,noValue:i(r)})}var l=this.getGraph().getNodeByIndex(e).getLayout().value,d=this.getDataParams(e,a).data.name;return ye("nameValue",{name:null!=d?d+"":null,value:l,noValue:i(l)})},t.prototype.optionUpdated=function(){},t.prototype.getDataParams=function(t,a){var i=e.prototype.getDataParams.call(this,t,a);if(null==i.value&&"node"===a){var n=this.getGraph().getNodeByIndex(t).getLayout().value;i.value=n}return i},t.type="series.sankey",t.defaultOption={z:2,coordinateSystem:"view",left:"5%",top:"5%",right:"20%",bottom:"5%",orient:"horizontal",nodeWidth:20,nodeGap:8,draggable:!0,layoutIterations:32,label:{show:!0,position:"right",fontSize:12},edgeLabel:{show:!1,fontSize:12},levels:[],nodeAlign:"justify",lineStyle:{color:"#314656",opacity:.2,curveness:.5},emphasis:{label:{show:!0},lineStyle:{opacity:.5}},select:{itemStyle:{borderColor:"#212121"}},animationEasing:"linear",animationDuration:1e3},t}(N);function Rt(e,t){e.eachSeriesByType("sankey",(function(e){var a=e.get("nodeWidth"),i=e.get("nodeGap"),n=function(e,t){return y(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}(e,t);e.layoutInfo=n;var o=n.width,s=n.height,l=e.getGraph(),d=l.nodes,h=l.edges;!function(e){r(e,(function(e){var t=Gt(e.outEdges,Nt),a=Gt(e.inEdges,Nt),i=e.getValue()||0,n=Math.max(t,a,i);e.setLayout({value:n},!0)}))}(d),function(e,t,a,i,n,o,s,l,d){(function(e,t,a,i,n,o,s){for(var l=[],d=[],h=[],u=[],c=0,g=0;g<t.length;g++)l[g]=1;for(g=0;g<e.length;g++)d[g]=e[g].inEdges.length,0===d[g]&&h.push(e[g]);var p=-1;for(;h.length;){for(var f=0;f<h.length;f++){var y=h[f],v=y.hostGraph.data.getRawDataItem(y.dataIndex),m=null!=v.depth&&v.depth>=0;m&&v.depth>p&&(p=v.depth),y.setLayout({depth:m?v.depth:c},!0),"vertical"===o?y.setLayout({dy:a},!0):y.setLayout({dx:a},!0);for(var x=0;x<y.outEdges.length;x++){var _=y.outEdges[x];l[t.indexOf(_)]=0;var b=_.node2;0==--d[e.indexOf(b)]&&u.indexOf(b)<0&&u.push(b)}}++c,h=u,u=[]}for(g=0;g<l.length;g++)if(1===l[g])throw new Error("Sankey is a DAG, the original data has cycle!");var w=p>c-1?p:c-1;s&&"left"!==s&&function(e,t,a,i){if("right"===t){for(var n=[],o=e,s=0;o.length;){for(var l=0;l<o.length;l++){var d=o[l];d.setLayout({skNodeHeight:s},!0);for(var h=0;h<d.inEdges.length;h++){var u=d.inEdges[h];n.indexOf(u.node1)<0&&n.push(u.node1)}}o=n,n=[],++s}r(e,(function(e){Ct(e)||e.setLayout({depth:Math.max(0,i-e.getLayout().skNodeHeight)},!0)}))}else"justify"===t&&function(e,t){r(e,(function(e){Ct(e)||e.outEdges.length||e.setLayout({depth:t},!0)}))}(e,i)}(e,s,0,w);var S="vertical"===o?(n-a)/w:(i-a)/w;!function(e,t,a){r(e,(function(e){var i=e.getLayout().depth*t;"vertical"===a?e.setLayout({y:i},!0):e.setLayout({x:i},!0)}))}(e,S,o)})(e,t,a,n,o,l,d),function(e,t,a,i,n,o,s){var l=function(e,t){var a=[],i="vertical"===t?"y":"x",n=me(e,(function(e){return e.getLayout()[i]}));return n.keys.sort((function(e,t){return e-t})),r(n.keys,(function(e){a.push(n.buckets.get(e))})),a}(e,s);(function(e,t,a,i,n,o){var s=1/0;r(e,(function(e){var t=e.length,l=0;r(e,(function(e){l+=e.getLayout().value}));var d="vertical"===o?(i-(t-1)*n)/l:(a-(t-1)*n)/l;d<s&&(s=d)})),r(e,(function(e){r(e,(function(e,t){var a=e.getLayout().value*s;"vertical"===o?(e.setLayout({x:t},!0),e.setLayout({dx:a},!0)):(e.setLayout({y:t},!0),e.setLayout({dy:a},!0))}))})),r(t,(function(e){var t=+e.getValue()*s;e.setLayout({dy:t},!0)}))})(l,t,a,i,n,s),Pt(l,n,a,i,s);for(var d=1;o>0;o--)Tt(l,d*=.99,s),Pt(l,n,a,i,s),Ht(l,d,s),Pt(l,n,a,i,s)}(e,t,o,n,i,s,l),function(e,t){var a="vertical"===t?"x":"y";r(e,(function(e){e.outEdges.sort((function(e,t){return e.node2.getLayout()[a]-t.node2.getLayout()[a]})),e.inEdges.sort((function(e,t){return e.node1.getLayout()[a]-t.node1.getLayout()[a]}))})),r(e,(function(e){var t=0,a=0;r(e.outEdges,(function(e){e.setLayout({sy:t},!0),t+=e.getLayout().dy})),r(e.inEdges,(function(e){e.setLayout({ty:a},!0),a+=e.getLayout().dy}))}))}(e,l)}(d,h,a,i,o,s,0!==ve(d,(function(e){return 0===e.getLayout().value})).length?0:e.get("layoutIterations"),e.get("orient"),e.get("nodeAlign"))}))}function Ct(e){var t=e.hostGraph.data.getRawDataItem(e.dataIndex);return null!=t.depth&&t.depth>=0}function Pt(e,t,a,i,n){var o="vertical"===n?"x":"y";r(e,(function(e){var r,s,l;e.sort((function(e,t){return e.getLayout()[o]-t.getLayout()[o]}));for(var d=0,h=e.length,u="vertical"===n?"dx":"dy",c=0;c<h;c++)(l=d-(s=e[c]).getLayout()[o])>0&&(r=s.getLayout()[o]+l,"vertical"===n?s.setLayout({x:r},!0):s.setLayout({y:r},!0)),d=s.getLayout()[o]+s.getLayout()[u]+t;if((l=d-t-("vertical"===n?i:a))>0){r=s.getLayout()[o]-l,"vertical"===n?s.setLayout({x:r},!0):s.setLayout({y:r},!0),d=r;for(c=h-2;c>=0;--c)(l=(s=e[c]).getLayout()[o]+s.getLayout()[u]+t-d)>0&&(r=s.getLayout()[o]-l,"vertical"===n?s.setLayout({x:r},!0):s.setLayout({y:r},!0)),d=s.getLayout()[o]}}))}function Tt(e,t,a){r(e.slice().reverse(),(function(e){r(e,(function(e){if(e.outEdges.length){var i=Gt(e.outEdges,Vt,a)/Gt(e.outEdges,Nt);if(isNaN(i)){var n=e.outEdges.length;i=n?Gt(e.outEdges,zt,a)/n:0}if("vertical"===a){var o=e.getLayout().x+(i-Bt(e,a))*t;e.setLayout({x:o},!0)}else{var r=e.getLayout().y+(i-Bt(e,a))*t;e.setLayout({y:r},!0)}}}))}))}function Vt(e,t){return Bt(e.node2,t)*e.getValue()}function zt(e,t){return Bt(e.node2,t)}function Ot(e,t){return Bt(e.node1,t)*e.getValue()}function Zt(e,t){return Bt(e.node1,t)}function Bt(e,t){return"vertical"===t?e.getLayout().x+e.getLayout().dx/2:e.getLayout().y+e.getLayout().dy/2}function Nt(e){return e.getValue()}function Gt(e,t,a){for(var i=0,n=e.length,o=-1;++o<n;){var r=+t(e[o],a);isNaN(r)||(i+=r)}return i}function Ht(e,t,a){r(e,(function(e){r(e,(function(e){if(e.inEdges.length){var i=Gt(e.inEdges,Ot,a)/Gt(e.inEdges,Nt);if(isNaN(i)){var n=e.inEdges.length;i=n?Gt(e.inEdges,Zt,a)/n:0}if("vertical"===a){var o=e.getLayout().x+(i-Bt(e,a))*t;e.setLayout({x:o},!0)}else{var r=e.getLayout().y+(i-Bt(e,a))*t;e.setLayout({y:r},!0)}}}))}))}function Ft(e){e.eachSeriesByType("sankey",(function(e){var t=e.getGraph(),a=t.nodes,i=t.edges;if(a.length){var n=1/0,o=-1/0;r(a,(function(e){var t=e.getLayout().value;t<n&&(n=t),t>o&&(o=t)})),r(a,(function(t){var a=new xe({type:"color",mappingMethod:"linear",dataExtent:[n,o],visual:e.get("color")}).mapValueToVisual(t.getLayout().value),i=t.getModel().get(["itemStyle","color"]);null!=i?(t.setVisual("color",i),t.setVisual("style",{fill:i})):(t.setVisual("color",a),t.setVisual("style",{fill:a}))}))}i.length&&r(i,(function(e){var t=e.getModel().get("lineStyle");e.setVisual("style",t)}))}))}function Wt(e){e.registerChartView(Dt),e.registerSeriesModel(kt),e.registerLayout(Rt),e.registerVisual(Ft),e.registerAction({type:"dragNode",event:"dragnode",update:"update"},(function(e,t){t.eachComponent({mainType:"series",subType:"sankey",query:e},(function(t){t.setNodePosition(e.dataIndex,[e.localX,e.localY])}))}))}export{tt as B,nt as S,Ke as a,Qe as b,qe as c,et as d,It as e,Wt as f,Ae as g,Ue as h,Le as i,Ze as j,je as k};
